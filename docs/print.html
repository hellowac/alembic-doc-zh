<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>alembic 中文文档</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="zh/_front_matter.html">前言</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="zh/00_tutorial.html"><strong aria-hidden="true">1.</strong> 指南</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/00_01_the_migration_enviroment.html"><strong aria-hidden="true">1.1.</strong> 迁移环境</a></li><li class="chapter-item "><a href="zh/00_02_creating_an_enviroment.html"><strong aria-hidden="true">1.2.</strong> 创建环境</a></li><li class="chapter-item "><a href="zh/00_03_Editing_the_ini_file.html"><strong aria-hidden="true">1.3.</strong> 编辑.ini文件</a></li><li class="chapter-item "><a href="zh/00_04_create_a_migration_script.html"><strong aria-hidden="true">1.4.</strong> 创建迁移脚本</a></li><li class="chapter-item "><a href="zh/00_05_Running_our_first_migration.html"><strong aria-hidden="true">1.5.</strong> 初次运行迁移</a></li><li class="chapter-item "><a href="zh/00_06_Running_our_second_migration.html"><strong aria-hidden="true">1.6.</strong> 再次运行迁移</a></li><li class="chapter-item "><a href="zh/00_07_partial_revision_identifiers.html"><strong aria-hidden="true">1.7.</strong> 部分修订标识符</a></li><li class="chapter-item "><a href="zh/00_08_relative_migration_identifiers.html"><strong aria-hidden="true">1.8.</strong> 相对迁移标识符</a></li><li class="chapter-item "><a href="zh/00_09_getting_information.html"><strong aria-hidden="true">1.9.</strong> 获取信息</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/00_09_01_viewing_history_ranges.html"><strong aria-hidden="true">1.9.1.</strong> 查看历史范围</a></li></ol></li><li class="chapter-item "><a href="zh/00_10_downgrading.html"><strong aria-hidden="true">1.10.</strong> 降级</a></li><li class="chapter-item "><a href="zh/00_11_next_steps.html"><strong aria-hidden="true">1.11.</strong> 下一步</a></li></ol></li><li class="chapter-item expanded "><a href="zh/01_auto_generating_migrations.html"><strong aria-hidden="true">2.</strong> 自动生成迁移</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/01_01_what_does_autogenerate_detect.html"><strong aria-hidden="true">2.1.</strong> Autogenerate 检测什么</a></li><li class="chapter-item "><a href="zh/01_02_autogenerating_multiple_metadata_collections.html"><strong aria-hidden="true">2.2.</strong> 自动生成多个元数据集合</a></li><li class="chapter-item "><a href="zh/01_03_controlling_what_to_be_autogenerated.html"><strong aria-hidden="true">2.3.</strong> 控制要自动生成的内容</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/01_03_01_omitting_schema_names_from_the_autogenerate_process.html"><strong aria-hidden="true">2.3.1.</strong> 从自动生成过程中省略模式名称</a></li><li class="chapter-item "><a href="zh/01_03_02_omitting_table_names_from_the_autogenerate_process.html"><strong aria-hidden="true">2.3.2.</strong> 从自动生成过程中省略表名</a></li><li class="chapter-item "><a href="zh/01_03_03_omitting_based_on_object.html"><strong aria-hidden="true">2.3.3.</strong> 基于对象的省略</a></li></ol></li><li class="chapter-item "><a href="zh/01_04_comparing_and_rendering_types.html"><strong aria-hidden="true">2.4.</strong> 比较和渲染类型</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/01_04_01_controlling_the_module_prefix.html"><strong aria-hidden="true">2.4.1.</strong> 控制模块前缀</a></li><li class="chapter-item "><a href="zh/01_04_02_affecting_the_rendering_of_types_themselves.html"><strong aria-hidden="true">2.4.2.</strong> 影响类型本身的渲染</a></li><li class="chapter-item "><a href="zh/01_04_03_comparing_types.html"><strong aria-hidden="true">2.4.3.</strong> 比较类型</a></li></ol></li><li class="chapter-item "><a href="zh/01_05_applying_post_processing.html"><strong aria-hidden="true">2.5.</strong> 将提交处理过程和 Python 代码格式化程序应用于生成的修订</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/01_05_01_basic_formatter_configuration.html"><strong aria-hidden="true">2.5.1.</strong> 基本格式化程序配置</a></li><li class="chapter-item "><a href="zh/01_05_02_writing_custom_hooks_as_python_functions.html"><strong aria-hidden="true">2.5.2.</strong> 自定义Python函数钩子</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="zh/02_generating_sql_scripts.html"><strong aria-hidden="true">3.</strong> 生成SQL脚本(又称离线模式)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/02_01_getting_the_start_version.html"><strong aria-hidden="true">3.1.</strong> 获取开始版本</a></li><li class="chapter-item "><a href="zh/02_02_writing_migration_scripts_to_support_script_generation.html"><strong aria-hidden="true">3.2.</strong> 编写迁移脚本以支持脚本生成</a></li><li class="chapter-item "><a href="zh/02_03_customizing_the_environment.html"><strong aria-hidden="true">3.3.</strong> 自定义环境</a></li></ol></li><li class="chapter-item expanded "><a href="zh/03_the_importance_of_naming_constraints.html"><strong aria-hidden="true">4.</strong> 命名约束的重要性</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/03_01_integration_of_naming_conventions_into_operations_autogenerate.html"><strong aria-hidden="true">4.1.</strong> 将命名约定集成到操作中以及自动生成中</a></li></ol></li><li class="chapter-item expanded "><a href="zh/04_running_batch_migrations_for_sqlite_and_other_databases.html"><strong aria-hidden="true">5.</strong> 在SQLite和其他数据中运行&quot;Batch&quot;迁移脚本</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/04_01_controlling_table_reflection.html"><strong aria-hidden="true">5.1.</strong> 控制表反射</a></li><li class="chapter-item "><a href="zh/04_02_dealing_with_constraints.html"><strong aria-hidden="true">5.2.</strong> 处理约束</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/04_02_01_dropping_unnamed_or_named_foreign_key_constraints.html"><strong aria-hidden="true">5.2.1.</strong> 删除未命名或命名的外键约束</a></li><li class="chapter-item "><a href="zh/04_02_02_including_unnamed_unique_constraints.html"><strong aria-hidden="true">5.2.2.</strong> 包含未命名的 UNIQUE 约束</a></li><li class="chapter-item "><a href="zh/04_02_03_changing_the_type_of_boolean.html"><strong aria-hidden="true">5.2.3.</strong> 更改布尔、枚举和其他隐式 CHECK 数据类型的类型</a></li><li class="chapter-item "><a href="zh/04_02_04_including_check_constraints.html"><strong aria-hidden="true">5.2.4.</strong> 包括 CHECK 约束</a></li><li class="chapter-item "><a href="zh/04_02_05_dealing_with_referencing_foreign_keys.html"><strong aria-hidden="true">5.2.5.</strong> 处理引用外键</a></li></ol></li><li class="chapter-item "><a href="zh/04_03_working_in_offline_mode.html"><strong aria-hidden="true">5.3.</strong> 在离线模式下工作</a></li><li class="chapter-item "><a href="zh/04_04_batch_mode_with_autogenerate.html"><strong aria-hidden="true">5.4.</strong> 带自动生成的批处理模式</a></li><li class="chapter-item "><a href="zh/04_05_batch_mode_with_databases_other_than_sqlite.html"><strong aria-hidden="true">5.5.</strong> SQLite 以外的数据库的批处理模式</a></li></ol></li><li class="chapter-item expanded "><a href="zh/05_working_with_branches.html"><strong aria-hidden="true">6.</strong> 工作分支</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/05_01_merging_branches.html"><strong aria-hidden="true">6.1.</strong> 合并分支</a></li><li class="chapter-item "><a href="zh/05_02_working_with_explicit_branches.html"><strong aria-hidden="true">6.2.</strong> 使用显式分支</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/05_02_01_referring_to_all_heads_at_once.html"><strong aria-hidden="true">6.2.1.</strong> 一次引用到所有的head</a></li><li class="chapter-item "><a href="zh/05_02_02_referring_to_a_specific_version.html"><strong aria-hidden="true">6.2.2.</strong> 引用特定版本</a></li><li class="chapter-item "><a href="zh/05_02_03_working_with_branch_labels.html"><strong aria-hidden="true">6.2.3.</strong> 使用分支标注</a></li><li class="chapter-item "><a href="zh/05_02_04_more_label_syntaxes.html"><strong aria-hidden="true">6.2.4.</strong> 更多标注语法</a></li></ol></li><li class="chapter-item "><a href="zh/05_03_working_with_multiple_bases.html"><strong aria-hidden="true">6.3.</strong> 基于多个base工作</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/05_03_01_setting_up_multiple_version_directories.html"><strong aria-hidden="true">6.3.1.</strong> 设置多版本目录</a></li><li class="chapter-item "><a href="zh/05_03_01_creating_a_labeled_base_revision.html"><strong aria-hidden="true">6.3.2.</strong> 创建带标注的基本修订</a></li><li class="chapter-item "><a href="zh/05_03_02_running_with_multiple_bases.html"><strong aria-hidden="true">6.3.3.</strong> 基于多个base运行</a></li></ol></li><li class="chapter-item "><a href="zh/05_04_branch_dependencies.html"><strong aria-hidden="true">6.4.</strong> 分支依赖</a></li></ol></li><li class="chapter-item expanded "><a href="zh/06_operation_reference.html"><strong aria-hidden="true">7.</strong> operation参考</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/06_01_operations.html"><strong aria-hidden="true">7.1.</strong> alembic.operations.Operations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/06_01_01_add_column.html"><strong aria-hidden="true">7.1.1.</strong> add_column</a></li><li class="chapter-item "><a href="zh/06_01_02_alter_column.html"><strong aria-hidden="true">7.1.2.</strong> alter_column</a></li><li class="chapter-item "><a href="zh/06_01_03_batch_alter_table.html"><strong aria-hidden="true">7.1.3.</strong> batch_alter_table</a></li><li class="chapter-item "><a href="zh/06_01_04_bulk_insert.html"><strong aria-hidden="true">7.1.4.</strong> bulk_insert</a></li><li class="chapter-item "><a href="zh/06_01_05_create_check_constraint.html"><strong aria-hidden="true">7.1.5.</strong> create_check_constraint</a></li><li class="chapter-item "><a href="zh/06_01_06_create_exclude_constraint.html"><strong aria-hidden="true">7.1.6.</strong> create_exclude_constraint</a></li><li class="chapter-item "><a href="zh/06_01_07_create_foreign_key.html"><strong aria-hidden="true">7.1.7.</strong> create_foreign_key</a></li><li class="chapter-item "><a href="zh/06_01_08_create_index.html"><strong aria-hidden="true">7.1.8.</strong> create_index</a></li><li class="chapter-item "><a href="zh/06_01_09_create_primary_key.html"><strong aria-hidden="true">7.1.9.</strong> create_primary_key</a></li><li class="chapter-item "><a href="zh/06_01_10_create_table.html"><strong aria-hidden="true">7.1.10.</strong> create_table</a></li><li class="chapter-item "><a href="zh/06_01_11_create_table_comment.html"><strong aria-hidden="true">7.1.11.</strong> create_table_comment</a></li><li class="chapter-item "><a href="zh/06_01_12_create_unique_constraint.html"><strong aria-hidden="true">7.1.12.</strong> create_unique_constraint</a></li><li class="chapter-item "><a href="zh/06_01_13_drop_column.html"><strong aria-hidden="true">7.1.13.</strong> drop_column</a></li><li class="chapter-item "><a href="zh/06_01_14_drop_constraint.html"><strong aria-hidden="true">7.1.14.</strong> drop_constraint</a></li><li class="chapter-item "><a href="zh/06_01_15_drop_index.html"><strong aria-hidden="true">7.1.15.</strong> drop_index</a></li><li class="chapter-item "><a href="zh/06_01_16_drop_table.html"><strong aria-hidden="true">7.1.16.</strong> drop_table</a></li><li class="chapter-item "><a href="zh/06_01_17_drop_table_comment.html"><strong aria-hidden="true">7.1.17.</strong> drop_table_comment</a></li><li class="chapter-item "><a href="zh/06_01_18_execute.html"><strong aria-hidden="true">7.1.18.</strong> execute</a></li><li class="chapter-item "><a href="zh/06_01_19_f.html"><strong aria-hidden="true">7.1.19.</strong> f</a></li><li class="chapter-item "><a href="zh/06_01_20_get_bind.html"><strong aria-hidden="true">7.1.20.</strong> get_bind</a></li><li class="chapter-item "><a href="zh/06_01_21_get_context.html"><strong aria-hidden="true">7.1.21.</strong> get_context</a></li><li class="chapter-item "><a href="zh/06_01_22_implementation_for.html"><strong aria-hidden="true">7.1.22.</strong> implementation_for</a></li><li class="chapter-item "><a href="zh/06_01_23_inline_literal.html"><strong aria-hidden="true">7.1.23.</strong> inline_literal</a></li><li class="chapter-item "><a href="zh/06_01_24_invoke.html"><strong aria-hidden="true">7.1.24.</strong> invoke</a></li><li class="chapter-item "><a href="zh/06_01_25_register_operation.html"><strong aria-hidden="true">7.1.25.</strong> register_operation</a></li><li class="chapter-item "><a href="zh/06_01_26_rename_table.html"><strong aria-hidden="true">7.1.26.</strong> rename_table</a></li></ol></li><li class="chapter-item "><a href="zh/06_02_batch_operations.html"><strong aria-hidden="true">7.2.</strong> alembic.operations.BatchOperations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/06_02_01_add_column.html"><strong aria-hidden="true">7.2.1.</strong> add_column</a></li><li class="chapter-item "><a href="zh/06_02_02_alter_column.html"><strong aria-hidden="true">7.2.2.</strong> alter_column</a></li><li class="chapter-item "><a href="zh/06_02_03_create_check_constraint.html"><strong aria-hidden="true">7.2.3.</strong> create_check_constraint</a></li><li class="chapter-item "><a href="zh/06_02_04_create_exclude_constraint.html"><strong aria-hidden="true">7.2.4.</strong> create_exclude_constraint</a></li><li class="chapter-item "><a href="zh/06_02_05_create_foreign_key.html"><strong aria-hidden="true">7.2.5.</strong> create_foreign_key</a></li><li class="chapter-item "><a href="zh/06_02_06_create_index.html"><strong aria-hidden="true">7.2.6.</strong> create_index</a></li><li class="chapter-item "><a href="zh/06_02_07_create_primary_key.html"><strong aria-hidden="true">7.2.7.</strong> create_primary_key</a></li><li class="chapter-item "><a href="zh/06_02_08_create_table_comment.html"><strong aria-hidden="true">7.2.8.</strong> create_table_comment</a></li><li class="chapter-item "><a href="zh/06_02_09_create_unique_constraint.html"><strong aria-hidden="true">7.2.9.</strong> create_unique_constraint</a></li><li class="chapter-item "><a href="zh/06_02_10_drop_column.html"><strong aria-hidden="true">7.2.10.</strong> drop_column</a></li><li class="chapter-item "><a href="zh/06_02_11_drop_constraint.html"><strong aria-hidden="true">7.2.11.</strong> drop_constraint</a></li><li class="chapter-item "><a href="zh/06_02_12_drop_index.html"><strong aria-hidden="true">7.2.12.</strong> drop_index</a></li><li class="chapter-item "><a href="zh/06_02_13_drop_table_comment.html"><strong aria-hidden="true">7.2.13.</strong> drop_table_comment</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="zh/07_cook_book.html"><strong aria-hidden="true">8.</strong> cookbook</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/07_01_building_an_up_to_date_database_from_scratch.html"><strong aria-hidden="true">8.1.</strong> 从头开始构建最新的数据库</a></li><li class="chapter-item "><a href="zh/07_02_conditional_migration_elements.html"><strong aria-hidden="true">8.2.</strong> 条件迁移元素</a></li><li class="chapter-item "><a href="zh/07_03_sharing_a_connection_with_a_series_of_migration_commands_and_environments.html"><strong aria-hidden="true">8.3.</strong> 与一系列迁移命令和环境共享连接</a></li><li class="chapter-item "><a href="zh/07_04_replaceable_objects.html"><strong aria-hidden="true">8.4.</strong> 可替换对象</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/07_04_01_the_replaceable_object_structure.html"><strong aria-hidden="true">8.4.1.</strong> 可替换对象结构</a></li><li class="chapter-item "><a href="zh/07_04_02_create_operations_for_the_target_objects.html"><strong aria-hidden="true">8.4.2.</strong> 为目标对象创建操作</a></li><li class="chapter-item "><a href="zh/07_04_03_create_initial_migrations.html"><strong aria-hidden="true">8.4.3.</strong> 创建初始迁移</a></li><li class="chapter-item "><a href="zh/07_04_04_create_revision_migrations.html"><strong aria-hidden="true">8.4.4.</strong> 创建修订迁移</a></li></ol></li><li class="chapter-item "><a href="zh/07_05_rudimental_schema_level_multi_tenancy_for_postgresql_databases.html"><strong aria-hidden="true">8.5.</strong> PostgreSQL 数据库的基本架构级多租户</a></li><li class="chapter-item "><a href="zh/07_06_dont_generate_empty_migrations_with_autogenerate.html"><strong aria-hidden="true">8.6.</strong> 不要使用 Autogenerate 生成空迁移</a></li><li class="chapter-item "><a href="zh/07_07_dont_emit_drop_index_when_the_table_is_to_be_dropped_as_well.html"><strong aria-hidden="true">8.7.</strong> 当表也将被删除时不要发出 DROP INDEX</a></li><li class="chapter-item "><a href="zh/07_08_dont_generate_any_drop_table_directives_with_autogenerate.html"><strong aria-hidden="true">8.8.</strong> 不要使用autogenerate生成任何 DROP TABLE 指令</a></li><li class="chapter-item "><a href="zh/07_09_apply_custom_sorting_to_table_columns_within_create_table.html"><strong aria-hidden="true">8.9.</strong> 将自定义排序应用于 CREATE TABLE 中的表列</a></li><li class="chapter-item "><a href="zh/07_10_dont_emit_create_table_statements_for_views.html"><strong aria-hidden="true">8.10.</strong> 不要为视图发出 CREATE TABLE 语句</a></li><li class="chapter-item "><a href="zh/07_11_run_multiple_alembic_environments_from_one_ini_file.html"><strong aria-hidden="true">8.11.</strong> 从一个 .ini 文件运行多个 Alembic 环境</a></li><li class="chapter-item "><a href="zh/07_12_print_python_code_to_generate_particular_database_tables.html"><strong aria-hidden="true">8.12.</strong> 打印 Python 代码以生成特定的数据库表</a></li><li class="chapter-item "><a href="zh/07_13_run_alembic_operation_objects_directly_as_in_from_autogenerate.html"><strong aria-hidden="true">8.13.</strong> 直接运行 Alembic 操作对象（如来自autogenerate）</a></li><li class="chapter-item "><a href="zh/07_14_test_current_database_revision_is_at_heads.html"><strong aria-hidden="true">8.14.</strong> 测试当前的数据库修订版本处于head</a></li><li class="chapter-item "><a href="zh/07_15_using_asyncio_with_alembic.html"><strong aria-hidden="true">8.15.</strong> 将 Asyncio 与 Alembic 结合使用</a></li></ol></li><li class="chapter-item expanded "><a href="zh/08_api_details.html"><strong aria-hidden="true">9.</strong> API详细</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_01_overview.html"><strong aria-hidden="true">9.1.</strong> 概览</a></li><li class="chapter-item "><a href="zh/08_02_runtime_objects.html"><strong aria-hidden="true">9.2.</strong> 运行时对象</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_02_01_the_environment_context.html"><strong aria-hidden="true">9.2.1.</strong> 环境上下文</a></li><li class="chapter-item "><a href="zh/08_02_02_the_migration_context.html"><strong aria-hidden="true">9.2.2.</strong> 迁移上下文</a></li></ol></li><li class="chapter-item "><a href="zh/08_03_configuration.html"><strong aria-hidden="true">9.3.</strong> 配置</a></li><li class="chapter-item "><a href="zh/08_04_commands.html"><strong aria-hidden="true">9.4.</strong> 命令</a></li><li class="chapter-item "><a href="zh/08_05_operation_directives.html"><strong aria-hidden="true">9.5.</strong> 操作指令</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_05_01_operation_plugins.html"><strong aria-hidden="true">9.5.1.</strong> 操作插件</a></li><li class="chapter-item "><a href="zh/08_05_02_built_in_operation_objects.html"><strong aria-hidden="true">9.5.2.</strong> 内置操作对象</a></li></ol></li><li class="chapter-item "><a href="zh/08_06_autogeneration.html"><strong aria-hidden="true">9.6.</strong> 自动生成</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_06_01_getting_diffs.html"><strong aria-hidden="true">9.6.1.</strong> 获取差异</a></li><li class="chapter-item "><a href="zh/08_06_02_customizing_revision_generation.html"><strong aria-hidden="true">9.6.2.</strong> 生成自定义修订</a></li><li class="chapter-item "><a href="zh/08_06_03_autogenerating_custom_operation_directives.html"><strong aria-hidden="true">9.6.3.</strong> Autogenerate自定义操作指令</a></li></ol></li><li class="chapter-item "><a href="zh/08_07_script_directory.html"><strong aria-hidden="true">9.7.</strong> 脚本目录</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_07_01_revision.html"><strong aria-hidden="true">9.7.1.</strong> 修订</a></li><li class="chapter-item "><a href="zh/08_07_02_write_hooks.html"><strong aria-hidden="true">9.7.2.</strong> 写钩子</a></li></ol></li><li class="chapter-item "><a href="zh/08_08_ddl_internals.html"><strong aria-hidden="true">9.8.</strong> DDL 内部结构</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="zh/08_08_01_mysql.html"><strong aria-hidden="true">9.8.1.</strong> MySQL</a></li><li class="chapter-item "><a href="zh/08_08_02_ms_sql.html"><strong aria-hidden="true">9.8.2.</strong> MS-SQL</a></li><li class="chapter-item "><a href="zh/08_08_03_postgresql.html"><strong aria-hidden="true">9.8.3.</strong> Postgresql</a></li><li class="chapter-item "><a href="zh/08_08_04_sqlite.html"><strong aria-hidden="true">9.8.4.</strong> SQLite</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="zh/09_change_log.html"><strong aria-hidden="true">10.</strong> 更新历史</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="en/genindex.html">index</a></li><li class="chapter-item expanded affix "><a href="en/py-modindex.html">module-index</a></li><li class="chapter-item expanded affix "><a href="en/index.html">Document-English</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">alembic 中文文档</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="前言"><a class="header" href="#前言">前言</a></h1>
<p><a href="https://alembic.sqlalchemy.org/">Alembic</a> is a lightweight database migration tool for usage with the SQLAlchemy Database Toolkit for Python.</p>
<blockquote>
<p><a href="https://alembic.sqlalchemy.org/">Alembic</a> 是一种轻量级数据库迁移工具，可与<a href="https://www.python.org/">Python</a>的 <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a> 数据库库工具包一起使用。</p>
</blockquote>
<h1 id="front-matter-指南"><a class="header" href="#front-matter-指南">Front Matter (指南)</a></h1>
<p>Information about the Alembic project.</p>
<blockquote>
<p>有关 Alembic 项目的信息。</p>
</blockquote>
<h2 id="project-homepage-项目主页"><a class="header" href="#project-homepage-项目主页">Project Homepage (项目主页)</a></h2>
<p>Alembic is hosted on GitHub at <a href="https://github.com/sqlalchemy/alembic">https://github.com/sqlalchemy/alembic</a> under the SQLAlchemy organization.</p>
<blockquote>
<p>Alembic 托管在 GitHub 上，网址为 <a href="https://github.com/sqlalchemy/alembic">https://github.com/sqlalchemy/alembic</a>，隶属于 SQLAlchemy 组织。</p>
</blockquote>
<p>Releases and project status are available on Pypi at <a href="https://pypi.python.org/pypi/alembic">https://pypi.python.org/pypi/alembic</a>.</p>
<blockquote>
<p>发布和项目状态可在 Pypi 上获取，网址为 <a href="https://pypi.python.org/pypi/alembic">https://pypi.python.org/pypi/alembic</a>。</p>
</blockquote>
<p>The most recent published version of this documentation should be at <a href="https://alembic.sqlalchemy.org">https://alembic.sqlalchemy.org</a>.</p>
<blockquote>
<p>本文档的最新发布版本位于 <a href="https://alembic.sqlalchemy.org">https://alembic.sqlalchemy.org</a>。</p>
</blockquote>
<h2 id="installation-安装"><a class="header" href="#installation-安装">Installation （安装）</a></h2>
<p>While Alembic can be installed system wide, it’s more common that it’s installed local to a <a href="https://docs.python.org/3/tutorial/venv.html">virtual environment</a> , as it also uses libraries such as SQLAlchemy and database drivers that are more appropriate for local installations.</p>
<blockquote>
<p>虽然 Alembic 可以在系统范围内安装，但更常见的是将其安装在本地<a href="https://docs.python.org/3/tutorial/venv.html">虚拟环境</a>中，因为它还使用更适合本地安装的 SQLAlchemy 和数据库驱动程序等库。</p>
</blockquote>
<p>The documentation below is only one kind of approach to installing Alembic for a project; there are many such approaches. The documentation below is provided only for those users who otherwise have no specific project setup chosen.</p>
<blockquote>
<p>下面的文档只是为项目安装 Alembic 的一种方法； 有很多这样的方法。 下面的文档仅提供给那些没有选择特定项目设置的用户。</p>
</blockquote>
<p>To build a virtual environment for a specific project, first we assume that <a href="https://pypi.org/project/virtualenv/">Python virtualenv</a> is installed systemwide. Then:</p>
<blockquote>
<p>要为特定项目构建虚拟环境，首先我们假设 <a href="https://pypi.org/project/virtualenv/">Python virtualenv</a> 已安装在系统范围内。 然后：</p>
</blockquote>
<pre><code class="language-bash">cd /path/to/your/project
virtualenv .venv
</code></pre>
<p>There is now a Python interpreter that you can access in <code>/path/to/your/project/.venv/bin/python</code>, as well as the pip installer tool in <code>/path/to/your/project/.venv/bin/pip</code>.</p>
<blockquote>
<p>现在有一个 Python 解释器，您可以在 <code>/path/to/your/project/.venv/bin/python</code> 中访问，以及 <code>/path/to/your/project/.venv/bin/pip</code> 中的 pip 安装程序工具.</p>
</blockquote>
<p>We now install Alembic as follows:</p>
<blockquote>
<p>我们现在按如下方式安装 Alembic：</p>
</blockquote>
<pre><code class="language-bash">/path/to/your/project/.venv/bin/pip install alembic
</code></pre>
<p>The install will add the alembic command to the virtual environment. All operations with Alembic in terms of this specific virtual environment will then proceed through the usage of this command, as in:</p>
<blockquote>
<p>安装会将 alembic 命令添加到虚拟环境中。 然后，在此特定虚拟环境中使用 Alembic 的所有操作都将通过使用此命令进行，如下所示：</p>
</blockquote>
<pre><code class="language-bash">/path/to/your/project/.venv/bin/alembic init .
</code></pre>
<p>The next step is optional. If our project itself has a setup.py file, we can also install it in the local virtual environment in <a href="https://pip.pypa.io/en/stable/reference/pip_install/#editable-installs">editable mode</a>:</p>
<blockquote>
<p>下一步是可选的。 如果我们的项目本身有setup.py文件，我们也可以在本地虚拟环境中以<a href="https://pip.pypa.io/en/stable/reference/pip_install/#editable-installs">可编辑的模式</a>安装：</p>
</blockquote>
<pre><code class="language-bash">/path/to/your/project/.venv/bin/pip install -e .
</code></pre>
<p>If we don’t “install” the project locally, that’s fine as well; the default alembic.ini file includes a directive <code>prepend_sys_path = .</code> so that the local path is also in sys.path. This allows us to run the alembic command line tool from this directory without our project being “installed” in that environment.</p>
<blockquote>
<p>如果我们不在本地“安装”项目，那也没关系； 默认的 alembic.ini 文件包含一个指令 <code>prepend_sys_path = .</code> 这样本地路径也在 <code>sys.path</code> 中。 这允许我们从该目录运行 alembic 命令行工具，而无需在该环境中“安装”我们的项目。</p>
</blockquote>
<blockquote>
<p><em>Changed in version 1.5.5: Fixed a long-standing issue where the <code>alembic</code> command-line tool would not preserve the default <code>sys.path</code> of <code>.</code> by implementing <code>prepend_sys_path</code> option.</em></p>
</blockquote>
<blockquote>
<p>1.5.5版本更新: 修复了一个长期存在的问题，即 alembic 命令行工具不会通过实现 <code>prepend_sys_path</code> 选项来保留当前目录(<code>.</code>)在<code>sys.path</code>中。</p>
</blockquote>
<p>As a final step, the <a href="https://virtualenv.pypa.io/en/latest/userguide/#activate-script">virtualenv activate</a> tool can be used so that the <code>alembic</code> command is available without any path information, within the context of the current shell:</p>
<blockquote>
<p>作为最后一步，可以使用 <a href="https://virtualenv.pypa.io/en/latest/userguide/#activate-script">virtualenv activate</a> 工具，以便在当前 shell 的上下文中无需任何路径信息即可使用 <code>alembic</code> 命令：</p>
</blockquote>
<pre><code class="language-bash">source /path/to/your/project/.venv/bin/activate
</code></pre>
<h3 id="dependencies-依赖"><a class="header" href="#dependencies-依赖">Dependencies (依赖)</a></h3>
<p>Alembic’s install process will ensure that <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a> is installed, in addition to other dependencies. Alembic will work with SQLAlchemy as of version 1.3.0.</p>
<blockquote>
<p>除了其他依赖项外，<a href="https://alembic.sqlalchemy.org/">Alembic</a> 安装过程将确保安装 <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a>。 从 1.3.0 版本开始，<a href="https://alembic.sqlalchemy.org/">Alembic</a> 将与 <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a> 一起使用。</p>
</blockquote>
<blockquote>
<p>Changed in version 1.5.0: Support for SQLAlchemy older than 1.3.0 was dropped.</p>
</blockquote>
<blockquote>
<p>版本1.5.0更新: 不再支持 1.3.0 版本之前的 SQLAlchemy。</p>
</blockquote>
<p>Alembic supports Python versions 3.6 and above</p>
<blockquote>
<p>Alembic 支持 Python 3.6 及以上版本</p>
</blockquote>
<blockquote>
<p>Changed in version 1.7: Alembic now supports Python 3.6 and newer; support for Python 2.7 has been dropped.</p>
</blockquote>
<blockquote>
<p>版本1.7更新: Alembic 现在支持 Python 3.6 及更新的版本； 已取消对 Python 2.7 的支持。</p>
</blockquote>
<h2 id="community-社区"><a class="header" href="#community-社区">Community (社区)</a></h2>
<p>Alembic is developed by <a href="http://techspot.zzzeek.org/">Mike Bayer</a>, and is loosely associated with the <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a>, <a href="http://www.pylonsproject.org/">Pylons</a>, and <a href="http://www.openstack.org/">Openstack</a> projects.</p>
<blockquote>
<p>Alembic 由 <a href="http://techspot.zzzeek.org/">Mike Bayer</a> 开发，与 <a href="https://docs.sqlalchemy.org/">SQLAlchemy</a>、<a href="http://www.pylonsproject.org/">Pylons</a> 和 <a href="http://www.openstack.org/">Openstack</a> 项目松散关联。</p>
</blockquote>
<p>User issues, discussion of potential bugs and features should be posted to the Alembic Google Group at <a href="https://groups.google.com/group/sqlalchemy-alembic">sqlalchemy-alembic</a>.</p>
<blockquote>
<p>用户问题、潜在错误和功能的讨论应发布到 Alembic 在 Google Group群组上的 <a href="https://groups.google.com/group/sqlalchemy-alembic">sqlalchemy-alembic</a>。</p>
</blockquote>
<h2 id="bugs-问题"><a class="header" href="#bugs-问题">Bugs (问题)</a></h2>
<p>Bugs and feature enhancements to Alembic should be reported on the <a href="https://github.com/sqlalchemy/alembic/issues/">GitHub issue tracker</a>.</p>
<blockquote>
<p>应在 <a href="https://github.com/sqlalchemy/alembic/issues/">GitHub issue tracker</a> 上报告 Alembic 的错误和功能加强。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tutorial"><a class="header" href="#tutorial">Tutorial</a></h1>
<p><strong>指南</strong></p>
<p>Alembic provides for the creation, management, and invocation of change management scripts for a relational database, using SQLAlchemy as the underlying engine. This tutorial will provide a full introduction to the theory and usage of this tool.</p>
<blockquote>
<p>Alembic 使用 SQLAlchemy 作为底层引擎，为关系数据库提供变更管理脚本的创建、管理和调用。 本教程将全面介绍该工具的理论和用法。</p>
</blockquote>
<p>To begin, make sure Alembic is installed as described at <a href="zh//zh/_front_matter.html#installation-%E5%AE%89%E8%A3%85">Installation</a>. As stated in the linked document, it is usually preferable that Alembic is installed in the <strong>same module / Python path as that of the target project</strong>, usually using a <a href="https://docs.python.org/3/tutorial/venv.html">Python virtual environment</a>, so that when the <code>alembic</code> command is run, the Python script which is invoked by <code>alembic</code>, namely your project’s <code>env.py</code> script, will have access to your application’s models. This is not strictly necessary in all cases, however in the vast majority of cases is usually preferred.</p>
<blockquote>
<p>首先，请确保按照 <a href="zh//zh/_front_matter.html#installation-%E5%AE%89%E8%A3%85">安装</a> 中的说明安装 <code>Alembic</code> 。 如文档中所述，通常最好将 <code>Alembic</code> 安装在与目标项目相同的 / Python 路径的模块中，通常使用<a href="https://docs.python.org/3/tutorial/venv.html">Python 虚拟环境</a>，以便在运行 alembic 命令时，Python 脚本 由 alembic 调用，即你项目的 <code>env.py</code> 脚本，将可以访问您的应用程序模型。 这并非在所有情况下都严格必要，但在绝大多数情况下通常是首选。</p>
</blockquote>
<p>The tutorial below assumes the <code>alembic</code> command line utility is present in the local path and when invoked, will have access to the same Python module environment as that of the target project.</p>
<blockquote>
<p>下面的教程假设 <code>alembic</code> 命令行实用程序存在于本地路径中，并且在调用时，将可以访问与目标项目相同的 Python 模块环境。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="迁移环境"><a class="header" href="#迁移环境">迁移环境</a></h1>
<p>Usage of Alembic starts with creation of the <em>Migration Environment</em>. This is a directory of scripts that is specific to a particular application. The migration environment is created just once, and is then maintained along with the application’s source code itself. The environment is created using the <em>init</em> command of Alembic, and is then customizable to suit the specific needs of the application.</p>
<blockquote>
<p>使用 Alembic 从创建<em><strong>迁移环境</strong></em>开始。这是独立于应用程序的特别脚本目录。迁移环境只创建一次，然后与应用程序的源代码本身一起维护。该环境是使用 Alembic 的 <code>init</code> 命令创建的，然后可以自定义以满足应用程序的特别需求。</p>
</blockquote>
<p>The structure of this environment, including some generated migration scripts, looks like:</p>
<blockquote>
<p>这个环境的结构，包括一些生成的迁移脚本，看起来像：</p>
</blockquote>
<pre><code class="language-text">yourproject/
    alembic/
        env.py
        README
        script.py.mako
        versions/
            3512b954651e_add_account.py
            2b1ae634e5cd_add_order_id.py
            3adcc9a56557_rename_username_field.py
</code></pre>
<p>The directory includes these directories/files:</p>
<blockquote>
<p>该目录包括以下目录/文件：</p>
</blockquote>
<ul>
<li>
<p><strong>yourproject</strong> - this is the root of your application’s source code, or some directory within it.</p>
</li>
<li>
<blockquote>
<p><strong>yourproject</strong> - 这是应用程序源代码的根目录，或其中的某个目录。</p>
</blockquote>
</li>
<li>
<p><strong>alembic</strong> - this directory lives within your application’s source tree and is the home of the migration environment. It can be named anything, and a project that uses multiple databases may even have more than one.</p>
</li>
<li>
<blockquote>
<p><strong>alembic</strong> - 该目录位于应用程序的源代码树中，是迁移环境的主目录。 它可以命名为任何名称，一个使用多个数据库的项目甚至可能有多个。</p>
</blockquote>
</li>
<li>
<p><strong>env.py</strong> - This is a Python script that is run whenever the alembic migration tool is invoked. At the very least, it contains instructions to configure and generate a SQLAlchemy engine, procure a connection from that engine along with a transaction, and then invoke the migration engine, using the connection as a source of database connectivity.</p>
</li>
<li>
<blockquote>
<p><strong>env.py</strong> - 这是一个 Python 脚本，只要调用 alembic 迁移工具就会运行。至少，它包含配置和生成 SQLAlchemy 引擎的指令，从该引擎获取连接以及事务，然后调用迁移引擎，使用该连接作为数据库连接的来源。</p>
</blockquote>
<p>The <code>env.py</code> script is part of the generated environment so that the way migrations run is entirely customizable. The exact specifics of how to connect are here, as well as the specifics of how the migration environment are invoked. The script can be modified so that multiple engines can be operated upon, custom arguments can be passed into the migration environment, application-specific libraries and models can be loaded in and made available.</p>
<blockquote>
<p><code>env.py</code> 脚本是生成环境的一部分，因此迁移运行的方式是完全可定制的。 如何连接的确切细节在这里，以及如何调用迁移环境的细节。 可以修改脚本以便可以操作多个引擎，可以将自定义参数传递到迁移环境中，可以加载特定于应用程序的库和模型并使其可用。</p>
</blockquote>
<p>Alembic includes a set of initialization templates which feature different varieties of <code>env.py</code> for different use cases.</p>
<blockquote>
<p>Alembic 包含一组初始化模板，其中包含针对不同用例的不同类型的 <code>env.py</code>。</p>
</blockquote>
</li>
<li>
<p><strong>README</strong> - included with the various environment templates, should have something informative.</p>
</li>
<li>
<blockquote>
<p><strong>README</strong> - 包含在各种环境模板中，应该有的一些说明信息。</p>
</blockquote>
</li>
<li>
<p><strong>script.py.mako</strong> - This is a <a href="http://www.makotemplates.org/">Mako</a> template file which is used to generate new migration scripts. Whatever is here is used to generate new files within <code>versions/</code>. This is scriptable so that the structure of each migration file can be controlled, including standard imports to be within each, as well as changes to the structure of the <code>upgrade()</code> and <code>downgrade()</code> functions. For example, the <code>multidb</code> environment allows for multiple functions to be generated using a naming scheme <code>upgrade_engine1()</code>, <code>upgrade_engine2()</code>.</p>
</li>
<li>
<blockquote>
<p><strong>script.py.mako</strong> - 这是一个 <a href="http://www.makotemplates.org/">Mako</a> 模板文件，用于生成新的迁移脚本。 这里的任何内容都用于在 <code>versions/</code> 中生成新文件。 这是可编的写脚本，因此可以控制每个迁移文件的结构，包括每个迁移文件中的标准导入，以及对 <code>upgrade()</code> 和 <code>downgrade()</code> 函数结构的更改。 例如，多数据库(multidb)环境允许使用命名方案<code>upgrade_engine1()</code>、<code>upgrade_engine2()</code>生成多个函数。</p>
</blockquote>
</li>
<li>
<p><strong>versions/</strong> - This directory holds the individual version scripts. Users of other migration tools may notice that the files here don’t use ascending integers, and instead use a partial GUID approach. In Alembic, the ordering of version scripts is relative to directives within the scripts themselves, and it is theoretically possible to “splice” version files in between others, allowing migration sequences from different branches to be merged, albeit carefully by hand.</p>
</li>
<li>
<blockquote>
<p><strong>versions/</strong> 该目录包含各个版本的脚本。 其他迁移工具的用户可能会注意到这里的文件不使用升序整数，而是使用部分 GUID 方法。 在 Alembic 中，版本脚本的排序与脚本本身内的指令相关，理论上可以在其他版本文件之间“拼接”版本文件，允许合并来自不同分支的迁移序列，尽管需要小心的手动合并。</p>
</blockquote>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-an-environment"><a class="header" href="#creating-an-environment">Creating an Environment</a></h1>
<p><strong>创建环境</strong></p>
<p>With a basic understanding of what the environment is, we can create one using <code>alembic init</code>. This will create an environment using the “generic” template:</p>
<p>对环境是什么有了基本的了解后，我们可以使用 <code>alembic init</code> 创建一个。 这将使用“通用（generic）”模板创建一个环境：</p>
<pre><code class="language-bash">cd /path/to/yourproject
source /path/to/yourproject/.venv/bin/activate   # assuming a local virtualenv (激活一个本地环境)
alembic init alembic
</code></pre>
<p>Where above, the init command was called to generate a migrations directory called alembic:</p>
<p>在上面的地方，调用了 <code>init</code> 命令来生成一个名为 alembic 的迁移目录：</p>
<pre><code class="language-bash">Creating directory /path/to/yourproject/alembic...done
Creating directory /path/to/yourproject/alembic/versions...done
Generating /path/to/yourproject/alembic.ini...done
Generating /path/to/yourproject/alembic/env.py...done
Generating /path/to/yourproject/alembic/README...done
Generating /path/to/yourproject/alembic/script.py.mako...done
Please edit configuration/connection/logging settings in '/path/to/yourproject/alembic.ini' before proceeding.
</code></pre>
<p>Alembic also includes other environment templates. These can be listed out using the <code>list_templates</code> command:</p>
<p>Alembic 还包括其他环境模板。 这些可以使用 <code>list_templates</code> 命令列出：</p>
<pre><code class="language-bash">$ alembic list_templates
Available templates:

generic - Generic single-database configuration.
async - Generic single-database configuration with an async dbapi.
multidb - Rudimentary multi-database configuration.
pylons - Configuration that reads from a Pylons project environment.

Templates are used via the 'init' command, e.g.:

  alembic init --template pylons ./scripts
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="editing-the-ini-file"><a class="header" href="#editing-the-ini-file">Editing the .ini File</a></h1>
<p><strong>编辑.ini文件</strong></p>
<p>Alembic placed a file <code>alembic.ini</code> into the current directory. This is a file that the <code>alembic</code> script looks for when invoked. This file can exist in a different directory, with the location to it specified by either the <code>--config</code> option for the <code>alembic</code> runner or the <code>ALEMBIC_CONFIG</code> environment variable (the former takes precedence).</p>
<blockquote>
<p>Alembic 将文件 <code>alembic.ini</code> 放入当前目录。 这是 <code>alembic</code> 脚本在调用时查找的文件。 该文件可以存在于不同的目录中，其位置由 alembic runner 的 <code>--config</code> 选项或 <code>ALEMBIC_CONFIG</code> 环境变量（前者优先）指定。</p>
</blockquote>
<p>The file generated with the “generic” configuration looks like:</p>
<blockquote>
<p>使用“通用(generic)”配置生成的文件如下所示：</p>
</blockquote>
<pre><code class="language-ini"># A generic, single database configuration.
# 通用的单一数据库配置。

[alembic]
# path to migration scripts
# 迁移脚本的路径
script_location = alembic

# template used to generate migration files
# 用于生成迁移文件的模板
# file_template = %%(rev)s_%%(slug)s

# sys.path path, will be prepended to sys.path if present.
# defaults to the current working directory.
# (new in 1.5.5)

# sys.path 路径，如果存在，将被添加到 sys.path 之前。
# 默认为当前工作目录。
# 版本1.5.5中新增
prepend_sys_path = .

# timezone to use when rendering the date within the migration file
# as well as the filename.
# If specified, requires the python-dateutil library that can be
# installed by adding `alembic[tz]` to the pip requirements
# string value is passed to dateutil.tz.gettz()
# leave blank for localtime

# 在迁移文件中呈现日期以及文件名时要使用的时区。
# 如果指定，则需要可以通过将 `alembic[tz]` 添加到 pip 要求来安装的 python-dateutil 库
# 字符串值将传递给 dateutil.tz.gettz() 
# 本地时间留空
# timezone =

# max length of characters to apply to the
# &quot;slug&quot; field

# 应用于“slug”字段的最大字符长度
# truncate_slug_length = 40

# set to 'true' to run the environment during
# the 'revision' command, regardless of autogenerate

# 设置为 'true' 以在 'revision' 命令期间运行环境，而无论是否自动生成
# revision_environment = false

# set to 'true' to allow .pyc and .pyo files without
# a source .py file to be detected as revisions in the
# versions/ directory

# 设置为“true”以允许将没有源 .py 文件的 .pyc 和 .pyo 文件检测为 `versions/` 目录中的版本文件
# sourceless = false

# version location specification; This defaults
# to ${script_location}/versions.  When using multiple version
# directories, initial revisions must be specified with --version-path.
# The path separator used here should be the separator specified by &quot;version_path_separator&quot; below.

# 版本位置规范； 这默认为`${script_location}/versions`。 使用多个版本目录时，必须使用 --version-path 指定初始版本。
# 这里使用的路径分隔符应该是下面“version_path_separator”指定的分隔符。
# version_locations = %(here)s/bar:%(here)s/bat:${script_location}/versions

# version path separator; As mentioned above, this is the character used to split
# version_locations. The default within new alembic.ini files is &quot;os&quot;, which uses os.pathsep.
# If this key is omitted entirely, it falls back to the legacy behavior of splitting on spaces and/or commas.
# Valid values for version_path_separator are:
#
# 版本路径分隔符； 如上所述，这是用于拆分 version_locations 的字符。 新 alembic.ini 文件中的默认值是“os”，它使用 os.pathsep。
# 如果这个键被完全省略，它会退回到在空格和/或逗号上分割的传统行为。
# version_path_separator 的有效值为：
# 
# version_path_separator = :
# version_path_separator = ;
# version_path_separator = space
version_path_separator = os  # Use os.pathsep. Default configuration used for new projects. (使用 os.pathsep。 用于新项目的默认配置。)

# the output encoding used when revision files
# are written from script.py.mako
# 从 script.py.mako 写入修订文件时使用的输出编码
# output_encoding = utf-8

sqlalchemy.url = driver://user:pass@localhost/dbname

# [post_write_hooks]
# This section defines scripts or Python functions that are run
# on newly generated revision scripts.  See the documentation for further
# detail and examples
# 本节定义在新生成的修订脚本上运行的脚本或 Python 函数。 有关更多详细信息和示例，请参阅文档

# format using &quot;black&quot; - use the console_scripts runner,
# against the &quot;black&quot; entrypoint
# 使用“black”格式 - 使用 console_scripts runner，针对“black”入口点
# hooks = black
# black.type = console_scripts
# black.entrypoint = black
# black.options = -l 79 REVISION_SCRIPT_FILENAME

# Logging configuration
# 日志记录配置
[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S
</code></pre>
<p>The file is read using <strong>Python’s ConfigParser.SafeConfigParser</strong> object. The <code>%(here)s</code> variable is provided as a substitution variable, which can be used to produce absolute pathnames to directories and files, as we do above with the path to the Alembic script location.</p>
<blockquote>
<p>该文件是使用 Python 的 <strong>ConfigParser.SafeConfigParser</strong> 对象读取的。 <strong>%(here)s</strong> 变量作为替代变量提供，可用于生成目录和文件的绝对路径名，就像我们上面对 Alembic 脚本位置的路径所做的那样。</p>
</blockquote>
<p>This file contains the following features:</p>
<blockquote>
<p>该文件包含以下功能：</p>
</blockquote>
<ul>
<li>
<p>[alembic] - this is the section read by Alembic to determine configuration. Alembic itself does not directly read any other areas of the file. The name “alembic” can be customized using the <strong>--name</strong> commandline flag; see <a href="zh//zh/07_cook_book.html">Run Multiple Alembic Environments from one .ini</a> file for a basic example of this.</p>
</li>
<li>
<blockquote>
<p>[alembic] - 这是 Alembic 读取的用于确定配置的部分。 Alembic 本身不直接读取文件的任何其他区域。 可以使用 <strong>--name</strong> 命令行标志自定义名称“alembic”； 有关此操作的基本示例，请参阅<a href="zh//zh/07_cook_book.html">从一个 .ini 文件运行多个 Alembic 环境</a>。</p>
</blockquote>
</li>
<li>
<p><strong>script_location</strong> - this is the location of the Alembic environment. It is normally specified as a filesystem location, either relative or absolute. If the location is a relative path, it’s interpreted as relative to the current directory.</p>
</li>
<li>
<blockquote>
<p><strong>script_location</strong> - 这是 Alembic 环境的位置。 它通常被指定为相对或绝对的文件系统位置。 如果位置是相对路径，则将其解释为相对于当前目录。</p>
</blockquote>
<p>This is the only key required by Alembic in all cases. The generation of the .ini file by the command <code>alembic init alembic</code> automatically placed the directory name <code>alembic</code> here. The special variable <code>%(here)s</code> can also be used, as in <code>%(here)s/alembic</code>.</p>
<blockquote>
<p>这是 Alembic 在所有情况下都需要的唯一密钥。 通过命令 <code>alembic init alembic</code> 生成的 <code>.ini</code> 文件会自动将目录名 <code>alembic</code> 放置在这里。 也可以使用特殊变量 <code>%(here)s</code>，如 <code>%(here)s/alembic</code>。</p>
</blockquote>
<p>For support of applications that package themselves into .egg files, the value can also be specified as a <a href="https://setuptools.readthedocs.io/en/latest/pkg_resources.html">package resource</a>, in which case <strong>resource_filename()</strong> is used to find the file (new in 0.2.2). Any non-absolute URI which contains colons is interpreted here as a resource name, rather than a straight filename.</p>
<blockquote>
<p>为了支持将自身打包成 .egg 文件的应用程序，该值也可以指定为<a href="https://setuptools.readthedocs.io/en/latest/pkg_resources.html">包资源</a>，在这种情况下，<strong>resource_filename()</strong> 用于查找文件（版本0.2.2 中的新功能）。 任何包含冒号的非绝对 URI 在这里都被解释为资源名称，而不是直接的文件名。</p>
</blockquote>
</li>
<li>
<p><strong>file_template</strong> - this is the naming scheme used to generate new migration files. The value present is the default, so is commented out. Tokens available include:</p>
</li>
<li>
<blockquote>
<p><strong>file_template</strong> - 这是用于生成新迁移文件的命名方案。 存在的值是默认值，因此被注释掉。 可用的token包括：</p>
</blockquote>
<ul>
<li><strong>%%(rev)s</strong> - revision id (修订号)</li>
<li><strong>%%(slug)s</strong> - a truncated string derived from the revision message (从修订消息派生的截断字符串)</li>
<li><strong>%%(year)d</strong>, <strong>%%(month).2d</strong>, <strong>%%(day).2d</strong>, <strong>%%(hour).2d</strong>, <strong>%%(minute).2d</strong>, <strong>%%(second).2d</strong> - components of the create date, by default <strong>datetime.datetime.now()</strong> unless the <strong>timezone</strong> configuration option is also used. （创建日期的组成部分，默认为 <strong>datetime.datetime.now()</strong> 除非还使用了 <strong>timezone</strong> 配置选项。）</li>
</ul>
</li>
<li>
<p><strong>timezone</strong> - an optional timezone name (e.g. UTC, EST5EDT, etc.) that will be applied to the timestamp which renders inside the migration file’s comment as well as within the filename. This option requires installing the <strong>python-dateutil</strong> library. If <strong>timezone</strong> is specified, the create date object is no longer derived from <strong>datetime.datetime.now()</strong> and is instead generated as:</p>
</li>
<li>
<blockquote>
<p><strong>timezone</strong> - 一个可选的时区名称（例如 UTC、EST5EDT 等），它将应用于在迁移文件的注释以及文件名中呈现的时间戳。 此选项需要安装 <strong>python-dateutil</strong> 库。 如果指定了时区，则创建日期对象不再从 <strong>datetime.datetime.now()</strong> 派生，而是生成为：</p>
</blockquote>
<pre><code class="language-python">datetime.datetime.utcnow().replace(
    tzinfo=dateutil.tz.tzutc()
).astimezone(
    dateutil.tz.gettz(&lt;timezone&gt;)
)
</code></pre>
</li>
<li>
<p><strong>truncate_slug_length</strong> - defaults to 40, the max number of characters to include in the “slug” field.</p>
</li>
<li>
<blockquote>
<p><strong>truncate_slug_length</strong> - 默认为 40，即“slug”字段中包含的最大字符数。</p>
</blockquote>
</li>
<li>
<p><strong>sqlalchemy.url</strong> - A URL to connect to the database via SQLAlchemy. This configuration value is only used if the <strong>env.py</strong> file calls upon them; in the “generic” template, the call to <strong>config.get_main_option(&quot;sqlalchemy.url&quot;)</strong> in the <strong>run_migrations_offline()</strong> function and the call to <strong>engine_from_config(prefix=&quot;sqlalchemy.&quot;)</strong> in the <strong>run_migrations_online()</strong> function are where this key is referenced. If the SQLAlchemy URL should come from some other source, such as from environment variables or a global registry, or if the migration environment makes use of multiple database URLs, the developer is encouraged to alter the <strong>env.py</strong> file to use whatever methods are appropriate in order to acquire the database URL or URLs.</p>
</li>
<li>
<blockquote>
<p><strong>sqlalchemy.url</strong> - 通过 SQLAlchemy 连接到数据库的 URL。 此配置值仅在 <strong>env.py</strong> 文件调用它们时使用； 在“通用”模板中，<strong>run_migrations_offline()</strong> 函数中对 <strong>config.get_main_option(&quot;sqlalchemy.url&quot;)</strong> 的调用和 <strong>run_migrations_online()</strong> 函数中对 <strong>engine_from_config(prefix=&quot;sqlalchemy.&quot;)</strong> 的调用是该键所在的位置参考。 如果 SQLAlchemy URL 应该来自某些其他源，例如来自环境变量或全局注册表，或者如果迁移环境使用多个数据库 URL，则鼓励开发人员更改 <strong>env.py</strong> 文件以使用任何合适的方法以获取数据库 URL 或 其他URL。</p>
</blockquote>
</li>
<li>
<p><strong>revision_environment</strong> - this is a flag which when set to the value ‘true’, will indicate that the migration environment script <strong>env.py</strong> should be run unconditionally when generating new revision files, as well as when running the <strong>alembic history</strong> command.</p>
</li>
<li>
<blockquote>
<p><strong>revision_environment</strong> - 这是一个标志，当设置为值“true”时，将指示在生成新修订文件以及运行 alembic 历史命令时应无条件运行迁移环境脚本 <strong>env.py</strong>。</p>
</blockquote>
</li>
<li>
<p><strong>sourceless</strong> - when set to ‘true’, revision files that only exist as .pyc or .pyo files in the versions directory will be used as versions, allowing “sourceless” versioning folders. When left at the default of ‘false’, only .py files are consumed as version files.</p>
</li>
<li>
<blockquote>
<p><strong>sourceless</strong> - 当设置为“true”时，版本目录中仅作为 .pyc 或 .pyo 文件存在的修订文件将用作版本，允许“无源”版本控制文件夹。 当保留默认值“false”时，只有 .py 文件被用作版本文件。</p>
</blockquote>
</li>
<li>
<p><strong>version_locations</strong> - an optional list of revision file locations, to allow revisions to exist in multiple directories simultaneously. See <a href="zh//zh/07_cook_book.html">Working with Multiple Bases</a> for examples.</p>
</li>
<li>
<blockquote>
<p><strong>version_locations</strong> - 一个可选的修订文件位置列表，允许修订同时存在于多个目录中。 有关示例，请参阅 <a href="zh//zh/07_cook_book.html">Working with Multiple Bases</a>。</p>
</blockquote>
</li>
<li>
<p><strong>version_path_separator</strong> - a separator of <strong>version_locations</strong> paths. It should be defined if multiple version_locations is used. See <a href="zh//zh/07_cook_book.html">Working with Multiple Bases</a> for examples.</p>
</li>
<li>
<blockquote>
<p><strong>version_path_separator</strong> - version_locations 路径的分隔符。 如果使用多个 <strong>version_locations</strong>，则应定义它。 有关示例，请参阅<a href="zh//zh/07_cook_book.html">Working with Multiple Bases</a>。</p>
</blockquote>
</li>
<li>
<p><strong>output_encoding</strong> - the encoding to use when Alembic writes the <strong>script.py.mako</strong> file into a new migration file. Defaults to <code>'utf-8'</code>.</p>
</li>
<li>
<blockquote>
<p><strong>output_encoding</strong> - 当 Alembic 将 <strong>script.py.mako</strong> 文件写入新的迁移文件时使用的编码。 默认为“utf-8”。</p>
</blockquote>
</li>
<li>
<p>[loggers], [handlers], [formatters], [logger_<em>], [handler_</em>], [formatter_*] - these sections are all part of Python’s standard logging configuration, the mechanics of which are documented at <a href="http://docs.python.org/library/logging.config.html#configuration-file-format">Configuration File Format</a>. As is the case with the database connection, these directives are used directly as the result of the <strong>logging.config.fileConfig()</strong> call present in the <strong>env.py</strong> script, which you’re free to modify.</p>
</li>
<li>
<blockquote>
<p>[loggers], [handlers], [formatters], [logger_<em>], [handler_</em>], [formatter_*] - 这些部分都是 Python 标准日志配置的一部分，其机制记录在配置文件格式中。 与数据库连接的情况一样，这些指令直接作为 <strong>env.py</strong> 脚本中存在的 <strong>logging.config.fileConfig()</strong> 调用的结果使用，您可以自由修改。</p>
</blockquote>
</li>
</ul>
<p>For starting up with just a single database and the generic configuration, setting up the SQLAlchemy URL is all that’s needed:</p>
<blockquote>
<p>对于只使用单个数据库和通用配置的启动，只需要设置 SQLAlchemy URL：</p>
</blockquote>
<pre><code class="language-python">sqlalchemy.url = postgresql://scott:tiger@localhost/test
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-a-migration-script"><a class="header" href="#create-a-migration-script">Create a Migration Script</a></h1>
<p><strong>创建迁移脚本</strong></p>
<p>With the environment in place we can create a new revision, using <code>alembic revision</code>:</p>
<blockquote>
<p>环境准备好后，我们可以使用 <code>alembic revision</code> 创建一个新修订：</p>
</blockquote>
<pre><code class="language-bash">$ alembic revision -m &quot;create account table&quot;
Generating /path/to/yourproject/alembic/versions/1975ea83b712_create_accoun
t_table.py...done
</code></pre>
<p>A new file <code>1975ea83b712_create_account_table.py</code> is generated. Looking inside the file:</p>
<blockquote>
<p>生成了一个新文件<code>1975ea83b712_create_account_table.py</code>。 文件内容如下:</p>
</blockquote>
<pre><code class="language-python">&quot;&quot;&quot;create account table

Revision ID: 1975ea83b712
Revises:
Create Date: 2011-11-08 11:40:27.089406

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '1975ea83b712'
down_revision = None
branch_labels = None

from alembic import op
import sqlalchemy as sa

def upgrade():
    pass

def downgrade():
    pass
</code></pre>
<p>The file contains some header information, identifiers for the current revision and a “downgrade” revision, an import of basic Alembic directives, and empty <code>upgrade()</code> and <code>downgrade()</code> functions. Our job here is to populate the <code>upgrade()</code> and <code>downgrade()</code> functions with directives that will apply a set of changes to our database. Typically, <code>upgrade()</code> is required while <code>downgrade()</code> is only needed if down-revision capability is desired, though it’s probably a good idea.</p>
<blockquote>
<p>该文件包含一些标题信息、当前修订和“downgrade”修订的标识符、Alembic 基本的导入指令以及空的 <code>upgrade()</code> 和 <code>downgrade()</code> 函数。我们在这里的工作是使用指令填充 <code>upgrade()</code> 和 <code>downgrade()</code> 函数，这些指令将对我们的数据库应用一组更改。通常，<code>upgrade()</code> 是必需的，而 <code>downgrade()</code> 仅在向下修订功能需要时才使用，尽管这可能是一个好主意。</p>
</blockquote>
<p>Another thing to notice is the <code>down_revision</code> variable. This is how Alembic knows the correct order in which to apply migrations. When we create the next revision, the new file’s <code>down_revision</code> identifier would point to this one:</p>
<blockquote>
<p>另一件需要注意的是 <code>down_revision</code> 变量。 这就是 Alembic 知道应用迁移的正确顺序的方式。 当我们创建下一个修订版时，新文件的 <code>down_revision</code> 标识符将指向这个：</p>
</blockquote>
<pre><code class="language-python"># revision identifiers, used by Alembic.
revision = 'ae1027a6acf'
down_revision = '1975ea83b712'
</code></pre>
<p>Every time Alembic runs an operation against the <code>versions/</code> directory, it reads all the files in, and composes a list based on how the <code>down_revision</code> identifiers link together, with the <code>down_revision</code> of <code>None</code> representing the first file. In theory, if a migration environment had thousands of migrations, this could begin to add some latency to startup, but in practice a project should probably prune old migrations anyway (see the section <a href="zh//en/cookbook.html#building-uptodate">Building an Up to Date Database from Scratch</a> for a description on how to do this, while maintaining the ability to build the current database fully).</p>
<blockquote>
<p>每次 Alembic 对 <code>versions/</code> 目录运行操作时，它都会读取所有文件，并根据 <code>down_revision</code> 标识符链接在一起的方式组成一个列表，其中<code>down_revision</code> 变量为 <code>None</code> 的文件代表第一个迁移文件。 理论上，如果迁移环境有数千次迁移，这在开始迁移时增加一些延迟，但在项目实践中，无论如何都应该精简旧的迁移(有关如何执行此操作的说明，请参阅<a href="zh//en/cookbook.html#building-uptodate">从头开始构建最新数据库部分</a>，同时保持完全构建当前数据库的能力).</p>
</blockquote>
<p>We can then add some directives to our script, suppose adding a new table <code>account</code>:</p>
<blockquote>
<p>然后我们可以向我们的脚本添加一些指令，假设添加一个新表 <code>account</code>：</p>
</blockquote>
<pre><code class="language-python">def upgrade():
    op.create_table(
        'account',
        sa.Column('id', sa.Integer, primary_key=True),
        sa.Column('name', sa.String(50), nullable=False),
        sa.Column('description', sa.Unicode(200)),
    )

def downgrade():
    op.drop_table('account')
</code></pre>
<p><a href="zh//en/ops.html#alembic.operations.Operations.create_table">create_table()</a> and <a href="zh//en/ops.html#alembic.operations.Operations.drop_table">drop_table()</a> are Alembic directives. Alembic provides all the basic database migration operations via these directives, which are designed to be as simple and minimalistic as possible; there’s no reliance upon existing table metadata for most of these directives. They draw upon a global “context” that indicates how to get at a database connection (if any; migrations can dump SQL/DDL directives to files as well) in order to invoke the command. This global context is set up, like everything else, in the <code>env.py</code> script.</p>
<blockquote>
<p><a href="zh//en/ops.html#alembic.operations.Operations.create_table">create_table()</a> 和 <a href="zh//en/ops.html#alembic.operations.Operations.drop_table">drop_table()</a> 是 Alembic 指令。 Alembic 通过这些指令提供了所有基本的数据库迁移操作，这些指令设计得尽可能简单和简约； 大多数这些指令不依赖现有的表元数据。 它们利用一个全局“上下文”来指示如何获得数据库连接（如果有的话；迁移也可以将 SQL/DDL 指令转储到文件）以调用命令。 与其他所有内容一样，此全局上下文在 <code>env.py</code> 脚本中设置。</p>
</blockquote>
<p>An overview of all Alembic directives is at <a href="zh//en/ops.html#ops">Operation Reference</a>.</p>
<blockquote>
<p>所有 Alembic 指令的概述位于 <a href="zh//en/ops.html#ops">操作参考</a>。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running-our-first-migration"><a class="header" href="#running-our-first-migration">Running our First Migration</a></h1>
<p><strong>运行我们的第一次迁移</strong></p>
<p>We now want to run our migration. Assuming our database is totally clean, it’s as yet unversioned. The <code>alembic upgrade</code> command will run upgrade operations, proceeding from the current database revision, in this example <code>None</code>, to the given target revision. We can specify <code>1975ea83b712</code> as the revision we’d like to upgrade to, but it’s easier in most cases just to tell it “the most recent”, in this case <code>head</code>:</p>
<blockquote>
<p>我们现在想要运行我们的迁移。 假设我们的数据库完全干净，它还没有版本化。 <code>alembic upgrade</code> 命令将运行升级操作，从当前数据库修订版（在本例中为“<strong>None</strong>”）到给定的目标修订版。 我们可以指定 <code>1975ea83b712</code> 作为我们想要升级到的修订版，但在大多数情况下，告诉它“<strong>最新的</strong>”更容易，在这种情况下是 <code>head</code>：</p>
</blockquote>
<pre><code class="language-bash">$ alembic upgrade head
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
INFO  [alembic.context] Running upgrade None -&gt; 1975ea83b712
</code></pre>
<p>Wow that rocked! Note that the information we see on the screen is the result of the logging configuration set up in <code>alembic.ini</code> - logging the <code>alembic</code> stream to the console (standard error, specifically).</p>
<blockquote>
<p>哇，震撼！ 请注意，我们在屏幕上看到的信息是在 <code>alembic.ini</code> 中设置的日志配置的结果 - 将 <code>alembic</code> 流记录到控制台（特别是标准错误）。</p>
</blockquote>
<p>The process which occurred here included that Alembic first checked if the database had a table called <code>alembic_version</code>, and if not, created it. It looks in this table for the current version, if any, and then calculates the path from this version to the version requested, in this case <code>head</code>, which is known to be <code>1975ea83b712</code>. It then invokes the <code>upgrade()</code> method in each file to get to the target revision.</p>
<blockquote>
<p>此处发生的过程包括 Alembic 首先检查数据库是否有名为“<strong>alembic_version</strong>”的表，如果没有，则创建它。 它在此表中查找当前版本（如果有），然后计算从该版本到请求版本的路径，在本例中为 <code>head</code>，已知为 <code>1975ea83b712</code>。 然后它调用每个文件中的 <code>upgrade()</code> 方法以获取目标修订版。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id=""><a class="header" href="#"></a></h1>
<p><strong>再次运行迁移</strong></p>
<p>Let’s do another one so we have some things to play with. We again create a revision file:</p>
<blockquote>
<p>让我们再做一个，这样我们就有一些东西可以玩了。 我们再次创建一个修订文件：</p>
</blockquote>
<pre><code class="language-bash">$ alembic revision -m &quot;Add a column&quot;
Generating /path/to/yourapp/alembic/versions/ae1027a6acf_add_a_column.py...
done
</code></pre>
<p>Let’s edit this file and add a new column to the <code>account</code> table:</p>
<blockquote>
<p>让我们编辑这个文件并向 <code>account</code> 表中添加一个新列：</p>
</blockquote>
<pre><code class="language-python">&quot;&quot;&quot;Add a column

Revision ID: ae1027a6acf
Revises: 1975ea83b712
Create Date: 2011-11-08 12:37:36.714947

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = 'ae1027a6acf'
down_revision = '1975ea83b712'

from alembic import op
import sqlalchemy as sa

def upgrade():
    op.add_column('account', sa.Column('last_transaction_date', sa.DateTime))

def downgrade():
    op.drop_column('account', 'last_transaction_date')
</code></pre>
<p>Running again to <code>head</code>:</p>
<blockquote>
<p>再次运行到<code>head</code>：</p>
</blockquote>
<pre><code class="language-bash">$ alembic upgrade head
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
INFO  [alembic.context] Running upgrade 1975ea83b712 -&gt; ae1027a6acf
</code></pre>
<p>We’ve now added the <code>last_transaction_date</code> column to the database.</p>
<blockquote>
<p>我们现在已将 <code>last_transaction_date</code> 列添加到数据库中。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="partial-revision-identifiers"><a class="header" href="#partial-revision-identifiers">Partial Revision Identifiers</a></h1>
<p><strong>部分修订标识符</strong></p>
<p>Any time we need to refer to a revision number explicitly, we have the option to use a partial number. As long as this number uniquely identifies the version, it may be used in any command in any place that version numbers are accepted:</p>
<blockquote>
<p>任何时候我们需要明确引用修订号，我们都可以选择使用部分编号。 只要这个数字唯一标识版本，它就可以在任何接受版本号的地方用在任何命令中：</p>
</blockquote>
<pre><code class="language-bash">alembic upgrade ae1
</code></pre>
<p>Above, we use <code>ae1</code> to refer to revision <code>ae1027a6acf</code>. Alembic will stop and let you know if more than one version starts with that prefix.</p>
<blockquote>
<p>上面，我们使用 <code>ae1</code> 来指代修订版 <code>ae1027a6acf</code>。 如果有多个版本以该前缀开头，Alembic 将停止并通知您。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relative-migration-identifiers"><a class="header" href="#relative-migration-identifiers">Relative Migration Identifiers</a></h1>
<p><strong>相对迁移标识符</strong></p>
<p>Relative upgrades/downgrades are also supported. To move two versions from the current, a decimal value “+N” can be supplied:</p>
<blockquote>
<p>还支持相对升级/降级。 要从当前移动两个版本，可以提供十进制值“+N”：</p>
</blockquote>
<pre><code class="language-bash">alembic upgrade +2
</code></pre>
<p>Negative values are accepted for downgrades:</p>
<blockquote>
<p>降级接受负值：</p>
</blockquote>
<pre><code class="language-bash">alembic downgrade -1
</code></pre>
<p>Relative identifiers may also be in terms of a specific revision. For example, to upgrade to revision <code>ae1027a6acf</code> plus two additional steps:</p>
<blockquote>
<p>相对标识符也可以是特定版本。 例如，要升级到修订版 <code>ae1027a6acf</code> 加上两个额外的步骤：</p>
</blockquote>
<pre><code class="language-bash">alembic upgrade ae10+2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-information"><a class="header" href="#getting-information">Getting Information</a></h1>
<p><strong>获取信息</strong></p>
<p>With a few revisions present we can get some information about the state of things.</p>
<blockquote>
<p>通过一些修改，我们可以获得一些关于迁移版本状态的信息。</p>
</blockquote>
<p>First we can view the current revision:</p>
<blockquote>
<p>首先我们可以查看当前版本：</p>
</blockquote>
<pre><code class="language-bash">$ alembic current
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
Current revision for postgresql://scott:XXXXX@localhost/test: 1975ea83b712 -&gt; ae1027a6acf (head), Add a column
</code></pre>
<p><code>head</code> is displayed only if the revision identifier for this database matches the head revision.</p>
<blockquote>
<p>仅当此数据库的修订标识符与头部修订匹配时才显示 <code>head</code>。</p>
</blockquote>
<p>We can also view history with <code>alembic history</code>; the <code>--verbose</code> option (accepted by several commands, including <code>history</code>, <code>current</code>, <code>heads</code> and <code>branches</code>) will show us full information about each revision:</p>
<blockquote>
<p>我们也可以用<code>alembic history</code>命令查看历史； <code>--verbose</code> 选项（多个命令都接受改选项，包括 <code>history</code>、<code>current</code>、<code>heads</code> 和 <code>branches</code>）将向我们显示每个版本的完整信息：</p>
</blockquote>
<pre><code class="language-bash">$ alembic history --verbose

Rev: ae1027a6acf (head)
Parent: 1975ea83b712
Path: /path/to/yourproject/alembic/versions/ae1027a6acf_add_a_column.py

    add a column

    Revision ID: ae1027a6acf
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:02:54.849677

Rev: 1975ea83b712
Parent: &lt;base&gt;
Path: /path/to/yourproject/alembic/versions/1975ea83b712_add_account_table.py

    create account table

    Revision ID: 1975ea83b712
    Revises:
    Create Date: 2014-11-20 13:02:46.257104
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="viewing-history-ranges"><a class="header" href="#viewing-history-ranges">Viewing History Ranges</a></h1>
<p><strong>查看历史范围</strong></p>
<p>Using the <code>-r</code> option to <code>alembic history</code>, we can also view various slices of history. The <code>-r</code> argument accepts an argument <code>[start]:[end]</code>, where either may be a revision number, symbols like <code>head</code>, <code>heads</code> or <code>base</code>, <code>current</code> to specify the current revision(s), as well as negative relative ranges for <code>[start]</code> and positive relative ranges for <code>[end]</code>:</p>
<blockquote>
<p>使用 <code>alembic history</code> 的 <code>-r</code> 选项，我们还可以查看历史片段。 <code>-r</code> 参数接受一个参数 <code>[start]:[end]</code>，其中可以是一个修订号，像 <code>head</code>、<code>heads</code> 或 <code>base</code>、<code>current</code> 这样的符号来指定当前的修订版本，以及<code>[start]</code> 的负相对范围和<code>[end]</code> 的正相对范围：</p>
</blockquote>
<pre><code class="language-bash">alembic history -r1975ea:ae1027
</code></pre>
<p>A relative range starting from three revisions ago up to current migration, which will invoke the migration environment against the database to get the current migration:</p>
<blockquote>
<p>从前三个修订版本到当前迁移版本的相对范围，它将针对数据库调用迁移环境以获取当前迁移：</p>
</blockquote>
<pre><code class="language-bash">alembic history -r-3:current
</code></pre>
<p>View all revisions from <code>1975</code> to the <code>head</code>:</p>
<blockquote>
<p>查看从<code>1975</code>到<code>head</code>的所有修订：</p>
</blockquote>
<pre><code class="language-bash">alembic history -r1975ea:
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="downgrading"><a class="header" href="#downgrading">Downgrading</a></h1>
<p><strong>降级</strong></p>
<p>We can illustrate a downgrade back to nothing, by calling <code>alembic downgrade</code> back to the beginning, which in Alembic is called <code>base</code>:</p>
<blockquote>
<p>我们可以通过调用 <code>alembic downgrade</code> 回到最初始状态, 来演示降级到迁移最初始状态，在 Alembic 中称为 <code>base</code>：</p>
</blockquote>
<pre><code class="language-bash">$ alembic downgrade base
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
INFO  [alembic.context] Running downgrade ae1027a6acf -&gt; 1975ea83b712
INFO  [alembic.context] Running downgrade 1975ea83b712 -&gt; None
</code></pre>
<p>Back to nothing - and up again:</p>
<blockquote>
<p>降级到最初始状态 - 然后再次升级:</p>
</blockquote>
<pre><code class="language-bash">$ alembic upgrade head
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
INFO  [alembic.context] Running upgrade None -&gt; 1975ea83b712
INFO  [alembic.context] Running upgrade 1975ea83b712 -&gt; ae1027a6acf
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h1>
<p><strong>下一步</strong></p>
<p>The vast majority of Alembic environments make heavy use of the “autogenerate” feature. Continue onto the next section, <a href="zh//zh/01_auto_generating_migrations.html">Auto Generating Migrations</a>.</p>
<blockquote>
<p>绝大多数 Alembic 环境大量使用“自动生成”功能。 继续下一部分，<a href="zh//zh/01_auto_generating_migrations.html">自动生成迁移</a>。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="auto-generating-migrations"><a class="header" href="#auto-generating-migrations">Auto Generating Migrations</a></h1>
<p><strong>自动生成迁移</strong></p>
<p>Alembic can view the status of the database and compare against the table metadata in the application, generating the “obvious” migrations based on a comparison. This is achieved using the <code>--autogenerate</code> option to the <code>alembic revision</code> command, which places so-called candidate migrations into our new migrations file. We review and modify these by hand as needed, then proceed normally.</p>
<blockquote>
<p>Alembic 可以查看数据库的状态并与应用程序中的表元数据进行比较，根据比较生成“显而易见”的迁移。 这是通过使用 <code>alembic revision</code> 命令的 <code>--autogenerate</code> 选项来实现的，它将所有的待迁移放入我们的新迁移文件中。 我们根据需要手动审查和修改这些，然后正常进行。</p>
</blockquote>
<p>To use autogenerate, we first need to modify our <code>env.py</code> so that it gets access to a table metadata object that contains the target. Suppose our application has a <a href="https://docs.sqlalchemy.org/en/14/orm/extensions/declarative/index.html#declarative-toplevel">declarative base</a> in <code>myapp.mymodel</code>. This base contains a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> object which contains <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> objects defining our database. We make sure this is loaded in <code>env.py</code> and then passed to <a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a> via the <code>target_metadata</code> argument. The <code>env.py</code> sample script used in the generic template already has a variable declaration near the top for our convenience, where we replace <code>None</code> with our <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong>. Starting with:</p>
<blockquote>
<p>要使用自动生成，我们首先需要修改我们的 <code>env.py</code> 以便它可以访问包含目标的表元数据对象。 假设我们的应用程序在 <code>myapp.mymodel</code> 中有一个 <a href="https://docs.sqlalchemy.org/en/14/orm/extensions/declarative/index.html#declarative-toplevel">declarative base</a>。 该 <strong>base</strong> 包含一个 <strong>MetaData</strong> 对象，该对象包含我们定义的数据库的 <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> 对象。 我们确保它被加载到 <code>env.py</code> 中，然后通过 <code>target_metadata</code> 参数传递给 <a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a>。 为方便起见，通用模板中使用的 <code>env.py</code> 示例脚本在靠近顶部的地方已经有一个变量声明，我们用 <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> 替换了 <code>None</code>。 比如：</p>
</blockquote>
<pre><code class="language-python"># add your model's MetaData object here
# for 'autogenerate' support
# from myapp import mymodel
# target_metadata = mymodel.Base.metadata
target_metadata = None
</code></pre>
<p>we change to:</p>
<blockquote>
<p>我们改变成:</p>
</blockquote>
<pre><code class="language-python">from myapp.mymodel import Base
target_metadata = Base.metadata
</code></pre>
<ul>
<li>
<p><strong>Note</strong>: The above example refers to the <code>generic alembic env.py template</code>, e.g. the one created by default when calling upon <code>alembic init</code>, and not the special-use templates such as <code>multidb</code>. Please consult the source code and comments within the <code>env.py</code> script directly for specific guidance on where and how the autogenerate metadata is established.</p>
</li>
<li>
<blockquote>
<p><strong>注意</strong>: 上面的例子指的是“通用的 alembic env.py 模板”，例如 调用<code>alembic init</code>时默认创建的那个，而不是像<code>multidb</code>这样的特殊模板。 请直接查阅“env.py”脚本中的源代码和注释，以获取有关在何处以及如何建立自动生成元数据的具体指导。</p>
</blockquote>
</li>
</ul>
<p>If we look later in the script, down in <code>run_migrations_online()</code>, we can see the directive passed to <strong><a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a></strong>:</p>
<blockquote>
<p>如果我们稍后查看脚本，在 <code>run_migrations_online()</code> 中，我们可以看到传递给 <strong><a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a></strong> 的指令：</p>
</blockquote>
<pre><code class="language-python">def run_migrations_online():
    engine = engine_from_config(
                config.get_section(config.config_ini_section), prefix='sqlalchemy.')

    with engine.connect() as connection:
        context.configure(
                    connection=connection,
                    target_metadata=target_metadata
                    )

        with context.begin_transaction():
            context.run_migrations()
</code></pre>
<p>We can then use the <code>alembic revision</code> command in conjunction with the <code>--autogenerate</code> option. Suppose our <a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a> contained a definition for the <code>account</code> table, and the database did not. We’d get output like:</p>
<blockquote>
<p>然后我们可以将<code>alembic revision</code> 命令与<code>--autogenerate</code> 选项结合使用。 假设我们的 <a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a> 包含对 <code>account</code> 表的定义，而数据库没有。 我们会得到如下输出：</p>
</blockquote>
<pre><code class="language-bash">$ alembic revision --autogenerate -m &quot;Added account table&quot;
INFO [alembic.context] Detected added table 'account'
Generating /path/to/foo/alembic/versions/27c6a30d7c24.py...done
</code></pre>
<p>We can then view our file <code>27c6a30d7c24.py</code> and see that a rudimentary migration is already present:</p>
<blockquote>
<p>然后我们可以查看我们的 <code>27c6a30d7c24.py</code> 文件, 并看到一个基本的迁移已经存在：</p>
</blockquote>
<pre><code class="language-python">&quot;&quot;&quot;empty message

Revision ID: 27c6a30d7c24
Revises: None
Create Date: 2011-11-08 11:40:27.089406

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '27c6a30d7c24'
down_revision = None

from alembic import op
import sqlalchemy as sa

def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
    'account',
    sa.Column('id', sa.Integer()),
    sa.Column('name', sa.String(length=50), nullable=False),
    sa.Column('description', sa.VARCHAR(200)),
    sa.Column('last_transaction_date', sa.DateTime()),
    sa.PrimaryKeyConstraint('id')
    )
    ### end Alembic commands ###

def downgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.drop_table(&quot;account&quot;)
    ### end Alembic commands ###
</code></pre>
<p>The migration hasn’t actually run yet, of course. We do that via the usual <code>upgrade</code> command. We should also go into our migration file and alter it as needed, including adjustments to the directives as well as the addition of other directives which these may be dependent on - specifically data changes in between creates/alters/drops.</p>
<blockquote>
<p>当然，迁移还没有真正运行。 我们通过常用的<code>upgrade</code>命令来做到这一点。 我们还应该进入我们的迁移文件并根据需要更改它，包括对指令的调整以及添加这些可能依赖的其他指令 - 特别是在创建/更改/删除之间的数据更改。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-does-autogenerate-detect"><a class="header" href="#what-does-autogenerate-detect">What does Autogenerate Detect</a></h1>
<p>The vast majority of user issues with Alembic centers on the topic of what kinds of changes autogenerate can and cannot detect reliably, as well as how it renders Python code for what it does detect. It is critical to note that <strong>autogenerate is not intended to be perfect</strong>. It is <em>always</em> necessary to manually review and correct the <strong>candidate migrations</strong> that autogenerate produces. The feature is getting more and more comprehensive and error-free as releases continue, but one should take note of the current limitations.</p>
<p>Autogenerate <strong>will detect</strong>:</p>
<ul>
<li>Table additions, removals.</li>
<li>Column additions, removals.</li>
<li>Change of nullable status on columns.</li>
<li>Basic changes in indexes and explicitly-named unique constraints</li>
<li>Basic changes in foreign key constraints</li>
</ul>
<p>Autogenerate can <strong>optionally detect</strong>:</p>
<ul>
<li>
<p>Change of column type. This will occur if you set the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> parameter to <code>True</code>. The default implementation will reliably detect major changes, such as between <strong>Numeric</strong> and <strong>String</strong>, as well as accommodate for the types generated by SQLAlchemy’s “generic” types such as <strong>Boolean</strong>. Arguments that are shared between both types, such as length and precision values, will also be compared. If either the metadata type or database type has <strong>additional</strong> arguments beyond that of the other type, these are <strong>not</strong> compared, such as if one numeric type featured a “scale” and other type did not, this would be seen as the backing database not supporting the value, or reporting on a default that the metadata did not specify.</p>
<p>The type comparison logic is fully extensible as well; see <a href="zh/../en/autogenerate.html#compare-types">Comparing Types</a> for details.</p>
<blockquote>
<p>Changed in version 1.4: type comparison code has been reworked such that column types are compared based on their rendered DDL, which should allow the functionality enabled by <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> to be much more accurate, correctly accounting for the behavior of SQLAlchemy “generic” types as well as major arguments specified within types.</p>
</blockquote>
</li>
<li>
<p>Change of server default. This will occur if you set the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_server_default">EnvironmentContext.configure.compare_server_default</a></strong> parameter to True, or to a custom callable function. This feature works well for simple cases but cannot always produce accurate results. The Postgresql backend will actually invoke the “detected” and “metadata” values against the database to determine equivalence. The feature is off by default so that it can be tested on the target schema first. Like type comparison, it can also be customized by passing a callable; see the function’s documentation for details.</p>
</li>
</ul>
<p>Autogenerate can <strong>not detect</strong>:</p>
<ul>
<li>Changes of table name. These will come out as an add/drop of two different tables, and should be hand-edited into a name change instead.</li>
<li>Changes of column name. Like table name changes, these are detected as a column add/drop pair, which is not at all the same as a name change.</li>
<li>Anonymously named constraints. Give your constraints a name, e.g. <strong>UniqueConstraint('col1', 'col2', name=&quot;my_name&quot;)</strong>. See the section <a href="zh/../en/naming.html">The Importance of Naming Constraints</a> for background on how to configure automatic naming schemes for constraints.</li>
<li>Special SQLAlchemy types such as <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> when generated on a backend which doesn’t support ENUM directly - this because the representation of such a type in the non-supporting database, i.e. a CHAR+ CHECK constraint, could be any kind of CHAR+CHECK. For SQLAlchemy to determine that this is actually an ENUM would only be a guess, something that’s generally a bad idea. To implement your own “guessing” function here, use the <strong><a href="https://docs.sqlalchemy.org/en/14/core/events.html#sqlalchemy.events.DDLEvents.column_reflect">sqlalchemy.events.DDLEvents.column_reflect()</a></strong> event to detect when a CHAR (or whatever the target type is) is reflected, and change it to an ENUM (or whatever type is desired) if it is known that that’s the intent of the type. The <strong><a href="https://docs.sqlalchemy.org/en/14/core/events.html#sqlalchemy.events.DDLEvents.after_parent_attach">sqlalchemy.events.DDLEvents.after_parent_attach()</a></strong> can be used within the autogenerate process to intercept and un-attach unwanted CHECK constraints.</li>
</ul>
<p>Autogenerate can’t currently, but <strong>will eventually detect</strong>:</p>
<ul>
<li>
<p>Some free-standing constraint additions and removals may not be supported, including PRIMARY KEY, EXCLUDE, CHECK; these are not necessarily implemented within the autogenerate detection system and also may not be supported by the supporting SQLAlchemy dialect.</p>
</li>
<li>
<p>Sequence additions, removals - not yet implemented.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="autogenerating-multiple-metadata-collections"><a class="header" href="#autogenerating-multiple-metadata-collections">Autogenerating Multiple MetaData collections</a></h1>
<p>The <code>target_metadata</code> collection may also be defined as a sequence if an application has multiple <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> collections involved:</p>
<pre><code class="language-python">from myapp.mymodel1 import Model1Base
from myapp.mymodel2 import Model2Base
target_metadata = [Model1Base.metadata, Model2Base.metadata]
</code></pre>
<p>The sequence of <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> collections will be consulted in order during the autogenerate process. Note that each <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> must contain <strong>unique</strong> table keys (e.g. the “key” is the combination of the table’s name and schema); if two <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> objects contain a table with the same schema/name combination, an error is raised.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="controlling-what-to-be-autogenerated"><a class="header" href="#controlling-what-to-be-autogenerated">Controlling What to be Autogenerated</a></h1>
<p>The autogenerate process scans across all table objects within the database that is referred towards by the current database connection in use.</p>
<p>The list of objects that are scanned in the target database connection include:</p>
<ul>
<li>The “default” schema currently referred towards by the database connection.</li>
<li>If the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_schemas">EnvironmentContext.configure.include_schemas</a></strong> is set to <code>True</code>, all non-default “schemas”, which are those names returned by the <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_schema_names">get_schema_names()</a></strong> method of <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector">Inspector</a></strong>. The SQLAlchemy document <a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#schema-table-schema-name">Specifying the Schema Name</a> discusses the concept of a “schema” in detail.</li>
<li>Within each “schema”, all tables present are scanned using the <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_table_names">get_table_names()</a></strong> method of <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector">Inspector</a></strong>.</li>
<li>Within each “table”, most sub-objects of the each <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> construct are scanned, including columns and some forms of constraints. This process ultimately involves the use of methods on <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector">Inspector</a></strong> including <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_columns">get_columns()</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_indexes">get_indexes()</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_unique_constraints">get_unique_constraints()</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_foreign_keys">get_foreign_keys()</a></strong> (as of this writing, CHECK constraints and primary key constraints are not yet included).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="omitting-schema-names-from-the-autogenerate-process"><a class="header" href="#omitting-schema-names-from-the-autogenerate-process">Omitting Schema Names from the Autogenerate Process</a></h1>
<p>As the above set of database objects are typically to be compared to the contents of a single <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> object, particularly when the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_schemas">EnvironmentContext.configure.include_schemas</a></strong> flag is enabled there is an important need to filter out unwanted “schemas”, which for some database backends might be the list of all the databases present. This filtering is best performed using the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook, which provides for a callable that may return a boolean true/false indicating if a particular schema name should be included:</p>
<pre><code class="language-python">def include_name(name, type_, parent_names):
    if type_ == &quot;schema&quot;:
        # note this will not include the default schema
        return name in [&quot;schema_one&quot;, &quot;schema_two&quot;]
    else:
        return True

context.configure(
    # ...
    include_schemas = True,
    include_name = include_name
)
</code></pre>
<p>Above, when the list of schema names is first retrieved, the names will be filtered through the above <code>include_name</code> function so that only schemas named <code>&quot;schema_one&quot;</code> and <code>&quot;schema_two&quot;</code> will be considered by the autogenerate process.</p>
<p>In order to include <strong>the default schema</strong>, that is, the schema that is referred towards by the database connection <strong>without</strong> any explicit schema being specified, the name passed to the hook is <code>None</code>. To alter our above example to also include the default schema, we compare to <code>None</code> as well:</p>
<pre><code class="language-python">def include_name(name, type_, parent_names):
    if type_ == &quot;schema&quot;:
        # this **will* include the default schema
        return name in [None, &quot;schema_one&quot;, &quot;schema_two&quot;]
    else:
        return True

context.configure(
    # ...
    include_schemas = True,
    include_name = include_name
)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="omitting-table-names-from-the-autogenerate-process"><a class="header" href="#omitting-table-names-from-the-autogenerate-process">Omitting Table Names from the Autogenerate Process</a></h1>
<p>The <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook is also most appropriate to limit the names of tables in the target database to be considered. If a target database has many tables that are not part of the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong>, the autogenerate process will normally assume these are extraneous tables in the database to be dropped, and it will generate a <strong><a href="http://localhost:3002/en/ops.html#alembic.operations.Operations.drop_table">Operations.drop_table()</a></strong> operation for each. To prevent this, the <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook may be used to search for each name within the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData.tables">tables</a></strong> collection of the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> object and ensure names which aren’t present are not included:</p>
<pre><code class="language-python">target_metadata = MyModel.metadata

def include_name(name, type_, parent_names):
    if type_ == &quot;table&quot;:
        return name in target_metadata.tables
    else:
        return True

context.configure(
    # ...
    target_metadata = target_metadata,
    include_name = include_name,
    include_schemas = False
)
</code></pre>
<p>The above example is limited to table names present in the default schema only. In order to search within a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> collection for schema-qualified table names as well, a table present in the non default schema will be present under a name of the form <code>&lt;schemaname&gt;.&lt;tablename&gt;</code>. The <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook will present this schema name on a per-tablename basis in the <code>parent_names</code> dictionary, using the key <code>&quot;schema_name&quot;</code> that refers to the name of the schema currently being considered, or <code>None</code> if the schema is the default schema of the database connection:</p>
<pre><code class="language-python"># example fragment

if parent_names[&quot;schema_name&quot;] is None:
    return name in target_metadata.tables
else:
    # build out schema-qualified name explicitly...
    return (
        &quot;%s.%s&quot; % (parent_names[&quot;schema_name&quot;], name) in
        target_metadata.tables
    )
</code></pre>
<p>However more simply, the <code>parent_names</code> dictionary will also include the dot-concatenated name already constructed under the key <code>&quot;schema_qualified_table_name&quot;</code>, which will also be suitably formatted for tables in the default schema as well with the dot omitted. So the full example of omitting tables with schema support may look like:</p>
<pre><code class="language-python">target_metadata = MyModel.metadata

def include_name(name, type_, parent_names):
    if type_ == &quot;schema&quot;:
        return name in [None, &quot;schema_one&quot;, &quot;schema_two&quot;]
    elif type_ == &quot;table&quot;:
        # use schema_qualified_table_name directly
        return (
            parent_names[&quot;schema_qualified_table_name&quot;] in
            target_metadata.tables
        )
    else:
        return True

context.configure(
    # ...
    target_metadata = target_metadata,
    include_name = include_name,
    include_schemas = True
)
</code></pre>
<p>The <code>parent_names</code> dictionary will also include the key <code>&quot;table_name&quot;</code> when the name being considered is that of a column or constraint object local to a particular table.</p>
<p>The <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook only refers to <strong>reflected</strong> objects, and not those located within the target <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> collection. For more fine-grained rules that include both <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> and reflected object, the <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_object">EnvironmentContext.configure.include_object</a></strong> hook discussed in the next section is more appropriate.</p>
<blockquote>
<p>New in version 1.5: added the <strong><a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">EnvironmentContext.configure.include_name</a></strong> hook.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="omitting-based-on-object"><a class="header" href="#omitting-based-on-object">Omitting Based on Object</a></h1>
<p>The <a href="http://localhost:3002/en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_object">EnvironmentContext.configure.include_object</a> hook provides for object-level inclusion/exclusion rules based on the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object being reflected as well as the elements within it. This hook can be used to limit objects both from the local <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> collection as well as from the target database. The limitation is that when it reports on objects in the database, it will have fully reflected that object, which can be expensive if a large number of objects will be omitted. The example below refers to a fine-grained rule that will skip changes on <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> objects that have a user-defined flag <code>skip_autogenerate</code> placed into the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column.info">info</a></strong> dictionary:</p>
<pre><code class="language-python">def include_object(object, name, type_, reflected, compare_to):
    if (type_ == &quot;column&quot; and
        not reflected and
        object.info.get(&quot;skip_autogenerate&quot;, False)):
        return False
    else:
        return True

context.configure(
    # ...
    include_object = include_object
)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comparing-and-rendering-types"><a class="header" href="#comparing-and-rendering-types">Comparing and Rendering Types</a></h1>
<p>The area of autogenerate’s behavior of comparing and rendering Python-based type objects in migration scripts presents a challenge, in that there’s a very wide variety of types to be rendered in scripts, including those part of SQLAlchemy as well as user-defined types. A few options are given to help out with this task.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="controlling-the-module-prefix"><a class="header" href="#controlling-the-module-prefix">Controlling the Module Prefix</a></h1>
<p>When types are rendered, they are generated with a <strong>module prefix</strong>, so that they are available based on a relatively small number of imports. The rules for what the prefix is is based on the kind of datatype as well as configurational settings. For example, when Alembic renders SQLAlchemy types, it will by default prefix the type name with the prefix <code>sa.</code>:</p>
<pre><code class="language-python">Column(&quot;my_column&quot;, sa.Integer())
</code></pre>
<p>The use of the sa. prefix is controllable by altering the value of <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.sqlalchemy_module_prefix">EnvironmentContext.configure.sqlalchemy_module_prefix</a></strong>:</p>
<pre><code class="language-python">def run_migrations_online():
    # ...

    context.configure(
                connection=connection,
                target_metadata=target_metadata,
                sqlalchemy_module_prefix=&quot;sqla.&quot;,
                # ...
                )

    # ...
</code></pre>
<p>In either case, the <code>sa.</code> prefix, or whatever prefix is desired, should also be included in the imports section of <code>script.py.mako</code>; it also defaults to <code>import sqlalchemy as sa.</code></p>
<p>For user-defined types, that is, any custom type that is not within the <code>sqlalchemy.</code> module namespace, by default Alembic will use the <strong>value of __module__ for the custom type</strong>:</p>
<pre><code class="language-python">Column(&quot;my_column&quot;, myapp.models.utils.types.MyCustomType())
</code></pre>
<p>The imports for the above type again must be made present within the migration, either manually, or by adding it to <code>script.py.mako</code>.</p>
<p>The above custom type has a long and cumbersome name based on the use of <code>__module__</code> directly, which also implies that lots of imports would be needed in order to accommodate lots of types. For this reason, it is recommended that user-defined types used in migration scripts be made available from a single module. Suppose we call it <code>myapp.migration_types</code>:</p>
<pre><code class="language-python"># myapp/migration_types.py

from myapp.models.utils.types import MyCustomType
</code></pre>
<p>We can first add an import for <code>migration_types</code> to our <code>script.py.mako</code>:</p>
<pre><code class="language-python">from alembic import op
import sqlalchemy as sa
import myapp.migration_types
${imports if imports else &quot;&quot;}
</code></pre>
<p>We then override Alembic’s use of <code>__module__</code> by providing a fixed prefix, using the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.user_module_prefix">EnvironmentContext.configure.user_module_prefix</a></strong> option:</p>
<pre><code class="language-python">def run_migrations_online():
    # ...

    context.configure(
                connection=connection,
                target_metadata=target_metadata,
                user_module_prefix=&quot;myapp.migration_types.&quot;,
                # ...
                )

    # ...
</code></pre>
<p>Above, we now would get a migration like:</p>
<pre><code class="language-python">Column(&quot;my_column&quot;, myapp.migration_types.MyCustomType())
</code></pre>
<p>Now, when we inevitably refactor our application to move <code>MyCustomType</code> somewhere else, we only need modify the <code>myapp.migration_types</code> module, instead of searching and replacing all instances within our migration scripts.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="affecting-the-rendering-of-types-themselves"><a class="header" href="#affecting-the-rendering-of-types-themselves">Affecting the Rendering of Types Themselves</a></h1>
<p>The methodology Alembic uses to generate SQLAlchemy and user-defined type constructs as Python code is plain old <code>__repr__()</code>. SQLAlchemy’s built-in types for the most part have a <code>__repr__()</code> that faithfully renders a Python-compatible constructor call, but there are some exceptions, particularly in those cases when a constructor accepts arguments that aren’t compatible with <code>__repr__()</code>, such as a pickling function.</p>
<p>When building a custom type that will be rendered into a migration script, it is often necessary to explicitly give the type a <code>__repr__()</code> that will faithfully reproduce the constructor for that type. This, in combination with <strong><a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.user_module_prefix">EnvironmentContext.configure.user_module_prefix</a></strong>, is usually enough. However, if additional behaviors are needed, a more comprehensive hook is the <strong><a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.render_item">EnvironmentContext.configure.render_item</a></strong> option. This hook allows one to provide a callable function within <code>env.py</code> that will fully take over how a type is rendered, including its module prefix:</p>
<pre><code class="language-python">def render_item(type_, obj, autogen_context):
    &quot;&quot;&quot;Apply custom rendering for selected items.&quot;&quot;&quot;

    if type_ == 'type' and isinstance(obj, MySpecialType):
        return &quot;mypackage.%r&quot; % obj

    # default rendering for other objects
    return False

def run_migrations_online():
    # ...

    context.configure(
                connection=connection,
                target_metadata=target_metadata,
                render_item=render_item,
                # ...
                )

    # ...
</code></pre>
<p>In the above example, we’d ensure our <code>MySpecialType</code> includes an appropriate <code>__repr__()</code> method, which is invoked when we call it against <code>&quot;%r&quot;</code>.</p>
<p>The callable we use for <strong><a href="zh//en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.render_item">EnvironmentContext.configure.render_item</a></strong> can also add imports to our migration script. The <strong><a href="zh/../en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext">AutogenContext</a></strong> passed in contains a datamember called <strong><a href="zh/../en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.imports">AutogenContext.imports</a></strong>, which is a Python <code>set()</code> for which we can add new imports. For example, if <code>MySpecialType</code> were in a module called <code>mymodel.types</code>, we can add the import for it as we encounter the type:</p>
<pre><code class="language-python">def render_item(type_, obj, autogen_context):
    &quot;&quot;&quot;Apply custom rendering for selected items.&quot;&quot;&quot;

    if type_ == 'type' and isinstance(obj, MySpecialType):
        # add import for this type
        autogen_context.imports.add(&quot;from mymodel import types&quot;)
        return &quot;types.%r&quot; % obj

    # default rendering for other objects
    return False
</code></pre>
<p>The finished migration script will include our imports where the <code>${imports}</code> expression is used, producing output such as:</p>
<pre><code class="language-python">from alembic import op
import sqlalchemy as sa
from mymodel import types

def upgrade():
    op.add_column('sometable', Column('mycolumn', types.MySpecialType()))
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comparing-types"><a class="header" href="#comparing-types">Comparing Types</a></h1>
<p>The default type comparison logic will work for SQLAlchemy built in types as well as basic user defined types. This logic is only enabled if the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> parameter is set to <code>True</code>:</p>
<pre><code class="language-python">context.configure(
    # ...
    compare_type = True
)
</code></pre>
<blockquote>
<p><strong>Note</strong>: The default type comparison logic (which is end-user extensible) currently (as of Alembic version 1.4.0) works by comparing the generated SQL for a column. It does this in two steps-</p>
<ul>
<li>First, it compares the outer type of each column such as VARCHAR or TEXT. Dialect implementations can have synonyms that are considered equivalent- this is because some databases support types by converting them to another type. For example, NUMERIC and DECIMAL are considered equivalent on all backends, while on the Oracle backend the additional synonyms BIGINT, INTEGER, NUMBER, SMALLINT are added to this list of equivalents</li>
<li>Next, the arguments within the type, such as the lengths of strings, precision values for numerics, the elements inside of an enumeration are compared. If BOTH columns have arguments AND they are different, a change will be detected. If one column is just set to the default and the other has arguments, Alembic will pass on attempting to compare these. The rationale is that it is difficult to detect what a database backend sets as a default value without generating false positives.</li>
</ul>
</blockquote>
<blockquote>
<p><em>Changed in version 1.4.0</em>: Added the text and keyword comparison for column types</p>
</blockquote>
<p>Alternatively, the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> parameter accepts a callable function which may be used to implement custom type comparison logic, for cases such as where special user defined types are being used:</p>
<pre><code class="language-python">def my_compare_type(context, inspected_column,
            metadata_column, inspected_type, metadata_type):
    # return False if the metadata_type is the same as the inspected_type
    # or None to allow the default implementation to compare these
    # types. a return value of True means the two types do not
    # match and should result in a type change operation.
    return None

context.configure(
    # ...
    compare_type = my_compare_type
)
</code></pre>
<p>Above, <code>inspected_column</code> is a <strong>[sqlalchemy.schema.Column]</strong> as returned by <strong><a href="https://docs.sqlalchemy.org/en/14/core/reflection.html#sqlalchemy.engine.reflection.Inspector.reflect_table">sqlalchemy.engine.reflection.Inspector.reflect_table()</a></strong>, whereas metadata_column is a <strong>[sqlalchemy.schema.Column]</strong> from the local model environment. A return value of <code>None</code> indicates that default type comparison to proceed.</p>
<p>Additionally, custom types that are part of imported or third party packages which have special behaviors such as per-dialect behavior should implement a method called <code>compare_against_backend()</code> on their SQLAlchemy type. If this method is present, it will be called where it can also return True or False to specify the types compare as equivalent or not; if it returns None, default type comparison logic will proceed:</p>
<pre><code class="language-python">class MySpecialType(TypeDecorator):

    # ...

    def compare_against_backend(self, dialect, conn_type):
        # return True if this type is the same as the given database type,
        # or None to allow the default implementation to compare these
        # types. a return value of False means the given type does not
        # match this type.

        if dialect.name == 'postgresql':
            return isinstance(conn_type, postgresql.UUID)
        else:
            return isinstance(conn_type, String)
</code></pre>
<blockquote>
<p><strong>Warning</strong>: The boolean return values for the above <code>compare_against_backend</code> method, which is part of SQLAlchemy and not Alembic,are <strong>the opposite</strong> of that of the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> callable, returning <code>True</code> for types that are the same vs. <code>False</code> for types that are different.The <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> callable on the other hand should return <code>True</code> for types that are <strong>different</strong>.</p>
</blockquote>
<p>The order of precedence regarding the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> callable vs. the type itself implementing <code>compare_against_backend</code> is that the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">EnvironmentContext.configure.compare_type</a></strong> callable is favored first; if it returns <code>None</code>, then the <code>compare_against_backend</code> method will be used, if present on the metadata type. If that returns <code>None</code>, then a basic check for type equivalence is run.</p>
<blockquote>
<p><em>New in version 1.4.0</em>: - added column keyword comparisons and the type_synonyms property.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="applying-post-processing-and-python-code-formatters-to-generated-revisions"><a class="header" href="#applying-post-processing-and-python-code-formatters-to-generated-revisions">Applying Post Processing and Python Code Formatters to Generated Revisions</a></h1>
<p>Revision scripts generated by the <code>alembic revision</code> command can optionally be piped through a series of post-production functions which may analyze or rewrite Python source code generated by Alembic, within the scope of running the <code>revision</code> command. The primary intended use of this feature is to run code-formatting tools such as <a href="https://black.readthedocs.io/">Black</a> or <a href="https://pypi.org/project/autopep8/">autopep8</a>, as well as custom-written formatting and linter functions, on revision files as Alembic generates them. Any number of hooks can be configured and they will be run in series, given the path to the newly generated file as well as configuration options.</p>
<p>The post write hooks, when configured, run against generated revision files regardless of whether or not the autogenerate feature was used.</p>
<blockquote>
<p>New in version 1.2.</p>
</blockquote>
<blockquote>
<p><strong>Note</strong>: Alembic’s post write system is partially inspired by the <a href="https://pre-commit.com/">pre-commit</a> tool, which configures git hooks that reformat source files as they are committed to a git repository. Pre-commit can serve this role for Alembic revision files as well, applying code formatters to them as they are committed. Alembic’s post write hooks are useful only in that they can format the files immediately upon generation, rather than at commit time, and also can be useful for projects that prefer not to use pre-commit.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basic-formatter-configuration"><a class="header" href="#basic-formatter-configuration">Basic Formatter Configuration</a></h1>
<p>The <code>alembic.ini</code> samples now include commented-out configuration illustrating how to configure code-formatting tools to run against the newly generated file path. Example:</p>
<pre><code class="language-ini">[post_write_hooks]

# format using &quot;black&quot;
hooks=black

black.type = console_scripts
black.entrypoint = black
black.options = -l 79
</code></pre>
<p>Above, we configure <code>hooks</code> to be a single post write hook labeled <code>&quot;black&quot;</code>. Note that this label is arbitrary. We then define the configuration for the <code>&quot;black&quot;</code> post write hook, which includes:</p>
<ul>
<li><code>type</code> - this is the type of hook we are running. Alembic includes a hook runner called <code>&quot;console_scripts&quot;</code>, which is specifically a Python function that uses <code>subprocess.run()</code> to invoke a separate Python script against the revision file. For a custom-written hook function, this configuration variable would refer to the name under which the custom hook was registered; see the next section for an example.</li>
</ul>
<p>The following configuration options are specific to the <code>&quot;console_scripts&quot;</code> hook runner:</p>
<ul>
<li>
<p><code>entrypoint</code> - the name of the <a href="https://setuptools.readthedocs.io/en/latest/pkg_resources.html#entry-points">setuptools entrypoint</a> that is used to define the console script. Within the scope of standard Python console scripts, this name will match the name of the shell command that is usually run for the code formatting tool, in this case <code>black</code>.</p>
</li>
<li>
<p><code>options</code> - a line of command-line options that will be passed to the code formatting tool. In this case, we want to run the command <code>black /path/to/revision.py -l 79</code>. By default, the revision path is positioned as the first argument. In order specify a different position, we can use the <code>REVISION_SCRIPT_FILENAME</code> token as illustrated by the subsequent examples.</p>
<p><strong>Note</strong>: Make sure options for the script are provided such that it will rewrite the input file <strong>in place</strong>. For example, when running autopep8, the <code>--in-place</code> option should be provided:</p>
<pre><code class="language-ini">[post_write_hooks]
hooks = autopep8
autopep8.type = console_scripts
autopep8.entrypoint = autopep8
autopep8.options = --in-place REVISION_SCRIPT_FILENAME
</code></pre>
</li>
<li>
<p><code>cwd</code> - optional working directory from which the console script is run.</p>
</li>
</ul>
<p>When running <code>alembic revision -m &quot;rev1&quot;</code>, we will now see the <code>black</code> tool’s output as well:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;rev1&quot;
  Generating /path/to/project/versions/481b13bc369a_rev1.py ... done
  Running post write hook &quot;black&quot; ...
reformatted /path/to/project/versions/481b13bc369a_rev1.py
All done! ✨ 🍰 ✨
1 file reformatted.
  done
</code></pre>
<p>Hooks may also be specified as a list of names, which correspond to hook runners that will run sequentially. As an example, we can also run the <a href="https://pypi.org/project/zimports/">zimports</a> import rewriting tool (written by Alembic’s author) subsequent to running the <code>black</code> tool, using a configuration as follows:</p>
<pre><code class="language-ini">[post_write_hooks]

# format using &quot;black&quot;, then &quot;zimports&quot;
hooks=black, zimports

black.type = console_scripts
black.entrypoint = black
black.options = -l 79 REVISION_SCRIPT_FILENAME

zimports.type = console_scripts
zimports.entrypoint = zimports
zimports.options = --style google REVISION_SCRIPT_FILENAME
</code></pre>
<p>When using the above configuration, a newly generated revision file will be processed first by the “black” tool, then by the “zimports” tool.</p>
<p>Alternatively, one can run pre-commit itself as follows:</p>
<pre><code class="language-ini">[post_write_hooks]

hooks = pre-commit

pre-commit.type = console_scripts
pre-commit.entrypoint = pre-commit
pre-commit.options = run --files REVISION_SCRIPT_FILENAME
pre-commit.cwd = %(here)s
</code></pre>
<p>(The last line helps to ensure that the <code>.pre-commit-config.yaml</code> file will always be found, regardless of from where the hook was called.)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writing-custom-hooks-as-python-functions"><a class="header" href="#writing-custom-hooks-as-python-functions">Writing Custom Hooks as Python Functions</a></h1>
<p>The previous section illustrated how to run command-line code formatters, through the use of a post write hook provided by Alembic known as <code>console_scripts</code>. This hook is in fact a Python function that is registered under that name using a registration function that may be used to register other types of hooks as well.</p>
<p>To illustrate, we will use the example of a short Python function that wants to rewrite the generated code to use tabs instead of four spaces. For simplicity, we will illustrate how this function can be present directly in the <code>env.py</code> file. The function is declared and registered using the <a href="http://localhost:3002/en/api/script.html#alembic.script.write_hooks.register">write_hooks.register()</a> decorator:</p>
<pre><code class="language-python">from alembic.script import write_hooks
import re

@write_hooks.register(&quot;spaces_to_tabs&quot;)
def convert_spaces_to_tabs(filename, options):
    lines = []
    with open(filename) as file_:
        for line in file_:
            lines.append(
                re.sub(
                    r&quot;^(    )+&quot;,
                    lambda m: &quot;\t&quot; * (len(m.group(1)) // 4),
                    line
                )
            )
    with open(filename, &quot;w&quot;) as to_write:
        to_write.write(&quot;&quot;.join(lines))
</code></pre>
<p>Our new <code>&quot;spaces_to_tabs&quot;</code> hook can be configured in <code>alembic.ini</code> as follows:</p>
<pre><code class="language-ini">[alembic]

# ...

# ensure the revision command loads env.py
revision_environment = true

[post_write_hooks]

hooks = spaces_to_tabs

spaces_to_tabs.type = spaces_to_tabs
</code></pre>
<p>When <code>alembic revision</code> is run, the <code>env.py</code> file will be loaded in all cases, the custom <code>“spaces_to_tabs”</code> function will be registered and it will then be run against the newly generated file path:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;rev1&quot;
  Generating /path/to/project/versions/481b13bc369a_rev1.py ... done
  Running post write hook &quot;spaces_to_tabs&quot; ...
  done
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generating-sql-scripts-aka-offline-mode"><a class="header" href="#generating-sql-scripts-aka-offline-mode">Generating SQL Scripts (a.k.a. “Offline Mode”)</a></h1>
<p><strong>生成SQL脚本(又称离线模式)</strong></p>
<p>A major capability of Alembic is to generate migrations as SQL scripts, instead of running them against the database - this is also referred to as offline mode. This is a critical feature when working in large organizations where access to DDL is restricted, and SQL scripts must be handed off to DBAs. Alembic makes this easy via the <code>--sql</code> option passed to any <code>upgrade</code> or <code>downgrade</code> command. We can, for example, generate a script that revises up to rev <code>ae1027a6acf</code>:</p>
<pre><code class="language-bash">$ alembic upgrade ae1027a6acf --sql
INFO  [alembic.context] Context class PostgresqlContext.
INFO  [alembic.context] Will assume transactional DDL.
BEGIN;

CREATE TABLE alembic_version (
    version_num VARCHAR(32) NOT NULL
);

INFO  [alembic.context] Running upgrade None -&gt; 1975ea83b712
CREATE TABLE account (
    id SERIAL NOT NULL,
    name VARCHAR(50) NOT NULL,
    description VARCHAR(200),
    PRIMARY KEY (id)
);

INFO  [alembic.context] Running upgrade 1975ea83b712 -&gt; ae1027a6acf
ALTER TABLE account ADD COLUMN last_transaction_date TIMESTAMP WITHOUT TIME ZONE;

INSERT INTO alembic_version (version_num) VALUES ('ae1027a6acf');

COMMIT;
</code></pre>
<p>While the logging configuration dumped to standard error, the actual script was dumped to standard output - so in the absence of further configuration (described later in this section), we’d at first be using output redirection to generate a script:</p>
<pre><code class="language-bash">alembic upgrade ae1027a6acf --sql &gt; migration.sql
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-the-start-version"><a class="header" href="#getting-the-start-version">Getting the Start Version</a></h1>
<p>Notice that our migration script started at the base - this is the default when using offline mode, as no database connection is present and there’s no <code>alembic_version</code> table to read from.</p>
<p>One way to provide a starting version in offline mode is to provide a range to the command line. This is accomplished by providing the “version” in <code>start:end</code> syntax:</p>
<pre><code class="language-bash">alembic upgrade 1975ea83b712:ae1027a6acf --sql &gt; migration.sql
</code></pre>
<p>The <code>start:end</code> syntax is only allowed in offline mode; in “online” mode, the <code>alembic_version</code> table is always used to get at the current version.</p>
<p>It’s also possible to have the <code>env.py</code> script retrieve the “last” version from the local environment, such as from a local file. A scheme like this would basically treat a local file in the same way <code>alembic_version</code> works:</p>
<pre><code class="language-python">if context.is_offline_mode():
    version_file = os.path.join(os.path.dirname(config.config_file_name), &quot;version.txt&quot;)
    if os.path.exists(version_file):
        current_version = open(version_file).read()
    else:
        current_version = None
    context.configure(dialect_name=engine.name, starting_rev=current_version)
    context.run_migrations()
    end_version = context.get_revision_argument()
    if end_version and end_version != current_version:
        open(version_file, 'w').write(end_version)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writing-migration-scripts-to-support-script-generation"><a class="header" href="#writing-migration-scripts-to-support-script-generation">Writing Migration Scripts to Support Script Generation</a></h1>
<p>The challenge of SQL script generation is that the scripts we generate can’t rely upon any client/server database access. This means a migration script that pulls some rows into memory via a <code>SELECT</code> statement will not work in <code>--sql</code> mode. It’s also important that the Alembic directives, all of which are designed specifically to work in both “live execution” as well as “offline SQL generation” mode, are used.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="customizing-the-environment"><a class="header" href="#customizing-the-environment">Customizing the Environment</a></h1>
<p>Users of the <code>--sql</code> option are encouraged to hack their env.py files to suit their needs. The env.py script as provided is broken into two sections: <code>run_migrations_online()</code> and <code>run_migrations_offline()</code>. Which function is run is determined at the bottom of the script by reading <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.is_offline_mode">EnvironmentContext.is_offline_mode()</a></strong>, which basically determines if the <code>--sql</code> flag was enabled.</p>
<p>For example, a multiple database configuration may want to run through each database and set the output of the migrations to different named files - the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a></strong> function accepts a parameter <code>output_buffer</code> for this purpose. Below we illustrate this within the <code>run_migrations_offline()</code> function:</p>
<pre><code class="language-python">from alembic import context
import myapp
import sys

db_1 = myapp.db_1
db_2 = myapp.db_2

def run_migrations_offline():
    &quot;&quot;&quot;Run migrations *without* a SQL connection.&quot;&quot;&quot;

    for name, engine, file_ in [
        (&quot;db1&quot;, db_1, &quot;db1.sql&quot;),
        (&quot;db2&quot;, db_2, &quot;db2.sql&quot;),
    ]:
        context.configure(
                    url=engine.url,
                    transactional_ddl=False,
                    output_buffer=open(file_, 'w'))
        context.execute(&quot;-- running migrations for '%s'&quot; % name)
        context.run_migrations(name=name)
        sys.stderr.write(&quot;Wrote file '%s'&quot; % file_)

def run_migrations_online():
    &quot;&quot;&quot;Run migrations *with* a SQL connection.&quot;&quot;&quot;

    for name, engine in [
        (&quot;db1&quot;, db_1),
        (&quot;db2&quot;, db_2),
    ]:
        connection = engine.connect()
        context.configure(connection=connection)
        try:
            context.run_migrations(name=name)
            session.commit()
        except:
            session.rollback()
            raise

if context.is_offline_mode():
    run_migrations_offline()
else:
    run_migrations_online()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-importance-of-naming-constraints"><a class="header" href="#the-importance-of-naming-constraints">The Importance of Naming Constraints</a></h1>
<p><strong>命名约束的重要性</strong></p>
<p>An important topic worth mentioning is that of constraint naming conventions. As we’ve proceeded here, we’ve talked about adding tables and columns, and we’ve also hinted at lots of other operations listed in <a href="zh/../en/ops.html#ops">Operation Reference</a> such as those which support adding or dropping constraints like foreign keys and unique constraints. The way these constraints are referred to in migration scripts is by name, however these names by default are in most cases generated by the relational database in use, when the constraint is created. For example, if you emitted two CREATE TABLE statements like this on Postgresql:</p>
<pre><code class="language-sql">test=&gt; CREATE TABLE user_account (id INTEGER PRIMARY KEY);
CREATE TABLE
test=&gt; CREATE TABLE user_order (
test(&gt;   id INTEGER PRIMARY KEY,
test(&gt;   user_account_id INTEGER REFERENCES user_account(id));
CREATE TABLE
</code></pre>
<p>Suppose we wanted to DROP the REFERENCES that we just applied to the <code>user_order.user_account_id</code> column, how do we do that? At the prompt, we’d use <code>ALTER TABLE &lt;tablename&gt; DROP CONSTRAINT &lt;constraint_name&gt;</code>, or if using Alembic we’d be using <strong><a href="zh/../en/ops.html#alembic.operations.Operations.drop_constraint">Operations.drop_constraint()</a></strong>. But both of those functions need a name - what’s the name of this constraint?</p>
<p>It does have a name, which in this case we can figure out by looking at the Postgresql catalog tables:</p>
<pre><code class="language-sql">test=&gt; SELECT r.conname FROM
test-&gt;  pg_catalog.pg_class c JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
test-&gt;  JOIN pg_catalog.pg_constraint r  ON c.oid = r.conrelid
test-&gt;  WHERE c.relname='user_order' AND r.contype = 'f'
test-&gt; ;
             conname
---------------------------------
 user_order_user_account_id_fkey
(1 row)
</code></pre>
<p>The name above is not something that Alembic or SQLAlchemy created; <code>user_order_user_account_id_fkey</code> is a naming scheme used internally by Postgresql to name constraints that are otherwise not named.</p>
<p>This scheme doesn’t seem so complicated, and we might want to just use our knowledge of it so that we know what name to use for our <strong><a href="zh/../en/ops.html#alembic.operations.Operations.drop_constraint">Operations.drop_constraint()</a></strong> call. But is that a good idea? What if for example we needed our code to run on Oracle as well. OK, certainly Oracle uses this same scheme, right? Or if not, something similar. Let’s check:</p>
<pre><code class="language-sql">Oracle Database 10g Express Edition Release 10.2.0.1.0 - Production

SQL&gt; CREATE TABLE user_account (id INTEGER PRIMARY KEY);

Table created.

SQL&gt; CREATE TABLE user_order (
  2     id INTEGER PRIMARY KEY,
  3     user_account_id INTEGER REFERENCES user_account(id));

Table created.

SQL&gt; SELECT constraint_name FROM all_constraints WHERE
  2     table_name='USER_ORDER' AND constraint_type in ('R');

CONSTRAINT_NAME
-----------------------------------------------------
SYS_C0029334
</code></pre>
<p>Oh, we can see that is…..much worse. Oracle’s names are entirely unpredictable alphanumeric codes, and this will make being able to write migrations quite tedious, as we’d need to look up all these names.</p>
<p>The solution to having to look up names is to make your own names. This is an easy, though tedious thing to do manually. For example, to create our model in SQLAlchemy ensuring we use names for foreign key constraints would look like:</p>
<pre><code class="language-python">from sqlalchemy import MetaData, Table, Column, Integer, ForeignKey

meta = MetaData()

user_account = Table('user_account', meta,
                  Column('id', Integer, primary_key=True)
              )

user_order = Table('user_order', meta,
                  Column('id', Integer, primary_key=True),
                  Column('user_order_id', Integer,
                    ForeignKey('user_account.id', name='fk_user_order_id'))
              )
</code></pre>
<p>Simple enough, though this has some disadvantages. The first is that it’s tedious; we need to remember to use a name for every <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.ForeignKey">ForeignKey</a></strong> object, not to mention every <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.UniqueConstraint">UniqueConstraint</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.CheckConstraint">CheckConstraint</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Index">Index</a></strong>, and maybe even <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.PrimaryKeyConstraint">PrimaryKeyConstraint</a></strong> as well if we wish to be able to alter those too, and beyond all that, all the names have to be globally unique. Even with all that effort, if we have a naming scheme in mind, it’s easy to get it wrong when doing it manually each time.</p>
<p>What’s worse is that manually naming constraints (and indexes) gets even more tedious in that we can no longer use convenience features such as the <code>.unique=True</code> or <code>.index=True</code> flag on <strong>[Column]</strong>:</p>
<pre><code class="language-python">user_account = Table('user_account', meta,
                  Column('id', Integer, primary_key=True),
                  Column('name', String(50), unique=True)
              )
</code></pre>
<p>Above, the <code>unique=True</code> flag creates a <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.UniqueConstraint">UniqueConstraint</a></strong>, but again, it’s not named. If we want to name it, manually we have to forego the usage of <code>unique=True</code> and type out the whole constraint:</p>
<pre><code class="language-python">user_account = Table('user_account', meta,
                  Column('id', Integer, primary_key=True),
                  Column('name', String(50)),
                  UniqueConstraint('name', name='uq_user_account_name')
              )
</code></pre>
<p>There’s a solution to all this naming work, which is to use an <strong>automated naming convention</strong>. For some years, SQLAlchemy has encourgaged the use of DDL Events in order to create naming schemes. The <strong><a href="https://docs.sqlalchemy.org/en/14/core/events.html#sqlalchemy.events.DDLEvents.after_parent_attach">after_parent_attach()</a></strong> event in particular is the best place to intercept when <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Constraint">Constraint</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Index">Index</a></strong> objects are being associated with a parent <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object, and to assign a <code>.name</code> to the constraint while making use of the name of the table and associated columns.</p>
<p>But there is also a better way to go, which is to make use of a feature new in SQLAlchemy 0.9.2 which makes use of the events behind the scenes known as <strong>naming_convention</strong>. Here, we can create a new <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> object while passing a dictionary referring to a naming scheme:</p>
<pre><code class="language-python">convention = {
  &quot;ix&quot;: &quot;ix_%(column_0_label)s&quot;,
  &quot;uq&quot;: &quot;uq_%(table_name)s_%(column_0_name)s&quot;,
  &quot;ck&quot;: &quot;ck_%(table_name)s_%(constraint_name)s&quot;,
  &quot;fk&quot;: &quot;fk_%(table_name)s_%(column_0_name)s_%(referred_table_name)s&quot;,
  &quot;pk&quot;: &quot;pk_%(table_name)s&quot;
}

metadata = MetaData(naming_convention=convention)
</code></pre>
<p>If we define our models using a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> as above, the given naming convention dictionary will be used to provide names for all constraints and indexes.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="integration-of-naming-conventions-into-operations-autogenerate"><a class="header" href="#integration-of-naming-conventions-into-operations-autogenerate">Integration of Naming Conventions into Operations, Autogenerate</a></h1>
<p>As of Alembic 0.6.4, the naming convention feature is integrated into the <strong><a href="zh/../en/ops.html#alembic.operations.Operations">Operations</a></strong> object, so that the convention takes effect for any constraint that is otherwise unnamed. The naming convention is passed to <strong><a href="zh/../en/ops.html#alembic.operations.Operations">Operations</a></strong> using the <strong>MigrationsContext.configure.target_metadata</strong> parameter in <code>env.py</code>, which is normally configured when autogenerate is used:</p>
<pre><code class="language-python"># in your application's model:

meta = MetaData(naming_convention={
        &quot;ix&quot;: &quot;ix_%(column_0_label)s&quot;,
        &quot;uq&quot;: &quot;uq_%(table_name)s_%(column_0_name)s&quot;,
        &quot;ck&quot;: &quot;ck_%(table_name)s_%(constraint_name)s&quot;,
        &quot;fk&quot;: &quot;fk_%(table_name)s_%(column_0_name)s_%(referred_table_name)s&quot;,
        &quot;pk&quot;: &quot;pk_%(table_name)s&quot;
      })
Base = declarative_base(metadata=meta)

# .. in your Alembic env.py:

# add your model's MetaData object here
# for 'autogenerate' support
from myapp import mymodel
target_metadata = mymodel.Base.metadata

# ...

def run_migrations_online():

    # ...

    context.configure(
                connection=connection,
                target_metadata=target_metadata
                )
</code></pre>
<p>Above, when we render a directive like the following:</p>
<pre><code class="language-python">op.add_column('sometable', Column('q', Boolean(name='q_bool')))
</code></pre>
<p>The Boolean type will render a CHECK constraint with the name <code>&quot;ck_sometable_q_bool&quot;</code>, assuming the backend in use does not support native boolean types.</p>
<p>We can also use op directives with constraints and not give them a name at all, if the naming convention doesn’t require one. The value of <code>None</code> will be converted into a name that follows the appropriate naming conventions:</p>
<pre><code class="language-python">def upgrade():
    op.create_unique_constraint(None, 'some_table', 'x')
</code></pre>
<p>When autogenerate renders constraints in a migration script, it renders them typically with their completed name. If using at least Alembic 0.6.4 as well as SQLAlchemy 0.9.4, these will be rendered with a special directive <strong><a href="zh/../en/ops.html#alembic.operations.Operations.f">Operations.f()</a></strong> which denotes that the string has already been tokenized:</p>
<pre><code class="language-python">def upgrade():
    op.create_unique_constraint(op.f('uq_const_x'), 'some_table', 'x')
</code></pre>
<p>For more detail on the naming convention feature, see <a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#constraint-naming-conventions">Configuring Constraint Naming Conventions</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running-batch-migrations-for-sqlite-and-other-databases"><a class="header" href="#running-batch-migrations-for-sqlite-and-other-databases">Running “Batch” Migrations for SQLite and Other Databases</a></h1>
<p><strong>在SQLite和其他数据中运行&quot;Batch&quot;迁移脚本</strong></p>
<p>The SQLite database presents a challenge to migration tools in that it has almost no support for the ALTER statement which relational schema migrations rely upon. The rationale for this stems from philosophical and architectural concerns within SQLite, and they are unlikely to be changed.</p>
<p>Migration tools are instead expected to produce copies of SQLite tables that correspond to the new structure, transfer the data from the existing table to the new one, then drop the old table. For our purposes here we’ll call this <strong>“move and copy”</strong> workflow, and in order to accommodate it in a way that is reasonably predictable, while also remaining compatible with other databases, Alembic provides the <strong>batch</strong> operations context.</p>
<p>Within this context, a relational table is named, and then a series of mutation operations to that table alone are specified within the block. When the context is complete, a process begins whereby the <strong>“move and copy”</strong> procedure begins; the existing table structure is reflected from the database, a new version of this table is created with the given changes, data is copied from the old table to the new table using “INSERT from SELECT”, and finally the old table is dropped and the new one renamed to the original name.</p>
<p>The <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> method provides the gateway to this process:</p>
<pre><code class="language-python">with op.batch_alter_table(&quot;some_table&quot;) as batch_op:
    batch_op.add_column(Column('foo', Integer))
    batch_op.drop_column('bar')
</code></pre>
<p>When the above directives are invoked within a migration script, on a SQLite backend we would see SQL like:</p>
<pre><code class="language-sql">CREATE TABLE _alembic_batch_temp (
  id INTEGER NOT NULL,
  foo INTEGER,
  PRIMARY KEY (id)
);
INSERT INTO _alembic_batch_temp (id) SELECT some_table.id FROM some_table;
DROP TABLE some_table;
ALTER TABLE _alembic_batch_temp RENAME TO some_table;
</code></pre>
<p>On other backends, we’d see the usual ALTER statements done as though there were no batch directive - the batch context by default only does the “move and copy” process if SQLite is in use, and if there are migration directives other than <strong><a href="zh/../en/ops.html#alembic.operations.Operations.add_column">Operations.add_column()</a></strong> present, which is the one kind of column-level ALTER statement that SQLite supports. <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> can be configured to run “move and copy” unconditionally in all cases, including on databases other than SQLite; more on this is below.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="controlling-table-reflection"><a class="header" href="#controlling-table-reflection">Controlling Table Reflection</a></h1>
<p><strong>控制表反射</strong></p>
<p>The <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object that is reflected when “move and copy” proceeds is performed using the standard <code>autoload=True</code> approach. This call can be affected using the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.reflect_args">reflect_args</a></strong> and <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.reflect_kwargs">reflect_kwargs</a></strong> arguments. For example, to override a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> within the reflection process such that a <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> object is reflected with the <code>create_constraint</code> flag set to <code>False</code>:</p>
<pre><code class="language-python">with self.op.batch_alter_table(
    &quot;bar&quot;,
    reflect_args=[Column('flag', Boolean(create_constraint=False))]
) as batch_op:
    batch_op.alter_column(
        'flag', new_column_name='bflag', existing_type=Boolean)
</code></pre>
<p>Another use case, add a listener to the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> as it is reflected so that special logic can be applied to columns or types, using the <strong><a href="https://docs.sqlalchemy.org/en/14/core/events.html#sqlalchemy.events.DDLEvents.column_reflect">column_reflect()</a></strong> event:</p>
<pre><code class="language-python">def listen_for_reflect(inspector, table, column_info):
    &quot;correct an ENUM type&quot;
    if column_info['name'] == 'my_enum':
        column_info['type'] = Enum('a', 'b', 'c')

with self.op.batch_alter_table(
    &quot;bar&quot;,
    reflect_kwargs=dict(
        listeners=[
            ('column_reflect', listen_for_reflect)
        ]
    )
) as batch_op:
    batch_op.alter_column(
        'flag', new_column_name='bflag', existing_type=Boolean)
</code></pre>
<p>The reflection process may also be bypassed entirely by sending a pre-fabricated <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object; see <strong><a href="zh/../zh/04_03_working_in_offline_mode.html">Working in Offline Mode</a></strong> for an example.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dealing-with-constraints"><a class="header" href="#dealing-with-constraints">Dealing with Constraints</a></h1>
<p><strong>处理约束</strong></p>
<p>There are a variety of issues when using “batch” mode with constraints, such as FOREIGN KEY, CHECK and UNIQUE constraints. This section will attempt to detail many of these scenarios.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dropping-unnamed-or-named-foreign-key-constraints"><a class="header" href="#dropping-unnamed-or-named-foreign-key-constraints">Dropping Unnamed or Named Foreign Key Constraints</a></h1>
<p><strong>删除未命名或命名的外键约束</strong></p>
<p>SQLite, unlike any other database, allows constraints to exist in the database that have no identifying name. On all other backends, the target database will always generate some kind of name, if one is not given.</p>
<p>The first challenge this represents is that an unnamed constraint can’t by itself be targeted by the <strong><a href="zh/../en/ops.html#alembic.operations.BatchOperations.drop_constraint">BatchOperations.drop_constraint()</a></strong> method. An unnamed FOREIGN KEY constraint is implicit whenever the <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.ForeignKey">ForeignKey</a></strong> or <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.ForeignKeyConstraint">ForeignKeyConstraint</a></strong> objects are used without passing them a name. Only on SQLite will these constraints remain entirely unnamed when they are created on the target database; an automatically generated name will be assigned in the case of all other database backends.</p>
<p>A second issue is that SQLAlchemy itself has inconsistent behavior in dealing with SQLite constraints as far as names. Prior to version 1.0, SQLAlchemy omits the name of foreign key constraints when reflecting them against the SQLite backend. So even if the target application has gone through the steps to apply names to the constraints as stated in the database, they still aren’t targetable within the batch reflection process prior to SQLAlchemy 1.0.</p>
<p>Within the scope of batch mode, this presents the issue that the <strong><a href="zh/../en/ops.html#alembic.operations.BatchOperations.drop_constraint">BatchOperations.drop_constraint()</a></strong> method requires a constraint name in order to target the correct constraint.</p>
<p>In order to overcome this, the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> method supports a <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.naming_convention">naming_convention</a></strong> argument, so that all reflected constraints, including foreign keys that are unnamed, or were named but SQLAlchemy isn’t loading this name, may be given a name, as described in Integration of Naming Conventions into Operations, Autogenerate. Usage is as follows:</p>
<pre><code class="language-python">naming_convention = {
    &quot;fk&quot;:
    &quot;fk_%(table_name)s_%(column_0_name)s_%(referred_table_name)s&quot;,
}
with self.op.batch_alter_table(
        &quot;bar&quot;, naming_convention=naming_convention) as batch_op:
    batch_op.drop_constraint(
        &quot;fk_bar_foo_id_foo&quot;, type_=&quot;foreignkey&quot;)
</code></pre>
<p>Note that the naming convention feature requires at least <strong>SQLAlchemy 0.9.4</strong> for support.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="including-unnamed-unique-constraints"><a class="header" href="#including-unnamed-unique-constraints">Including unnamed UNIQUE constraints</a></h1>
<p><strong>包含未命名的 UNIQUE 约束</strong></p>
<p>A similar, but frustratingly slightly different, issue is that in the case of UNIQUE constraints, we again have the issue that SQLite allows unnamed UNIQUE constraints to exist on the database, however in this case, SQLAlchemy prior to version 1.0 doesn’t reflect these constraints at all. It does properly reflect named unique constraints with their names, however.</p>
<p>So in this case, the workaround for foreign key names is still not sufficient prior to SQLAlchemy 1.0. If our table includes unnamed unique constraints, and we’d like them to be re-created along with the table, we need to include them directly, which can be via the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.table_args">table_args</a></strong> argument:</p>
<pre><code class="language-python">with self.op.batch_alter_table(
        &quot;bar&quot;, table_args=(UniqueConstraint('username'),)
    ):
    batch_op.add_column(Column('foo', Integer))
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changing-the-type-of-boolean-enum-and-other-implicit-check-datatypes"><a class="header" href="#changing-the-type-of-boolean-enum-and-other-implicit-check-datatypes">Changing the Type of Boolean, Enum and other implicit CHECK datatypes</a></h1>
<p><strong>更改布尔、枚举和其他隐式 CHECK 数据类型的类型</strong></p>
<p>The SQLAlchemy types <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> are part of a category of types known as “schema” types; this style of type creates other structures along with the type itself, most commonly (but not always) a CHECK constraint.</p>
<p>Alembic handles dropping and creating the CHECK constraints here automatically, including in the case of batch mode. When changing the type of an existing column, what’s necessary is that the existing type be specified fully:</p>
<pre><code class="language-python">with self.op.batch_alter_table(&quot;some_table&quot;) as batch_op:
    batch_op.alter_column(
        'q', type_=Integer,
        existing_type=Boolean(create_constraint=True, constraint_name=&quot;ck1&quot;))
</code></pre>
<p>When dropping a column that includes a named CHECK constraint, as of Alembic 1.7 this named constraint must also be provided using a similar form, as there is no ability for Alembic to otherwise link this reflected CHECK constraint as belonging to a particular column:</p>
<pre><code class="language-python">with self.op.batch_alter_table(&quot;some_table&quot;) as batch_op:
    batch_op.drop_column(
        'q',
        existing_type=Boolean(create_constraint=True, constraint_name=&quot;ck1&quot;))
    )
</code></pre>
<blockquote>
<p><em>Changed in version 1.7</em>: The <strong><a href="zh/../en/ops.html#alembic.operations.BatchOperations.drop_column">BatchOperations.drop_column()</a></strong> operation can accept an <code>existing_type</code> directive where a “schema type” such as <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> may be specified such that an associated named constraint can be removed.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="including-check-constraints"><a class="header" href="#including-check-constraints">Including CHECK constraints</a></h1>
<p><strong>包括 CHECK 约束</strong></p>
<p>As of Alembic 1.7, <strong>named</strong> CHECK constraints are automatically included in batch mode, as modern SQLAlchemy versions are capable of reflecting these constraints like any other constraint.</p>
<p>Note that when dropping or renaming a column that is mentioned in a named CHECK constraint, this CHECK constraint must be explicitly dropped first, as Alembic has no means of linking a reflected CHECK constraint to that column. Supposing column <code>q</code> of <code>some_table</code> were mentioned in a CHECK constraint named ck1. In order to drop this column, we have to drop the check constraint also:</p>
<pre><code class="language-python">with self.op.batch_alter_table(&quot;some_table&quot;) as batch_op:
    batch_op.drop_constraint(&quot;ck1&quot;, &quot;check&quot;)
    batch_op.drop_column('q')
</code></pre>
<blockquote>
<p><em>Changed in version 1.7</em>: Named CHECK constraints participate in batch mode in the same way as any other kind of constraint. This requires that column drops or renames now include explicit directives to drop an existing named constraint which refers to this column, as it will otherwise not be automatically detected as being associated with that particular column.</p>
<p>Unnamed CHECK constraints continue to be silently omitted from the table recreate operation.</p>
</blockquote>
<p>For <strong>unnamed</strong> CHECK constraints, these are still not automatically included as part of the batch process. Note that this limitation <strong>includes</strong> the CHECK constraints generated by the <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> or <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> datatypes, which up through SQLAlchemy 1.3 would generate CHECK constraints automatically and cannot be tracked to the reflected table, assuming they are generated in an <strong>unnamed</strong> way.</p>
<p>Unnamed constraints can be stated explicitly if they are to be included in the recreated table:</p>
<pre><code class="language-python">with op.batch_alter_table(&quot;some_table&quot;, table_args=[
      CheckConstraint('x &gt; 5')
  ]) as batch_op:
    batch_op.add_column(Column('foo', Integer))
    batch_op.drop_column('bar')
</code></pre>
<p>The above step needs only be taken for CHECK constraints that are explicitly stated as part of the table definition.</p>
<p>For CHECK constraints that are generated by datatypes such as <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> or Enum, the type objects themselves <strong>must be named</strong> in order for their CHECK constraints to be included in the batch process. <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> datatypes that do <strong>not</strong> have the <code>.name</code> attribute set will <strong>not</strong> have CHECK constraints regenerated. This name can be set by specifying the <code>.name</code> parameter or by using a named Python <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> object as the source of enumeration.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dealing-with-referencing-foreign-keys"><a class="header" href="#dealing-with-referencing-foreign-keys">Dealing with Referencing Foreign Keys</a></h1>
<p><strong>处理引用外键</strong></p>
<p>It is important to note that batch table operations <strong>do not work</strong> with foreign keys that enforce referential integrity. This because the target table is dropped; if foreign keys refer to it, this will raise an error. On SQLite, whether or not foreign keys actually enforce is controlled by the <code>PRAGMA FOREIGN KEYS</code> pragma; this pragma, if in use, must be disabled when the workflow mode proceeds. When the operation is complete, the batch-migrated table will have the same name that it started with, so those referring foreign keys will again refer to this table.</p>
<p>A special case is dealing with self-referring foreign keys. Here, Alembic takes a special step of recreating the self-referring foreign key as referring to the original table name, rather than at the “temp” table, so that like in the case of other foreign key constraints, when the table is renamed to its original name, the foreign key again references the correct table. This operation only works when referential integrity is disabled, consistent with the same requirement for referring foreign keys from other tables.</p>
<p>When SQLite’s <code>PRAGMA FOREIGN KEYS</code> mode is turned on, it does provide the service that foreign key constraints, including self-referential, will automatically be modified to point to their table across table renames, however this mode prevents the target table from being dropped as is required by a batch migration. Therefore it may be necessary to manipulate the <code>PRAGMA FOREIGN KEYS</code> setting if a migration seeks to rename a table vs. batch migrate it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-in-offline-mode"><a class="header" href="#working-in-offline-mode">Working in Offline Mode</a></h1>
<p><strong>在离线模式下工作</strong></p>
<p>In the preceding sections, we’ve seen how much of an emphasis the “move and copy” process has on using reflection in order to know the structure of the table that is to be copied. This means that in the typical case, “online” mode, where a live database connection is present so that <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> can reflect the table from the database, is required; the <code>--sql</code> flag <strong>cannot</strong> be used without extra steps.</p>
<p>To support offline mode, the system must work without table reflection present, which means the full table as it intends to be created must be passed to <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> using copy_from:</p>
<pre><code class="language-python">meta = MetaData()
some_table = Table(
    'some_table', meta,
    Column('id', Integer, primary_key=True),
    Column('bar', String(50))
)

with op.batch_alter_table(&quot;some_table&quot;, copy_from=some_table) as batch_op:
    batch_op.add_column(Column('foo', Integer))
    batch_op.drop_column('bar')
</code></pre>
<p>The above use pattern is pretty tedious and quite far off from Alembic’s preferred style of working; however, if one needs to do SQLite-compatible “move and copy” migrations and need them to generate flat SQL files in “offline” mode, there’s not much alternative.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch-mode-with-autogenerate"><a class="header" href="#batch-mode-with-autogenerate">Batch mode with Autogenerate</a></h1>
<p><strong>带自动生成的批处理模式</strong></p>
<p>The syntax of batch mode is essentially that <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> is used to enter a batch block, and the returned <strong><a href="zh/../en/ops.html#alembic.operations.BatchOperations">BatchOperations</a></strong> context works just like the regular <strong><a href="zh/../en/ops.html#alembic.operations.Operations">Operations</a></strong> context, except that the “table name” and “schema name” arguments are omitted.</p>
<p>To support rendering of migration commands in batch mode for autogenerate, configure the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.render_as_batch">EnvironmentContext.configure.render_as_batch</a></strong> flag in env.py:</p>
<pre><code class="language-python">context.configure(
    connection=connection,
    target_metadata=target_metadata,
    render_as_batch=True
)
</code></pre>
<p>Autogenerate will now generate along the lines of:</p>
<pre><code class="language-python">def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('address', schema=None) as batch_op:
        batch_op.add_column(sa.Column('street', sa.String(length=50), nullable=True))
</code></pre>
<p>This mode is safe to use in all cases, as the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table">Operations.batch_alter_table()</a></strong> directive by default only takes place for SQLite; other backends will behave just as they normally do in the absence of the batch directives.</p>
<p>Note that autogenerate support does not include “offline” mode, where the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.copy_from">Operations.batch_alter_table.copy_from</a></strong> parameter is used. The table definition here would need to be entered into migration files manually if this is needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch-mode-with-databases-other-than-sqlite"><a class="header" href="#batch-mode-with-databases-other-than-sqlite">Batch mode with databases other than SQLite</a></h1>
<p><strong>SQLite 以外的数据库的批处理模式</strong></p>
<p>There’s an odd use case some shops have, where the “move and copy” style of migration is useful in some cases for databases that do already support ALTER. There’s some cases where an ALTER operation may block access to the table for a long time, which might not be acceptable. “move and copy” can be made to work on other backends, though with a few extra caveats.</p>
<p>The batch mode directive will run the “recreate” system regardless of backend if the flag <code>recreate='always'</code> is passed:</p>
<pre><code class="language-python">with op.batch_alter_table(&quot;some_table&quot;, recreate='always') as batch_op:
    batch_op.add_column(Column('foo', Integer))
</code></pre>
<p>The issues that arise in this mode are mostly to do with constraints. Databases such as Postgresql and MySQL with InnoDB will enforce referential integrity (e.g. via foreign keys) in all cases. Unlike SQLite, it’s not as simple to turn off referential integrity across the board (nor would it be desirable). Since a new table is replacing the old one, existing foreign key constraints which refer to the target table will need to be unconditionally dropped before the batch operation, and re-created to refer to the new table afterwards. Batch mode currently does not provide any automation for this.</p>
<p>The Postgresql database and possibly others also have the behavior such that when the new table is created, a naming conflict occurs with the named constraints of the new table, in that they match those of the old table, and on Postgresql, these names need to be unique across all tables. The Postgresql dialect will therefore emit a “DROP CONSTRAINT” directive for all constraints on the old table before the new one is created; this is “safe” in case of a failed operation because Postgresql also supports transactional DDL.</p>
<p>Note that also as is the case with SQLite, CHECK constraints need to be moved over between old and new table manually using the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.batch_alter_table.params.table_args">Operations.batch_alter_table.table_args</a></strong> parameter.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-branches"><a class="header" href="#working-with-branches">Working with Branches</a></h1>
<p><strong>工作分支</strong></p>
<p>A <strong>branch</strong> describes a point in a migration stream when two or more versions refer to the same parent migration as their anscestor. Branches occur naturally when two divergent source trees, both containing Alembic revision files created independently within those source trees, are merged together into one. When this occurs, the challenge of a branch is to <strong>merge</strong> the branches into a single series of changes, so that databases established from either source tree individually can be upgraded to reference the merged result equally. Another scenario where branches are present are when we create them directly; either at some point in the migration stream we’d like different series of migrations to be managed independently (e.g. we create a tree), or we’d like separate migration streams for different features starting at the root (e.g. a forest). We’ll illustrate all of these cases, starting with the most common which is a source-merge-originated branch that we’ll merge.</p>
<p>Starting with the “account table” example we began in <strong><a href="zh/../en/tutorial.html#create-migration">Create a Migration Script</a></strong>, assume we have our basemost version <code>1975ea83b712</code>, which leads into the second revision <code>ae1027a6acf</code>, and the migration files for these two revisions are checked into our source repository. Consider if we merged into our source repository another code branch which contained a revision for another table called <code>shopping_cart</code>. This revision was made against our first Alembic revision, the one that generated <code>account</code>. After loading the second source tree in, a new file <code>27c6a30d7c24_add_shopping_cart_table.py</code> exists within our <code>versions</code> directory. Both it, as well as <code>ae1027a6acf_add_a_column.py</code>, reference <code>1975ea83b712_add_account_table.py</code> as the “downgrade” revision. To illustrate:</p>
<pre><code class="language-bash"># main source tree:
1975ea83b712 (create account table) -&gt; ae1027a6acf (add a column)

# branched source tree
1975ea83b712 (create account table) -&gt; 27c6a30d7c24 (add shopping cart table)
</code></pre>
<p>Above, we can see <code>1975ea83b712</code> is our <strong>branch point</strong>; two distinct versions both refer to it as its parent. The Alembic command <code>branches</code> illustrates this fact:</p>
<pre><code class="language-bash">$ alembic branches --verbose
Rev: 1975ea83b712 (branchpoint)
Parent: &lt;base&gt;
Branches into: 27c6a30d7c24, ae1027a6acf
Path: foo/versions/1975ea83b712_add_account_table.py

    create account table

    Revision ID: 1975ea83b712
    Revises:
    Create Date: 2014-11-20 13:02:46.257104

             -&gt; 27c6a30d7c24 (head), add shopping cart table
             -&gt; ae1027a6acf (head), add a column
</code></pre>
<p>History shows it too, illustrating two <code>head</code> entries as well as a <code>branchpoint</code>:</p>
<pre><code class="language-bash">$ alembic history
1975ea83b712 -&gt; 27c6a30d7c24 (head), add shopping cart table
1975ea83b712 -&gt; ae1027a6acf (head), add a column
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>We can get a view of just the current heads using <code>alembic heads</code>:</p>
<pre><code class="language-bash">$ alembic heads --verbose
Rev: 27c6a30d7c24 (head)
Parent: 1975ea83b712
Path: foo/versions/27c6a30d7c24_add_shopping_cart_table.py

    add shopping cart table

    Revision ID: 27c6a30d7c24
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:03:11.436407

Rev: ae1027a6acf (head)
Parent: 1975ea83b712
Path: foo/versions/ae1027a6acf_add_a_column.py

    add a column

    Revision ID: ae1027a6acf
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:02:54.849677
</code></pre>
<p>If we try to run an <code>upgrade</code> to the usual end target of <code>head</code>, Alembic no longer considers this to be an unambiguous command. As we have more than one <code>head</code>, the <code>upgrade</code> command wants us to provide more information:</p>
<pre><code class="language-bash">$ alembic upgrade head
  FAILED: Multiple head revisions are present for given argument 'head'; please specify a specific
  target revision, '&lt;branchname&gt;@head' to narrow to a specific head, or 'heads' for all heads
</code></pre>
<p>The <code>upgrade</code> command gives us quite a few options in which we can proceed with our <code>upgrade</code>, either giving it information on which head we’d like to <code>upgrade</code> towards, or alternatively stating that we’d like all heads to be upgraded towards at once. However, in the typical case of two source trees being merged, we will want to pursue a third option, which is that we can <strong>merge</strong> these branches.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="merging-branches"><a class="header" href="#merging-branches">Merging Branches</a></h1>
<p><strong>合并分支</strong></p>
<p>An Alembic merge is a migration file that joins two or more “head” files together. If the two branches we have right now can be said to be a “tree” structure, introducing this merge file will turn it into a “diamond” structure:</p>
<pre><code class="language-text">                            -- ae1027a6acf --&gt;
                           /                   \
&lt;base&gt; --&gt; 1975ea83b712 --&gt;                      --&gt; mergepoint
                           \                   /
                            -- 27c6a30d7c24 --&gt;
</code></pre>
<p>We create the merge file using alembic merge; with this command, we can pass to it an argument such as <code>heads</code>, meaning we’d like to merge all <code>heads</code>. Or, we can pass it individual revision numbers sequentally:</p>
<pre><code class="language-bash">$ alembic merge -m &quot;merge ae1 and 27c&quot; ae1027 27c6a
  Generating /path/to/foo/versions/53fffde5ad5_merge_ae1_and_27c.py ... done
</code></pre>
<p>Looking inside the new file, we see it as a regular migration file, with the only new twist is that <code>down_revision</code> points to both revisions:</p>
<pre><code class="language-python">&quot;&quot;&quot;merge ae1 and 27c

Revision ID: 53fffde5ad5
Revises: ae1027a6acf, 27c6a30d7c24
Create Date: 2014-11-20 13:31:50.811663

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '53fffde5ad5'
down_revision = ('ae1027a6acf', '27c6a30d7c24')
branch_labels = None

from alembic import op
import sqlalchemy as sa


def upgrade():
    pass


def downgrade():
    pass
</code></pre>
<p>This file is a regular migration file, and if we wish to, we may place <strong><a href="zh/../en/ops.html#alembic.operations.Operations">Operations</a></strong> directives into the <code>upgrade()</code> and <code>downgrade()</code> functions like any other migration file. Though it is probably best to limit the instructions placed here only to those that deal with any kind of reconciliation that is needed between the two merged branches, if any.</p>
<p>The <code>heads</code> command now illustrates that the multiple <code>heads</code> in our <code>versions/</code> directory have been resolved into our new head:</p>
<pre><code class="language-bash">$ alembic heads --verbose
Rev: 53fffde5ad5 (head) (mergepoint)
Merges: ae1027a6acf, 27c6a30d7c24
Path: foo/versions/53fffde5ad5_merge_ae1_and_27c.py

    merge ae1 and 27c

    Revision ID: 53fffde5ad5
    Revises: ae1027a6acf, 27c6a30d7c24
    Create Date: 2014-11-20 13:31:50.811663
</code></pre>
<p>History shows a similar result, as the mergepoint becomes our head:</p>
<pre><code class="language-bash">$ alembic history
ae1027a6acf, 27c6a30d7c24 -&gt; 53fffde5ad5 (head) (mergepoint), merge ae1 and 27c
1975ea83b712 -&gt; ae1027a6acf, add a column
1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>With a single <code>head</code> target, a generic <code>upgrade</code> can proceed:</p>
<pre><code class="language-bash">$ alembic upgrade head
INFO  [alembic.migration] Context impl PostgresqlImpl.
INFO  [alembic.migration] Will assume transactional DDL.
INFO  [alembic.migration] Running upgrade  -&gt; 1975ea83b712, create account table
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; ae1027a6acf, add a column
INFO  [alembic.migration] Running upgrade ae1027a6acf, 27c6a30d7c24 -&gt; 53fffde5ad5, merge ae1 and 27c
</code></pre>
<p><strong>merge mechanics</strong></p>
<p>The upgrade process traverses through all of our migration files using a <strong>topological sorting</strong> algorithm, treating the list of migration files not as a linked list, but as a directed acyclic graph. The starting points of this traversal are the <strong>current heads</strong> within our database, and the end point is the “head” revision or revisions specified.</p>
<p>When a migration proceeds across a point at which there are multiple heads, the <code>alembic_version</code> table will at that point store multiple rows, one for each head. Our migration process above will emit SQL against <code>alembic_version</code> along these lines:</p>
<pre><code class="language-bash">-- Running upgrade  -&gt; 1975ea83b712, create account table
INSERT INTO alembic_version (version_num) VALUES ('1975ea83b712')

-- Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
UPDATE alembic_version SET version_num='27c6a30d7c24' WHERE alembic_version.version_num = '1975ea83b712'

-- Running upgrade 1975ea83b712 -&gt; ae1027a6acf, add a column
INSERT INTO alembic_version (version_num) VALUES ('ae1027a6acf')

-- Running upgrade ae1027a6acf, 27c6a30d7c24 -&gt; 53fffde5ad5, merge ae1 and 27c
DELETE FROM alembic_version WHERE alembic_version.version_num = 'ae1027a6acf'
UPDATE alembic_version SET version_num='53fffde5ad5' WHERE alembic_version.version_num = '27c6a30d7c24'
</code></pre>
<p>At the point at which both <code>27c6a30d7c24</code> and <code>ae1027a6acf</code> exist within our database, both values are present in <code>alembic_version</code>, which now has two rows. If we upgrade to these two versions alone, then stop and run <code>alembic current</code>, we will see this:</p>
<pre><code class="language-bash">$ alembic current --verbose
Current revision(s) for postgresql://scott:XXXXX@localhost/test:
Rev: ae1027a6acf
Parent: 1975ea83b712
Path: foo/versions/ae1027a6acf_add_a_column.py

    add a column

    Revision ID: ae1027a6acf
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:02:54.849677

Rev: 27c6a30d7c24
Parent: 1975ea83b712
Path: foo/versions/27c6a30d7c24_add_shopping_cart_table.py

    add shopping cart table

    Revision ID: 27c6a30d7c24
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:03:11.436407
</code></pre>
<p>A key advantage to the <code>merge</code> process is that it will run equally well on databases that were present on version <code>ae1027a6acf</code> alone, versus databases that were present on version <code>27c6a30d7c24</code> alone; whichever version was not yet applied, will be applied before the <code>merge</code> point can be crossed. This brings forth a way of thinking about a <code>merge</code> file, as well as about any Alembic revision file. As they are considered to be “nodes” within a set that is subject to topological sorting, each “node” is a point that cannot be crossed until all of its dependencies are satisfied.</p>
<p>Prior to Alembic’s support of merge points, the use case of databases sitting on different heads was basically impossible to reconcile; having to manually splice the head files together invariably meant that one migration would occur before the other, thus being incompatible with databases that were present on the other migration.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-explicit-branches"><a class="header" href="#working-with-explicit-branches">Working with Explicit Branches</a></h1>
<p><strong>使用显式分支</strong></p>
<p>The <code>alembic upgrade</code> command hinted at other options besides merging when dealing with multiple heads. Let’s back up and assume we’re back where we have as our heads just <code>ae1027a6acf</code> and <code>27c6a30d7c24</code>:</p>
<pre><code class="language-bash">$ alembic heads
27c6a30d7c24
ae1027a6acf
</code></pre>
<p>Earlier, when we did <code>alembic upgrade head</code>, it gave us an error which suggested <code>please specify a specific target revision, '&lt;branchname&gt;@head' to narrow to a specific head, or 'heads' for all heads</code> in order to proceed without merging. Let’s cover those cases.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="referring-to-all-heads-at-once"><a class="header" href="#referring-to-all-heads-at-once">Referring to all heads at once</a></h1>
<p><strong>一次引用到所有的head</strong></p>
<p>The <code>heads</code> identifier is a lot like <code>head</code>, except it explicitly refers to all <code>heads</code> at once. That is, it’s like telling Alembic to do the operation for both <code>ae1027a6acf</code> and <code>27c6a30d7c24</code> simultaneously. If we started from a fresh database and ran upgrade <code>heads</code> we’d see:</p>
<pre><code class="language-bash">$ alembic upgrade heads
INFO  [alembic.migration] Context impl PostgresqlImpl.
INFO  [alembic.migration] Will assume transactional DDL.
INFO  [alembic.migration] Running upgrade  -&gt; 1975ea83b712, create account table
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; ae1027a6acf, add a column
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
</code></pre>
<p>Since we’ve upgraded to <code>heads</code>, and we do in fact have more than one head, that means these two distinct <code>heads</code> are now in our <code>alembic_version</code> table. We can see this if we run <code>alembic current</code>:</p>
<pre><code class="language-bash">$ alembic current
ae1027a6acf (head)
27c6a30d7c24 (head)
</code></pre>
<p>That means there’s two rows in <code>alembic_version</code> right now. If we downgrade one step at a time, Alembic will <strong>delete</strong> from the <code>alembic_version</code> table each branch that’s closed out, until only one branch remains; then it will continue updating the single value down to the previous versions:</p>
<pre><code class="language-bash">$ alembic downgrade -1
INFO  [alembic.migration] Running downgrade ae1027a6acf -&gt; 1975ea83b712, add a column

$ alembic current
27c6a30d7c24 (head)

$ alembic downgrade -1
INFO  [alembic.migration] Running downgrade 27c6a30d7c24 -&gt; 1975ea83b712, add shopping cart table

$ alembic current
1975ea83b712 (branchpoint)

$ alembic downgrade -1
INFO  [alembic.migration] Running downgrade 1975ea83b712 -&gt; , create account table

$ alembic current
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="referring-to-a-specific-version"><a class="header" href="#referring-to-a-specific-version">Referring to a Specific Version</a></h1>
<p><strong>引用特定版本</strong></p>
<p>We can pass a specific version number to <code>upgrade</code>. Alembic will ensure that all revisions upon which this version depends are invoked, and nothing more. So if we <code>upgrade</code> either to <code>27c6a30d7c24</code> or <code>ae1027a6acf</code> specifically, it guarantees that <code>1975ea83b712</code> will have been applied, but not that any “sibling” versions are applied:</p>
<pre><code class="language-bash">$ alembic upgrade 27c6a
INFO  [alembic.migration] Running upgrade  -&gt; 1975ea83b712, create account table
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
</code></pre>
<p>With <code>1975ea83b712</code> and <code>27c6a30d7c24</code> applied, <code>ae1027a6acf</code> is just a single additional step:</p>
<pre><code class="language-bash">$ alembic upgrade ae102
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; ae1027a6acf, add a column
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-branch-labels"><a class="header" href="#working-with-branch-labels">Working with Branch Labels</a></h1>
<p><strong>使用分支标注</strong></p>
<p>To satisfy the use case where an environment has long-lived branches, especially independent branches as will be discussed in the next section, Alembic supports the concept of branch labels. These are string values that are present within the migration file, using the new identifier <code>branch_labels</code>. For example, if we want to refer to the “shopping cart” branch using the name “shoppingcart”, we can add that name to our file <code>27c6a30d7c24_add_shopping_cart_table.py</code>:</p>
<pre><code class="language-python">&quot;&quot;&quot;add shopping cart table

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '27c6a30d7c24'
down_revision = '1975ea83b712'
branch_labels = ('shoppingcart',)

# ...
</code></pre>
<p>The <code>branch_labels</code> attribute refers to a string name, or a tuple of names, which will now apply to this revision, all descendants of this revision, as well as all ancestors of this revision up until the preceding branch point, in this case <code>1975ea83b712</code>. We can see the <code>shoppingcart</code> label applied to this revision:</p>
<pre><code class="language-bash">$ alembic history
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart) (head), add shopping cart table
1975ea83b712 -&gt; ae1027a6acf (head), add a column
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>With the label applied, the name <code>shoppingcart</code> now serves as an alias for the <code>27c6a30d7c24</code> revision specifically. We can illustrate this by showing it with <code>alembic show</code>:</p>
<pre><code class="language-bash">$ alembic show shoppingcart
Rev: 27c6a30d7c24 (head)
Parent: 1975ea83b712
Branch names: shoppingcart
Path: foo/versions/27c6a30d7c24_add_shopping_cart_table.py

    add shopping cart table

    Revision ID: 27c6a30d7c24
    Revises: 1975ea83b712
    Create Date: 2014-11-20 13:03:11.436407
</code></pre>
<p>However, when using branch labels, we usually want to use them using a syntax known as “branch at” syntax; this syntax allows us to state that we want to use a specific revision, let’s say a “head” revision, in terms of a specific branch. While normally, we can’t refer to <code>alembic upgrade head</code> when there’s multiple heads, we can refer to this head specifcally using <code>shoppingcart@head</code> syntax:</p>
<pre><code class="language-bash">$ alembic upgrade shoppingcart@head
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
</code></pre>
<p>The <code>shoppingcart@head</code> syntax becomes important to us if we wish to add new migration files to our versions directory while maintaining multiple branches. Just like the <code>upgrade</code> command, if we attempted to add a new revision file to our multiple-heads layout without a specific parent revision, we’d get a familiar error:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add a shopping cart column&quot;
  FAILED: Multiple heads are present; please specify the head revision on
  which the new revision should be based, or perform a merge.
</code></pre>
<p>The <code>alembic revision</code> command is pretty clear in what we need to do; to add our new revision specifically to the <code>shoppingcart</code> branch, we use the <code>--head</code> argument, either with the specific revision identifier <code>27c6a30d7c24</code>, or more generically using our branchname <code>shoppingcart@head</code>:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add a shopping cart column&quot;  --head shoppingcart@head
  Generating /path/to/foo/versions/d747a8a8879_add_a_shopping_cart_column.py ... done
</code></pre>
<p>alembic history shows both files now part of the <code>shoppingcart</code> branch:</p>
<pre><code class="language-bash">$ alembic history
1975ea83b712 -&gt; ae1027a6acf (head), add a column
27c6a30d7c24 -&gt; d747a8a8879 (shoppingcart) (head), add a shopping cart column
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart), add shopping cart table
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>We can limit our history operation just to this branch as well:</p>
<pre><code class="language-bash">$ alembic history -r shoppingcart:
27c6a30d7c24 -&gt; d747a8a8879 (shoppingcart) (head), add a shopping cart column
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart), add shopping cart table
</code></pre>
<p>If we want to illustrate the path of <code>shoppingcart</code> all the way from the base, we can do that as follows:</p>
<pre><code class="language-bash">$ alembic history -r :shoppingcart@head
27c6a30d7c24 -&gt; d747a8a8879 (shoppingcart) (head), add a shopping cart column
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart), add shopping cart table
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>We can run this operation from the “base” side as well, but we get a different result:</p>
<pre><code class="language-bash$ alembic history -r shoppingcart@base:">1975ea83b712 -&gt; ae1027a6acf (head), add a column
27c6a30d7c24 -&gt; d747a8a8879 (shoppingcart) (head), add a shopping cart column
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart), add shopping cart table
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>When we list from <code>shoppingcart@base</code> without an endpoint, it’s really shorthand for -r <code>shoppingcart@base</code>:heads, e.g. all heads, and since <code>shoppingcart@base</code> is the same “base” shared by the <code>ae1027a6acf</code> revision, we get that revision in our listing as well. The <code>&lt;branchname&gt;@base</code> syntax can be useful when we are dealing with individual bases, as we’ll see in the next section.</p>
<p>The <code>&lt;branchname&gt;@head</code> format can also be used with revision numbers instead of branch names, though this is less convenient. If we wanted to add a new revision to our branch that includes the un-labeled <code>ae1027a6acf</code>, if this weren’t a head already, we could ask for the “head of the branch that includes ae1027a6acf” as follows:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add another account column&quot; --head ae10@head
  Generating /path/to/foo/versions/55af2cb1c267_add_another_account_column.py ... done
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="more-label-syntaxes"><a class="header" href="#more-label-syntaxes">More Label Syntaxes</a></h1>
<p><strong>更多标注语法</strong></p>
<p>The <code>heads</code> symbol can be combined with a branch label, in the case that your labeled branch itself breaks off into multiple branches:</p>
<pre><code class="language-bash">alembic upgrade shoppingcart@heads
</code></pre>
<p>Relative identifiers, as introduced in <strong><a href="zh/../en/tutorial.html#relative-migrations">Relative Migration Identifiers</a></strong>, work with labels too. For example, upgrading to <code>shoppingcart@+2</code> means to upgrade from current heads on “shoppingcart” upwards two revisions:</p>
<pre><code class="language-bash">alembic upgrade shoppingcart@+2
</code></pre>
<p>This kind of thing works from history as well:</p>
<pre><code class="language-bash">alembic history -r current:shoppingcart@+2
</code></pre>
<p>The newer <code>relnum+delta</code> format can be combined as well, for example if we wanted to list along <code>shoppingcart</code> up until two revisions before the head:</p>
<pre><code class="language-bash">alembic history -r :shoppingcart@head-2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-multiple-bases"><a class="header" href="#working-with-multiple-bases">Working with Multiple Bases</a></h1>
<p><strong>基于多个base工作</strong></p>
<blockquote>
<p><strong>Note</strong>: The multiple base feature is intended to allow for multiple Alembic versioning lineages which share the same alembic_version table. This is so that individual revisions within the lineages can have cross-dependencies on each other. For the simpler case where one project has multiple, <strong>completely independent</strong> revision lineages that refer to <strong>separate</strong> alembic_version tables, see the example in <strong><a href="zh/../en/cookbook.html#multiple-environments">Run Multiple Alembic Environments from one .ini file</a></strong>.</p>
</blockquote>
<p>We’ve seen in the previous section that <code>alembic upgrade</code> is fine if we have multiple heads, <code>alembic revision</code> allows us to tell it which “head” we’d like to associate our new revision file with, and branch labels allow us to assign names to branches that we can use in subsequent commands. Let’s put all these together and refer to a new “base”, that is, a whole new tree of revision files that will be semi-independent of the account/shopping cart revisions we’ve been working with. This new tree will deal with database tables involving “networking”.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setting-up-multiple-version-directories"><a class="header" href="#setting-up-multiple-version-directories">Setting up Multiple Version Directories</a></h1>
<p><strong>设置多版本目录</strong></p>
<p>While optional, it is often the case that when working with multiple bases, we’d like different sets of version files to exist within their own directories; typically, if an application is organized into several sub-modules, each one would have a version directory containing migrations pertinent to that module. So to start out, we can edit <code>alembic.ini</code> to refer to multiple directories; we’ll also state the current <code>versions</code> directory as one of them:</p>
<pre><code class="language-python"># A separator for the location paths must be defined first.
version_path_separator = os  # Use os.pathsep.
# version location specification; this defaults
# to foo/versions.  When using multiple version
# directories, initial revisions must be specified with --version-path
version_locations = %(here)s/model/networking:%(here)s/alembic/versions
</code></pre>
<p>The new directory <code>%(here)s/model/networking</code> is in terms of where the <code>alembic.ini</code> file is, as we are using the symbol <code>%(here)s</code> which resolves to this location. When we create our first new revision targeted at this directory, <code>model/networking</code> will be created automatically if it does not exist yet. Once we’ve created a revision here, the path is used automatically when generating subsequent revision files that refer to this revision tree.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-labeled-base-revision"><a class="header" href="#creating-a-labeled-base-revision">Creating a Labeled Base Revision</a></h1>
<p><strong>创建带标注的基本修订</strong></p>
<p>We also want our new branch to have its own name, and for that we want to apply a branch label to the base. In order to achieve this using the <code>alembic revision</code> command without editing, we need to ensure our <code>script.py.mako</code> file, used for generating new revision files, has the appropriate substitutions present. If Alembic version 0.7.0 or greater was used to generate the original migration environment, this is already done. However when working with an older environment, <code>script.py.mako</code> needs to have this directive added, typically underneath the <code>down_revision</code> directive:</p>
<pre><code class="language-bash"># revision identifiers, used by Alembic.
revision = ${repr(up_revision)}
down_revision = ${repr(down_revision)}

# add this here in order to use revision with branch_label
branch_labels = ${repr(branch_labels)}
</code></pre>
<p>With this in place, we can create a new revision file, starting up a branch that will deal with database tables involving networking; we specify the <code>--head</code> version of <code>base</code>, a <code>--branch-label</code> of <code>networking</code>, and the directory we want this first revision file to be placed in with <code>--version-path</code>:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;create networking branch&quot; --head=base --branch-label=networking --version-path=model/networking
  Creating directory /path/to/foo/model/networking ... done
  Generating /path/to/foo/model/networking/3cac04ae8714_create_networking_branch.py ... done
</code></pre>
<p>If we ran the above command and we didn’t have the newer <code>script.py.mako</code> directive, we’d get this error:</p>
<pre><code class="language-bash">FAILED: Version 3cac04ae8714 specified branch_labels networking, however
the migration file foo/model/networking/3cac04ae8714_create_networking_branch.py
does not have them; have you upgraded your script.py.mako to include the 'branch_labels'
section?
</code></pre>
<p>When we receive the above error, and we would like to try again, we need to either <strong>delete</strong> the incorrectly generated file in order to run <code>revision</code> again, or we can edit the <code>3cac04ae8714_create_networking_branch.py</code> directly to add the <code>branch_labels</code> in of our choosing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running-with-multiple-bases"><a class="header" href="#running-with-multiple-bases">Running with Multiple Bases</a></h1>
<p><strong>基于多个base运行</strong></p>
<p>Once we have a new, permanent (for as long as we desire it to be) base in our system, we’ll always have multiple heads present:</p>
<pre><code class="language-bash">$ alembic heads
3cac04ae8714 (networking) (head)
27c6a30d7c24 (shoppingcart) (head)
ae1027a6acf (head)

</code></pre>
<p>When we want to add a new revision file to <code>networking</code>, we specify <code>networking@head</code> as the <code>--head</code>. The appropriate version directory is now selected automatically based on the head we choose:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add ip number table&quot; --head=networking@head
  Generating /path/to/foo/model/networking/109ec7d132bf_add_ip_number_table.py ... done
</code></pre>
<p>It’s important that we refer to the head using networking@head; if we only refer to <code>networking</code>, that refers to only <code>3cac04ae8714</code> specifically; if we specify this and it’s not a head, <code>alembic revision</code> will make sure we didn’t mean to specify the head:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add DNS table&quot; --head=networking
  FAILED: Revision 3cac04ae8714 is not a head revision; please
  specify --splice to create a new branch from this revision
</code></pre>
<p>As mentioned earlier, as this base is independent, we can view its history from the base using <code>history -r networking@base:</code>:</p>
<pre><code class="language-bash">$ alembic history -r networking@base:
109ec7d132bf -&gt; 29f859a13ea (networking) (head), add DNS table
3cac04ae8714 -&gt; 109ec7d132bf (networking), add ip number table
&lt;base&gt; -&gt; 3cac04ae8714 (networking), create networking branch
</code></pre>
<p>At the moment, this is the same output we’d get at this point if we used <code>-r :networking@head</code>. However, that will change later on as we use additional directives.</p>
<p>We may now run upgrades or downgrades freely, among individual branches (let’s assume a clean database again):</p>
<pre><code class="language-bash">$ alembic upgrade networking@head
INFO  [alembic.migration] Running upgrade  -&gt; 3cac04ae8714, create networking branch
INFO  [alembic.migration] Running upgrade 3cac04ae8714 -&gt; 109ec7d132bf, add ip number table
INFO  [alembic.migration] Running upgrade 109ec7d132bf -&gt; 29f859a13ea, add DNS table
</code></pre>
<p>or against the whole thing using <code>heads</code>:</p>
<pre><code class="language-bash">$ alembic upgrade heads
INFO  [alembic.migration] Running upgrade  -&gt; 1975ea83b712, create account table
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; 27c6a30d7c24, add shopping cart table
INFO  [alembic.migration] Running upgrade 27c6a30d7c24 -&gt; d747a8a8879, add a shopping cart column
INFO  [alembic.migration] Running upgrade 1975ea83b712 -&gt; ae1027a6acf, add a column
INFO  [alembic.migration] Running upgrade ae1027a6acf -&gt; 55af2cb1c267, add another account column
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="branch-dependencies"><a class="header" href="#branch-dependencies">Branch Dependencies</a></h1>
<p>When working with multiple roots, it is expected that these different revision streams will need to refer to one another. For example, a new revision in <code>networking</code> which needs to refer to the <code>account</code> table will want to establish 55af2cb1c267, add another <code>account</code> column, the last revision that works with the <code>account</code> table, as a dependency. From a graph perspective, this means nothing more that the new file will feature both 55af2cb1c267, add another <code>account</code> column and <code>29f859a13ea, add DNS table</code> as “down” revisions, and looks just as though we had merged these two branches together. However, we don’t want to consider these as “merged”; we want the two revision streams to remain independent, even though a version in <code>networking</code> is going to reach over into the other stream. To support this use case, Alembic provides a directive known as <code>depends_on</code>, which allows a revision file to refer to another as a “dependency”, very similar to an entry in <code>down_revision</code> from a graph perspective, but different from a semantic perspective.</p>
<p>To use <code>depends_on</code>, we can specify it as part of our <code>alembic revision</code> command:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add ip account table&quot; --head=networking@head  --depends-on=55af2cb1c267
  Generating /path/to/foo/model/networking/2a95102259be_add_ip_account_table.py ... done
</code></pre>
<p>Within our migration file, we’ll see this new directive present:</p>
<pre><code class="language-python"># revision identifiers, used by Alembic.
revision = '2a95102259be'
down_revision = '29f859a13ea'
branch_labels = None
depends_on='55af2cb1c267'
</code></pre>
<p><code>depends_on</code> may be either a real revision number or a branch name. When specified at the command line, a resolution from a partial revision number will work as well. It can refer to any number of dependent revisions as well; for example, if we were to run the command:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;add ip account table&quot; \\
    --head=networking@head  \\
    --depends-on=55af2cb1c267 --depends-on=d747a --depends-on=fa445
  Generating /path/to/foo/model/networking/2a95102259be_add_ip_account_table.py ... done
</code></pre>
<p>We’d see inside the file:</p>
<pre><code class="language-python"># revision identifiers, used by Alembic.
revision = '2a95102259be'
down_revision = '29f859a13ea'
branch_labels = None
depends_on = ('55af2cb1c267', 'd747a8a8879', 'fa4456a9201')
</code></pre>
<p>We also can of course add or alter this value within the file manually after it is generated, rather than using the <code>--depends-on</code> argument.</p>
<p>We can see the effect this directive has when we view the history of the <code>networking</code> branch in terms of “heads”, e.g., all the revisions that are descendants:</p>
<pre><code class="language-bash">$ alembic history -r :networking@head
29f859a13ea (55af2cb1c267) -&gt; 2a95102259be (networking) (head), add ip account table
109ec7d132bf -&gt; 29f859a13ea (networking), add DNS table
3cac04ae8714 -&gt; 109ec7d132bf (networking), add ip number table
&lt;base&gt; -&gt; 3cac04ae8714 (networking), create networking branch
ae1027a6acf -&gt; 55af2cb1c267 (effective head), add another account column
1975ea83b712 -&gt; ae1027a6acf, Add a column
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table
</code></pre>
<p>What we see is that the full history of the <code>networking</code> branch, in terms of an “upgrade” to the “head”, will include that the tree building up <code>55af2cb1c267, add another account column</code> will be pulled in first. Interstingly, we don’t see this displayed when we display history in the other direction, e.g. from <code>networking@base</code>:</p>
<pre><code class="language-bash">$ alembic history -r networking@base:
29f859a13ea (55af2cb1c267) -&gt; 2a95102259be (networking) (head), add ip account table
109ec7d132bf -&gt; 29f859a13ea (networking), add DNS table
3cac04ae8714 -&gt; 109ec7d132bf (networking), add ip number table
&lt;base&gt; -&gt; 3cac04ae8714 (networking), create networking branch
</code></pre>
<p>The reason for the discrepancy is that displaying history from the base shows us what would occur if we ran a downgrade operation, instead of an upgrade. If we downgraded all the files in <code>networking</code> using <code>networking@base</code>, the dependencies aren’t affected, they’re left in place.</p>
<p>We also see something odd if we view <code>heads</code> at the moment:</p>
<pre><code class="language-bash">$ alembic heads
2a95102259be (networking) (head)
27c6a30d7c24 (shoppingcart) (head)
55af2cb1c267 (effective head)
</code></pre>
<p>The head file that we used as a “dependency”, <code>55af2cb1c267</code>, is displayed as an “effective” head, which we can see also in the history display earlier. What this means is that at the moment, if we were to upgrade all versions to the top, the <code>55af2cb1c267</code> revision number would not actually be present in the <code>alembic_version</code> table; this is because it does not have a branch of its own subsequent to the <code>2a95102259be</code> revision which depends on it:</p>
<pre><code class="language-bash">$ alembic upgrade heads
INFO  [alembic.migration] Running upgrade 29f859a13ea, 55af2cb1c267 -&gt; 2a95102259be, add ip account table

$ alembic current
2a95102259be (head)
27c6a30d7c24 (head)
</code></pre>
<p>The entry is still displayed in <code>alembic heads</code> because Alembic knows that even though this revision isn’t a “real” head, it’s still something that we developers consider semantically to be a head, so it’s displayed, noting its special status so that we don’t get quite as confused when we don’t see it within <code>alembic current</code>.</p>
<p>If we add a new revision onto <code>55af2cb1c267</code>, the branch again becomes a “real” branch which can have its own entry in the database:</p>
<pre><code class="language-bash">$ alembic revision -m &quot;more account changes&quot; --head=55af2cb@head
  Generating /path/to/foo/versions/34e094ad6ef1_more_account_changes.py ... done

$ alembic upgrade heads
INFO  [alembic.migration] Running upgrade 55af2cb1c267 -&gt; 34e094ad6ef1, more account changes

$ alembic current
2a95102259be (head)
27c6a30d7c24 (head)
34e094ad6ef1 (head)
</code></pre>
<p>For posterity, the revision tree now looks like:</p>
<pre><code class="language-bash">$ alembic history
29f859a13ea (55af2cb1c267) -&gt; 2a95102259be (networking) (head), add ip account table
109ec7d132bf -&gt; 29f859a13ea (networking), add DNS table
3cac04ae8714 -&gt; 109ec7d132bf (networking), add ip number table
&lt;base&gt; -&gt; 3cac04ae8714 (networking), create networking branch
1975ea83b712 -&gt; 27c6a30d7c24 (shoppingcart) (head), add shopping cart table
55af2cb1c267 -&gt; 34e094ad6ef1 (head), more account changes
ae1027a6acf -&gt; 55af2cb1c267, add another account column
1975ea83b712 -&gt; ae1027a6acf, Add a column
&lt;base&gt; -&gt; 1975ea83b712 (branchpoint), create account table


                    --- 27c6 --&gt; d747 --&gt; &lt;head&gt;
                   /   (shoppingcart)
&lt;base&gt; --&gt; 1975 --&gt;
                   \
                     --- ae10 --&gt; 55af --&gt; &lt;head&gt;
                                    ^
                                    +--------+ (dependency)
                                             |
                                             |
&lt;base&gt; --&gt; 3782 -----&gt; 109e ----&gt; 29f8 ---&gt; 2a95 --&gt; &lt;head&gt;
         (networking)
</code></pre>
<p>If there’s any point to be made here, it’s if you are too freely branching, merging and labeling, things can get pretty crazy! Hence the branching system should be used carefully and thoughtfully for best results.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operation-reference"><a class="header" href="#operation-reference">Operation Reference</a></h1>
<p><strong>操作参考</strong></p>
<p>This file provides documentation on Alembic migration directives.</p>
<p>The directives here are used within user-defined migration files, within the <code>upgrade()</code> and <code>downgrade()</code> functions, as well as any functions further invoked by those.</p>
<p>All directives exist as methods on a class called <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong>. When migration scripts are run, this object is made available to the script via the <code>alembic.op</code> datamember, which is a proxy to an actual instance of <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong>. Currently, <code>alembic.op</code> is a real Python module, populated with individual proxies for each method on <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong>, so symbols can be imported safely from the <code>alembic.op</code> namespace.</p>
<p>The <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> system is also fully extensible. See <strong><a href="zh/../en/api/operations.html#operation-plugins">Operation Plugins</a></strong> for details on this.</p>
<p>A key design philosophy to the <strong><a href="zh/../en/api/operations.html#alembic-operations-toplevel">Operation Directives</a></strong> methods is that to the greatest degree possible, they internally generate the appropriate SQLAlchemy metadata, typically involving <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Constraint">Constraint</a></strong> objects. This so that migration instructions can be given in terms of just the string names and/or flags involved. The exceptions to this rule include the <strong><a href="zh/06_operation_reference.html#alembic.operations.Operations.add_column">add_column()</a></strong> and <strong><a href="zh/06_operation_reference.html#alembic.operations.Operations.create_table">create_table()</a></strong> directives, which require full <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> objects, though the table metadata is still generated here.</p>
<p>The functions here all require that a <strong><a href="zh/../en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext</a></strong> has been configured within the <code>env.py</code> script first, which is typically via <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">EnvironmentContext.configure()</a></strong>. Under normal circumstances they are called from an actual migration script, which itself would be invoked by the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.run_migrations">EnvironmentContext.run_migrations()</a></strong> method.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alembicoperationsoperations"><a class="header" href="#alembicoperationsoperations">alembic.operations.Operations</a></h1>
<p><em>class</em> alembic.operations.<strong>Operations</strong>(<em>migration_context</em>: MigrationContext, <em>impl</em>: Optional[BatchOperationsImpl] = None)</p>
<p>Define high level migration operations.</p>
<p>Each operation corresponds to some schema migration operation, executed against a particular <strong><a href="zh/../en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext</a></strong> which in turn represents connectivity to a database, or a file output stream.</p>
<p>While <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> is normally configured as part of the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.run_migrations">EnvironmentContext.run_migrations()</a></strong> method called from an <code>env.py</code> script, a standalone <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> instance can be made for use cases external to regular Alembic migrations by passing in a MigrationContext:</p>
<pre><code class="language-python">from alembic.migration import MigrationContext
from alembic.operations import Operations

conn = myengine.connect()
ctx = MigrationContext.configure(conn)
op = Operations(ctx)

op.alter_column(&quot;t&quot;, &quot;c&quot;, nullable=True)
</code></pre>
<blockquote>
<p><strong>Note</strong> that as of 0.8, most of the methods on this class are produced dynamically using the <strong><a href="zh/../zh/06_01_25_register_operation.html">Operations.register_operation()</a></strong> method.</p>
</blockquote>
<p>Construct a new Operations</p>
<p><em>migration_context</em> – a <strong><a href="zh/../en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext</a></strong> instance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add_column"><a class="header" href="#add_column">add_column</a></h1>
<p><strong>add_column</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>column</em>:  Column, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Issue an “add column” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op
from sqlalchemy import Column, String

op.add_column('organization',
    Column('name', String())
)
</code></pre>
<p>The provided <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> object can also specify a <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.ForeignKey">ForeignKey</a></strong>, referencing a remote table name. Alembic will automatically generate a stub “referenced” table and emit a second ALTER statement in order to add the constraint separately:</p>
<pre><code class="language-python">from alembic import op
from sqlalchemy import Column, INTEGER, ForeignKey

op.add_column('organization',
    Column('account_id', INTEGER, ForeignKey('accounts.id'))
)
</code></pre>
<blockquote>
<p><strong>Note</strong> that this statement uses the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> construct as is from the SQLAlchemy library. In particular, <code>default</code> values to be created on the database side are specified using the <code>server_default</code> parameter, and not <code>default</code> which only specifies Python-side defaults:</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – String name of the parent table.</li>
<li><em><strong>column</strong></em> – a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">sqlalchemy.schema.Column</a></strong> object representing the new column.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alter_column"><a class="header" href="#alter_column">alter_column</a></h1>
<p><strong>alter_column</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>column_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>nullable</em>:  Optional[<a href="https://docs.python.org/3/library/functions.html#bool">bool</a>] = None, <em>comment</em>:  Optional[Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a href="https://docs.python.org/3/library/functions.html#bool">bool</a>]] = False, <em>server_default</em>:  Any = False, <em>new_column_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>type_</em>:  Optional[Union[TypeEngine, Type[TypeEngine]]] = None, <em>existing_type</em>:  Optional[Union[TypeEngine, Type[TypeEngine]]] = None, <em>existing_server_default</em>:  Optional[Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a href="https://docs.python.org/3/library/functions.html#bool">bool</a>, Identity, Computed]] = False, <em>existing_nullable</em>:  Optional[<a href="https://docs.python.org/3/library/functions.html#bool">bool</a>] = None, <em>existing_comment</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw) → Optional[Table]</p>
<p>Issue an “alter column” instruction using the current migration context.</p>
<p>Generally, only that aspect of the column which is being changed, i.e. name, type, nullability, default, needs to be specified. Multiple changes can also be specified at once and the backend should “do the right thing”, emitting each change either separately or together as the backend allows.</p>
<p>MySQL has special requirements here, since MySQL cannot ALTER a column without a full specification. When producing MySQL-compatible migration files, it is recommended that the <code>existing_type</code>, <code>existing_server_default</code>, and <code>existing_nullable</code> parameters be present, if not being altered.</p>
<p>Type changes which are against the SQLAlchemy “schema” types <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Enum">Enum</a></strong> may also add or drop constraints which accompany those types on backends that don’t support them natively. The <code>existing_type</code> argument is used in this case to identify and remove a previous constraint that was bound to the type object.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – string name of the target table.</li>
<li><em><strong>column_name</strong></em> – string name of the target column, as it exists before the operation begins.</li>
<li><em><strong>nullable</strong></em> – Optional; specify <code>True</code> or <code>False</code> to alter the column’s nullability.</li>
<li><em><strong>server_default</strong></em> – Optional; specify a string SQL expression, <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">text()</a></strong>, or <strong><a href="https://docs.sqlalchemy.org/en/14/core/defaults.html#sqlalchemy.schema.DefaultClause">DefaultClause</a></strong> to indicate an alteration to the column’s default value. Set to <code>None</code> to have the default removed.</li>
<li><em><strong>comment</strong></em><a name="params.comment"></a> – optional string text of a new comment to add to the column.
<ul>
<li><em>New in version 1.0.6.</em></li>
</ul>
</li>
<li><em><strong>new_column_name</strong></em> – Optional; specify a string name here to indicate the new name within a column rename operation.</li>
<li><em><strong>type_</strong></em> – Optional; a <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_api.html#sqlalchemy.types.TypeEngine">TypeEngine</a></strong> type object to specify a change to the column’s type. For SQLAlchemy types that also indicate a constraint (i.e. <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong>, Enum), the constraint is also generated.</li>
<li><em><strong>autoincrement</strong></em> – set the <code>AUTO_INCREMENT</code> flag of the column; currently understood by the MySQL dialect.</li>
<li><em><strong>existing_type</strong></em> – Optional; a <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_api.html#sqlalchemy.types.TypeEngine">TypeEngine</a></strong> type object to specify the previous type. This is required for all MySQL column alter operations that don’t otherwise specify a new type, as well as for when nullability is being changed on a SQL Server column. It is also used if the type is a so-called SQLlchemy “schema” type which may define a constraint (i.e. <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_basics.html#sqlalchemy.types.Boolean">Boolean</a></strong>, Enum), so that the constraint can be dropped.</li>
<li><em><strong>existing_server_default</strong></em> – Optional; The existing default value of the column. Required on MySQL if an existing default is not being changed; else MySQL removes the default.</li>
<li><em><strong>existing_nullable</strong></em> – Optional; the existing nullability of the column. Required on MySQL if the existing nullability is not being changed; else MySQL sets this to NULL.</li>
<li><em><strong>existing_autoincrement</strong></em> – Optional; the existing autoincrement of the column. Used for MySQL’s system of altering a column that specifies <code>AUTO_INCREMENT</code>.</li>
<li><em><strong>existing_comment</strong></em> – string text of the existing comment on the column to be maintained. Required on MySQL if the existing comment on the column is not being changed.
<ul>
<li><em>New in version 1.0.6.</em></li>
</ul>
</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li><em><strong>postgresql_using</strong></em> – String argument which will indicate a SQL expression to render within the Postgresql-specific USING clause within ALTER COLUMN. This string is taken directly as raw SQL which must explicitly include any necessary quoting or escaping of tokens within the expression.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch_alter_table"><a class="header" href="#batch_alter_table">batch_alter_table</a></h1>
<p><strong>batch_alter_table</strong>(table_name, schema=None, recreate='auto', partial_reordering=None, copy_from=None, table_args=(), table_kwargs={}, reflect_args=(), reflect_kwargs={}, naming_convention=None)</p>
<p>Invoke a series of per-table migrations in batch.</p>
<p>Batch mode allows a series of operations specific to a table to be syntactically grouped together, and allows for alternate modes of table migration, in particular the “recreate” style of migration required by SQLite.</p>
<p>“recreate” style is as follows:</p>
<ol>
<li>A new table is created with the new specification, based on the migration directives within the batch, using a temporary name.</li>
<li>the data copied from the existing table to the new table.</li>
<li>the existing table is dropped.</li>
<li>the new table is renamed to the existing table name.</li>
</ol>
<p>The directive by default will only use “recreate” style on the SQLite backend, and only if directives are present which require this form, e.g. anything other than <code>add_column()</code>. The batch operation on other backends will proceed using standard ALTER TABLE operations.</p>
<p>The method is used as a context manager, which returns an instance of BatchOperations; this object is the same as <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> except that table names and schema names are omitted. E.g.:</p>
<pre><code class="language-python">with op.batch_alter_table(&quot;some_table&quot;) as batch_op:
    batch_op.add_column(Column('foo', Integer))
    batch_op.drop_column('bar')
</code></pre>
<p>The operations within the context manager are invoked at once when the context is ended. When run against SQLite, if the migrations include operations not supported by SQLite’s ALTER TABLE, the entire table will be copied to a new one with the new specification, moving all data across as well.</p>
<p>The copy operation by default uses reflection to retrieve the current structure of the table, and therefore <strong><a href="zh/../zh/06_01_03_batch_alter_table.html">batch_alter_table()</a></strong> in this mode requires that the migration is run in “online” mode. The <code>copy_from</code> parameter may be passed which refers to an existing <code>Table</code> object, which will bypass this reflection step.</p>
<blockquote>
<p><strong>Note</strong> The table copy operation will currently not copy CHECK constraints, and may not copy UNIQUE constraints that are unnamed, as is possible on SQLite. See the section <strong><a href="zh/../en/batch.html#sqlite-batch-constraints">Dealing with Constraints</a></strong> for workarounds.</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><em><strong>table_name</strong></em> – name of table</p>
</li>
<li>
<p><em><strong>schema</strong></em> – optional <strong>schema</strong> name.</p>
</li>
<li>
<p><em><strong>recreate</strong></em> – under what circumstances the table should be recreated. At its default of <code>&quot;auto&quot;</code>, the SQLite dialect will <strong>recreate</strong> the table if any operations other than <code>add_column()</code>, <code>create_index()</code>, or <code>drop_index()</code> are present. Other options include <code>&quot;always&quot;</code> and <code>&quot;never&quot;</code>.</p>
</li>
<li>
<p><em>copy_from</em> – optional <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object that will act as the structure of the table being copied. If omitted, table reflection is used to retrieve the structure of the table.</p>
<p><strong>See also</strong> <em><a href="zh/../zh/04_03_working_in_offline_mode.html">Working in Offline Mode</a></em></p>
<p><em><strong>reflect_args</strong></em></p>
<p><em><strong>reflect_kwargs</strong></em></p>
</li>
<li>
<p><em><strong>reflect_args</strong></em> – a sequence of additional positional arguments that will be applied to the table structure being reflected / copied; this may be used to pass column and constraint overrides to the table that will be reflected, in lieu of passing the whole <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> using <strong><a href="zh/06_01_03_batch_alter_table.html#alembic.operations.Operations.batch_alter_table.params.copy_from">copy_from</a></strong>.</p>
</li>
<li>
<p><em><strong>reflect_kwargs</strong></em> – a dictionary of additional keyword arguments that will be applied to the table structure being copied; this may be used to pass additional table and reflection options to the table that will be reflected, in lieu of passing the whole <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> using <strong><a href="zh/06_01_03_batch_alter_table.html#alembic.operations.Operations.batch_alter_table.params.copy_from">copy_from</a></strong>.</p>
</li>
<li>
<p><em><strong>table_args</strong></em> – a sequence of additional positional arguments that will be applied to the new <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> when created, in addition to those copied from the source table. This may be used to provide additional constraints such as CHECK constraints that may not be reflected.</p>
</li>
<li>
<p><em><strong>table_args</strong></em> – a sequence of additional positional arguments that will be applied to the new <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> when created, in addition to those copied from the source table. This may be used to provide additional constraints such as CHECK constraints that may not be reflected.</p>
</li>
<li>
<p><em><strong>table_kwargs</strong></em> – a dictionary of additional keyword arguments that will be applied to the new <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> when created, in addition to those copied from the source table. This may be used to provide for additional table options that may not be reflected.</p>
</li>
<li>
<p><em><strong>naming_convention</strong></em> – a naming convention dictionary of the form described at <strong><a href="zh/../en/naming.html#autogen-naming-conventions">Integration of Naming Conventions into Operations, Autogenerate</a></strong> which will be applied to the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData">MetaData</a></strong> during the reflection process. This is typically required if one wants to drop SQLite constraints, as these constraints will not have names when reflected on this backend. Requires SQLAlchemy <strong>0.9.4</strong> or greater.</p>
<blockquote>
<p>See also</p>
<p><a href="zh/../en/batch.html#dropping-sqlite-foreign-keys">Dropping Unnamed or Named Foreign Key Constraints</a></p>
</blockquote>
</li>
<li>
<p><em><strong>partial_reordering</strong></em> – a list of tuples, each suggesting a desired ordering of two or more columns in the newly created table. Requires that <strong><a href="zh/06_01_03_batch_alter_table.html#alembic.operations.Operations.batch_alter_table.params.recreate">batch_alter_table.recreate</a></strong> is set to <code>&quot;always&quot;</code>. Examples, given a table with columns “a”, “b”, “c”, and “d”:</p>
<p>Specify the order of all columns:</p>
<pre><code class="language-python">with op.batch_alter_table(
        &quot;some_table&quot;, recreate=&quot;always&quot;,
        partial_reordering=[(&quot;c&quot;, &quot;d&quot;, &quot;a&quot;, &quot;b&quot;)]
) as batch_op:
    pass
</code></pre>
<p>Ensure “d” appears before “c”, and “b”, appears before “a”:</p>
<pre><code class="language-python">with op.batch_alter_table(
        &quot;some_table&quot;, recreate=&quot;always&quot;,
        partial_reordering=[(&quot;d&quot;, &quot;c&quot;), (&quot;b&quot;, &quot;a&quot;)]
) as batch_op:
    pass
</code></pre>
<p>The ordering of columns not included in the partial_reordering set is undefined. Therefore it is best to specify the complete ordering of all columns for best results.</p>
<p><em>New in version 1.4.0.</em></p>
</li>
</ul>
<blockquote>
<p><strong>Note:</strong> batch mode requires SQLAlchemy 0.8 or above.</p>
</blockquote>
<blockquote>
<p><strong>See also</strong> <a href="zh/../en/batch.html#batch-migrations">Running “Batch” Migrations for SQLite and Other Databases</a></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bulk_insert"><a class="header" href="#bulk_insert">bulk_insert</a></h1>
<p><strong>bulk_insert</strong>(<em>table</em>:  Union[Table, TableClause], <em>rows</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>], <em>multiinsert</em>:  <a href="https://docs.python.org/3/library/functions.html#bool">bool</a> = True) → None</p>
<p>Issue a “bulk insert” operation using the current migration context.</p>
<p>This provides a means of representing an INSERT of multiple rows which works equally well in the context of executing on a live connection as well as that of generating a SQL script. In the case of a SQL script, the values are rendered inline into the statement.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op
from datetime import date
from sqlalchemy.sql import table, column
from sqlalchemy import String, Integer, Date

# Create an ad-hoc table to use for the insert statement.
accounts_table = table('account',
    column('id', Integer),
    column('name', String),
    column('create_date', Date)
)

op.bulk_insert(accounts_table,
    [
        {'id':1, 'name':'John Smith',
                'create_date':date(2010, 10, 5)},
        {'id':2, 'name':'Ed Williams',
                'create_date':date(2007, 5, 27)},
        {'id':3, 'name':'Wendy Jones',
                'create_date':date(2008, 8, 15)},
    ]
)
</code></pre>
<p>When using –sql mode, some datatypes may not render inline automatically, such as dates and other special types. When this issue is present, <strong><a href="zh/../zh/06_01_23_inline_literal.html">Operations.inline_literal()</a></strong> may be used:</p>
<pre><code class="language-python">op.bulk_insert(accounts_table,
    [
        {'id':1, 'name':'John Smith',
                'create_date':op.inline_literal(&quot;2010-10-05&quot;)},
        {'id':2, 'name':'Ed Williams',
                'create_date':op.inline_literal(&quot;2007-05-27&quot;)},
        {'id':3, 'name':'Wendy Jones',
                'create_date':op.inline_literal(&quot;2008-08-15&quot;)},
    ],
    multiinsert=False
)
</code></pre>
<p>When using <strong><a href="zh/../zh/06_01_23_inline_literal.html">Operations.inline_literal()</a></strong> in conjunction with <strong><a href="zh/../zh/06_01_04_bulk_insert.html">Operations.bulk_insert()</a></strong>, in order for the statement to work in “online” (e.g. non –sql) mode, the <strong><a href="zh/../zh/06_01_04_bulk_insert.html#params.multiinsert">multiinsert</a></strong> flag should be set to <code>False</code>, which will have the effect of individual INSERT statements being emitted to the database, each with a distinct VALUES clause, so that the “inline” values can still be rendered, rather than attempting to pass the values as bound parameters.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table</strong></em> – a <strong>table</strong> object which represents the target of the INSERT.</li>
<li><em><strong>rows</strong></em> – a list of dictionaries indicating rows.</li>
<li><em><strong>multiinsert</strong></em> – when at its default of True and –sql mode is not enabled, the INSERT statement will be executed using “executemany()” style, where all elements in the list of dictionaries are passed as bound parameters in a single list. Setting this to False results in individual INSERT statements being emitted per parameter set, and is needed in those cases where non-literal values are present in the parameter sets.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_check_constraint"><a class="header" href="#create_check_constraint">create_check_constraint</a></h1>
<p><strong>create_check_constraint</strong>(<em>constraint_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>condition</em>:  Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, BinaryExpression], <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw) → Optional[Table]</p>
<p>Issue a “create check constraint” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op
from sqlalchemy.sql import column, func

op.create_check_constraint(
    &quot;ck_user_name_len&quot;,
    &quot;user&quot;,
    func.len(column('name')) &gt; 5
)
</code></pre>
<p>CHECK constraints are usually against a SQL expression, so ad-hoc table metadata is usually needed. The function will convert the given arguments into a <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.CheckConstraint">sqlalchemy.schema.CheckConstraint</a></strong> bound to an anonymous table in order to emit the CREATE statement.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>name</strong></em> – Name of the check constraint. The <code>name</code> is necessary so that an ALTER statement can be emitted. For setups that use an automated naming scheme such as that described at <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#constraint-naming-conventions">Configuring Constraint Naming Conventions</a></strong>, <code>name</code> here can be <code>None</code>, as the event listener will apply the <code>name</code> to the constraint object when it is associated with the table.</li>
<li><em><strong>table_name</strong></em> – String name of the source table.</li>
<li><em><strong>condition</strong></em> – SQL expression that’s the <strong>condition</strong> of the constraint. Can be a string or SQLAlchemy expression language structure.</li>
<li><em><strong>deferrable</strong></em> – optional bool. If set, emit DEFERRABLE or NOT DEFERRABLE when issuing DDL for this constraint.</li>
<li><em><strong>initially</strong></em> – optional string. If set, emit INITIALLY <value> when issuing DDL for this constraint.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_exclude_constraint"><a class="header" href="#create_exclude_constraint">create_exclude_constraint</a></h1>
<p><strong>create_exclude_constraint</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, *elements: Any, **kw: Any) → Optional[Table]</p>
<p>Issue an alter to create an EXCLUDE constraint using the current migration context.</p>
<blockquote>
<p><strong>Note:</strong> This method is Postgresql specific, and additionally requires at least SQLAlchemy 1.0.</p>
</blockquote>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op

op.create_exclude_constraint(
    &quot;user_excl&quot;,
    &quot;user&quot;,

    (&quot;period&quot;, '&amp;&amp;'),
    (&quot;group&quot;, '='),
    where=(&quot;group != 'some group'&quot;)

)
</code></pre>
<blockquote>
<p><strong>Note</strong> that the expressions work the same way as that of the <code>ExcludeConstraint</code> object itself; if plain strings are passed, quoting rules must be applied manually.</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>name</strong></em> – Name of the constraint.</li>
<li><em><strong>table_name</strong></em> – String name of the source table.</li>
<li><em><strong>elements</strong></em> – exclude conditions.</li>
<li><em><strong>where</strong></em> – SQL expression or SQL string with optional WHERE clause.</li>
<li><em><strong>deferrable</strong></em> – optional bool. If set, emit DEFERRABLE or NOT DEFERRABLE when issuing DDL for this constraint.</li>
<li><em><strong>initially</strong></em> – optional string. If set, emit INITIALLY <value> when issuing DDL for this constraint.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_foreign_key"><a class="header" href="#create_foreign_key">create_foreign_key</a></h1>
<p><strong>create_foreign_key</strong>(<em>constraint_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>source_table</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>referent_table</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>local_cols</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>remote_cols</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>onupdate</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>ondelete</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>deferrable</em>:  Optional[<a href="https://docs.python.org/3/library/functions.html#bool">bool</a>] = None, <em>initially</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>match</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>source_schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>referent_schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **dialect_kw) → Optional[Table]</p>
<p>Issue a “create foreign key” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op
op.create_foreign_key(
            &quot;fk_user_address&quot;, &quot;address&quot;,
            &quot;user&quot;, [&quot;user_id&quot;], [&quot;id&quot;])
</code></pre>
<p>This internally generates a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object containing the necessary columns, then generates a new <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.ForeignKeyConstraint">ForeignKeyConstraint</a></strong> object which it then associates with the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong>. Any event listeners associated with this action will be fired off normally. The <strong><a href="https://docs.sqlalchemy.org/en/14/core/ddl.html#sqlalchemy.schema.AddConstraint">AddConstraint</a></strong> construct is ultimately used to generate the ALTER statement.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>constraint_name</strong></em> – Name of the foreign key constraint. The <code>name</code> is necessary so that an ALTER statement can be emitted. For setups that use an automated naming scheme such as that described at <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#constraint-naming-conventions">Configuring Constraint Naming Conventions</a></strong>, <code>name</code> here can be <code>None</code>, as the event listener will apply the <code>name</code> to the constraint object when it is associated with the table.</li>
<li><em><strong>source_table</strong></em> – String name of the source table.</li>
<li><em><strong>referent_table</strong></em> – String name of the destination table.</li>
<li><em><strong>local_cols</strong></em> – a list of string column names in the source table.</li>
<li><em><strong>remote_cols</strong></em> – a list of string column names in the remote table.</li>
<li><em><strong>onupdate</strong></em> – Optional string. If set, emit ON UPDATE <code>&lt;value&gt;</code> when issuing DDL for this constraint. Typical values include CASCADE, DELETE and RESTRICT.</li>
<li><em><strong>ondelete</strong></em> – Optional string. If set, emit ON DELETE <code>&lt;value&gt;</code> when issuing DDL for this constraint. Typical values include CASCADE, DELETE and RESTRICT.</li>
<li><em><strong>deferrable</strong></em> – optional bool. If set, emit DEFERRABLE or NOT DEFERRABLE when issuing DDL for this constraint.</li>
<li><em><strong>source_schema</strong></em> – Optional schema name of the source table.</li>
<li><em><strong>referent_schema</strong></em> – Optional schema name of the destination table.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_index"><a class="header" href="#create_index">create_index</a></h1>
<p><strong>create_index</strong>(<em>index_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  Sequence[Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, TextClause, Function]], <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>unique</em>:  <a href="https://docs.python.org/3/library/functions.html#bool">bool</a> = False, **kw) → Optional[Table]</p>
<p>Issue a “create index” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op

op.create_index('ik_test', 't1', ['foo', 'bar'])
</code></pre>
<p>Functional indexes can be produced by using the <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">sqlalchemy.sql.expression.text()</a></strong> construct:</p>
<pre><code class="language-python">from alembic import op
from sqlalchemy import text

op.create_index('ik_test', 't1', [text('lower(foo)')])
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>index_name</strong></em> – name of the index.</li>
<li><em><strong>table_name</strong></em> – name of the owning table.</li>
<li><em><strong>columns</strong></em> – a list consisting of string column names and/or <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">text()</a></strong> constructs.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li><em><strong>unique</strong></em> – If True, create a <strong>unique</strong> index.</li>
<li><em><strong>quote</strong></em> – Force quoting of this column’s name on or off, corresponding to <code>True</code> or <code>False</code>. When left at its default of <code>None</code>, the column identifier will be quoted according to whether the name is case sensitive (identifiers with at least one upper case character are treated as case sensitive), or if it’s a reserved word. This flag is only needed to force quoting of a reserved word which is not known by the SQLAlchemy dialect.</li>
<li><em><strong>**kw</strong></em> – Additional keyword arguments not mentioned above are dialect specific, and passed in the form <code>&lt;dialectname&gt;_&lt;argname&gt;</code>. See the documentation regarding an individual dialect at <strong><a href="https://docs.sqlalchemy.org/en/14/dialects/index.html#dialect-toplevel">Dialects</a></strong> for detail on documented arguments.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_primary_key"><a class="header" href="#create_primary_key">create_primary_key</a></h1>
<p><strong>create_primary_key</strong>(<em>constraint_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Issue a “create primary key” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op

op.create_primary_key(
            &quot;pk_my_table&quot;, &quot;my_table&quot;,
            [&quot;id&quot;, &quot;version&quot;]
        )
</code></pre>
<p>This internally generates a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object containing the necessary columns, then generates a new <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.PrimaryKeyConstraint">PrimaryKeyConstraint</a></strong> object which it then associates with the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong>. Any event listeners associated with this action will be fired off normally. The <strong><a href="https://docs.sqlalchemy.org/en/14/core/ddl.html#sqlalchemy.schema.AddConstraint">AddConstraint</a></strong> construct is ultimately used to generate the ALTER statement.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>constraint_name</strong></em> – Name of the primary key constraint. The <code>name</code> is necessary so that an ALTER statement can be emitted. For setups that use an automated naming scheme such as that described at <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#constraint-naming-conventions">Configuring Constraint Naming Conventions</a></strong> <code>name</code> here can be <code>None</code>, as the event listener will apply the <code>name</code> to the constraint object when it is associated with the table.</li>
<li><em><strong>table_name</strong></em> – String name of the target table.</li>
<li><em><strong>columns</strong></em> – a list of string column names to be applied to the primary key constraint.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_table"><a class="header" href="#create_table">create_table</a></h1>
<p><strong>create_table</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, *columns, **kw) → Optional[Table]</p>
<p>Issue a “create table” instruction using the current migration context.</p>
<p>This directive receives an argument list similar to that of the traditional <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">sqlalchemy.schema.Table</a></strong> construct, but without the metadata:</p>
<pre><code class="language-python">from sqlalchemy import INTEGER, VARCHAR, NVARCHAR, Column
from alembic import op

op.create_table(
    'account',
    Column('id', INTEGER, primary_key=True),
    Column('name', VARCHAR(50), nullable=False),
    Column('description', NVARCHAR(200)),
    Column('timestamp', TIMESTAMP, server_default=func.now())
)
</code></pre>
<blockquote>
<p><strong>Note:</strong> that <strong><a href="zh/../zh/06_01_10_create_table.html">create_table()</a></strong> accepts <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> constructs directly from the SQLAlchemy library. In particular, <code>default</code> values to be created on the database side are specified using the <code>server_default</code> parameter, and not <code>default</code> which only specifies Python-side defaults:</p>
</blockquote>
<pre><code class="language-python">from alembic import op
from sqlalchemy import Column, TIMESTAMP, func

# specify &quot;DEFAULT NOW&quot; along with the &quot;timestamp&quot; column
op.create_table('account',
    Column('id', INTEGER, primary_key=True),
    Column('timestamp', TIMESTAMP, server_default=func.now())
)
</code></pre>
<p>The function also returns a newly created <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object, corresponding to the table specification given, which is suitable for immediate SQL operations, in particular <strong><a href="zh/../zh/06_01_04_bulk_insert.html">Operations.bulk_insert()</a></strong>:</p>
<pre><code class="language-python">from sqlalchemy import INTEGER, VARCHAR, NVARCHAR, Column
from alembic import op

account_table = op.create_table(
    'account',
    Column('id', INTEGER, primary_key=True),
    Column('name', VARCHAR(50), nullable=False),
    Column('description', NVARCHAR(200)),
    Column('timestamp', TIMESTAMP, server_default=func.now())
)

op.bulk_insert(
    account_table,
    [
        {&quot;name&quot;: &quot;A1&quot;, &quot;description&quot;: &quot;account 1&quot;},
        {&quot;name&quot;: &quot;A2&quot;, &quot;description&quot;: &quot;account 2&quot;},
    ]
)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – Name of the table</li>
<li>*<em><strong>columns</strong></em> – collection of <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Column">Column</a></strong> objects within the table, as well as optional <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Constraint">Constraint</a></strong> objects and <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.Index">Index</a></strong> objects.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li>**<em><strong>kw</strong></em> – Other keyword arguments are passed to the underlying <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">sqlalchemy.schema.Table</a></strong> object created for the command.</li>
</ul>
<p><strong>Returns:</strong> the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object corresponding to the parameters given.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_table_comment"><a class="header" href="#create_table_comment">create_table_comment</a></h1>
<p><strong>create_table_comment</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>comment</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>existing_comment</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Emit a COMMENT ON operation to set the comment for a table.</p>
<p><em>New in version 1.0.6.</em></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – string name of the target table.</li>
<li><em><strong>comment</strong></em> – string value of the <strong>comment</strong> being registered against the specified table.</li>
<li><em><strong>existing_comment</strong></em> – String value of a comment already registered on the specified table, used within autogenerate so that the operation is reversible, but not required for direct use.</li>
</ul>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_17_drop_table_comment.html">Operations.drop_table_comment()</a></strong></li>
<li><strong><a href="zh/../zh/06_01_02_alter_column.html#params.comment">Operations.alter_column.comment</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_unique_constraint"><a class="header" href="#create_unique_constraint">create_unique_constraint</a></h1>
<p><strong>create_unique_constraint</strong>(<em>constraint_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  Sequence[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw) → Any</p>
<p>Issue a “create unique constraint” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">from alembic import op

op.create_unique_constraint(&quot;uq_user_name&quot;, &quot;user&quot;, [&quot;name&quot;])
</code></pre>
<p>This internally generates a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> object containing the necessary columns, then generates a new <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#sqlalchemy.schema.UniqueConstraint">UniqueConstraint</a></strong> object which it then associates with the <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong>. Any event listeners associated with this action will be fired off normally. The <strong><a href="https://docs.sqlalchemy.org/en/14/core/ddl.html#sqlalchemy.schema.AddConstraint">AddConstraint</a></strong> construct is ultimately used to generate the ALTER statement.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>name</strong></em> – Name of the unique constraint. The <code>name</code> is necessary so that an ALTER statement can be emitted. For setups that use an automated naming scheme such as that described at <strong><a href="https://docs.sqlalchemy.org/en/14/core/constraints.html#constraint-naming-conventions">Configuring Constraint Naming Conventions</a></strong>, <code>name</code> here can be <code>None</code>, as the event listener will apply the <code>name</code> to the constraint object when it is associated with the table.</li>
<li><em><strong>table_name</strong></em> – String name of the source table.</li>
<li><em><strong>columns</strong></em> – a list of string column names in the source table.</li>
<li><em><strong>deferrable</strong></em> – optional bool. If set, emit DEFERRABLE or NOT DEFERRABLE when issuing DDL for this constraint.</li>
<li><em><strong>initially</strong></em> – optional string. If set, emit INITIALLY <value> when issuing DDL for this constraint.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_column"><a class="header" href="#drop_column">drop_column</a></h1>
<p><strong>drop_column</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>column_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw) → Optional[Table]</p>
<p>Issue a “drop column” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">drop_column('organization', 'account_id')
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – name of table</li>
<li><em><strong>column_name</strong></em> – name of column</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li><em><strong>mssql_drop_check</strong></em> – Optional boolean. When <code>True</code>, on Microsoft SQL Server only, first drop the CHECK constraint on the column using a SQL-script-compatible block that selects into a @variable from sys.check_constraints, then exec’s a separate DROP CONSTRAINT for that constraint.</li>
<li><em><strong>mssql_drop_default</strong></em> – Optional boolean. When <code>True</code>, on Microsoft SQL Server only, first drop the DEFAULT constraint on the column using a SQL-script-compatible block that selects into a @variable from sys.default_constraints, then exec’s a separate DROP CONSTRAINT for that default.</li>
<li><em><strong>mssql_drop_foreign_key</strong></em> – Optional boolean. When <code>True</code>, on Microsoft SQL Server only, first drop a single FOREIGN KEY constraint on the column using a SQL-script-compatible block that selects into a @variable from sys.foreign_keys/sys.foreign_key_columns, then exec’s a separate DROP CONSTRAINT for that default. Only works if the column has exactly one FK constraint which refers to it, at the moment.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_constraint"><a class="header" href="#drop_constraint">drop_constraint</a></h1>
<p><strong>drop_constraint</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>type_</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Drop a constraint of the given name, typically via DROP CONSTRAINT.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>constraint_name</strong></em> – name of the constraint.</li>
<li><em><strong>table_name</strong></em> – table name.</li>
<li><em><strong>type_</strong></em> – optional, required on MySQL. can be ‘foreignkey’, ‘primary’, ‘unique’, or ‘check’.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_index"><a class="header" href="#drop_index">drop_index</a></h1>
<p><strong>drop_index</strong>(<em>index_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>table_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw) → Optional[Table]</p>
<p>Issue a “drop index” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">drop_index(&quot;accounts&quot;)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>index_name</strong></em> – name of the index.</li>
<li><em><strong>table_name</strong></em> – name of the owning table. Some backends such as Microsoft SQL Server require this.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li><em><strong>**kw</strong></em> – Additional keyword arguments not mentioned above are dialect specific, and passed in the form <code>&lt;dialectname&gt;_&lt;argname&gt;</code>. See the documentation regarding an individual dialect at <strong><a href="https://docs.sqlalchemy.org/en/14/dialects/index.html#dialect-toplevel">Dialects</a></strong> for detail on documented arguments.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_table"><a class="header" href="#drop_table">drop_table</a></h1>
<p><strong>drop_table</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, **kw: Any) → None</p>
<p>Issue a “drop table” instruction using the current migration context.</p>
<p>e.g.:</p>
<pre><code class="language-python">drop_table(&quot;accounts&quot;)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – Name of the table</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
<li><em><strong>**kw</strong></em> – Other keyword arguments are passed to the underlying <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">sqlalchemy.schema.Table</a></strong> object created for the command.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_table_comment"><a class="header" href="#drop_table_comment">drop_table_comment</a></h1>
<p><strong>drop_table_comment</strong>(<em>table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>existing_comment</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Issue a “drop table comment” operation to remove an existing comment set on a table.</p>
<p><em>New in version 1.0.6.</em></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>table_name</strong></em> – string name of the target table.</li>
<li><em><strong>existing_comment</strong></em> – An optional string value of a comment already registered on the specified table.</li>
</ul>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_11_create_table_comment.html">Operations.create_table_comment()</a></strong></li>
<li><strong><a href="zh/../zh/06_01_02_alter_column.html#params.comment">Operations.alter_column.comment</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="execute"><a class="header" href="#execute">execute</a></h1>
<p><strong>execute</strong>(<em>sqltext</em>:  Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, TextClause, Update], <em>execution_options</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>) → Optional[Table]</p>
<p>Execute the given SQL using the current migration context.</p>
<p>The given SQL can be a plain string, e.g.:</p>
<pre><code class="language-python">op.execute(&quot;INSERT INTO table (foo) VALUES ('some value')&quot;)
</code></pre>
<p>Or it can be any kind of Core SQL Expression construct, such as below where we use an update construct:</p>
<pre><code class="language-python">from sqlalchemy.sql import table, column
from sqlalchemy import String
from alembic import op

account = table('account',
    column('name', String)
)
op.execute(
    account.update().\\
        where(account.c.name==op.inline_literal('account 1')).\\
        values({'name':op.inline_literal('account 2')})
        )
</code></pre>
<p>Above, we made use of the SQLAlchemy <strong><a href="https://docs.sqlalchemy.org/en/14/core/selectable.html#sqlalchemy.sql.expression.table">sqlalchemy.sql.expression.table()</a></strong> and <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.column">sqlalchemy.sql.expression.column()</a></strong> constructs to make a brief, ad-hoc table construct just for our UPDATE statement. A full <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.Table">Table</a></strong> construct of course works perfectly fine as well, though note it’s a recommended practice to at least ensure the definition of a table is self-contained within the migration script, rather than imported from a module that may break compatibility with older migrations.</p>
<p>In a SQL script context, the statement is emitted directly to the output stream. There is no return result, however, as this function is oriented towards generating a change script that can run in “offline” mode. Additionally, parameterized statements are discouraged here, as they will not work in offline mode. Above, we use <strong><a href="zh/../zh/06_01_23_inline_literal.html">inline_literal()</a></strong> where parameters are to be used.</p>
<p>For full interaction with a connected database where parameters can also be used normally, use the “bind” available from the context:</p>
<pre><code class="language-python">from alembic import op
connection = op.get_bind()

connection.execute(
    account.update().where(account.c.name=='account 1').
    values({&quot;name&quot;: &quot;account 2&quot;})
)
</code></pre>
<p>Additionally, when passing the statement as a plain string, it is first coerceed into a <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">sqlalchemy.sql.expression.text()</a></strong> construct before being passed along. In the less likely case that the literal SQL string contains a colon, it must be escaped with a backslash, as:</p>
<pre><code class="language-python">op.execute(&quot;INSERT INTO table (foo) VALUES ('\:colon_value')&quot;)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>sqltext</strong></em> – Any legal SQLAlchemy expression, including:
<ul>
<li>a string</li>
<li>a <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">sqlalchemy.sql.expression.text()</a></strong> construct.</li>
<li>a <strong><a href="https://docs.sqlalchemy.org/en/14/core/dml.html#sqlalchemy.sql.expression.insert">sqlalchemy.sql.expression.insert()</a></strong> construct.</li>
<li>a <strong><a href="https://docs.sqlalchemy.org/en/14/core/dml.html#sqlalchemy.sql.expression.update">sqlalchemy.sql.expression.update()</a></strong>, <strong><a href="https://docs.sqlalchemy.org/en/14/core/dml.html#sqlalchemy.sql.expression.insert">sqlalchemy.sql.expression.insert()</a></strong>, or <strong><a href="https://docs.sqlalchemy.org/en/14/core/dml.html#sqlalchemy.sql.expression.delete">sqlalchemy.sql.expression.delete()</a></strong> construct.</li>
<li>Pretty much anything that’s “executable” as described in <strong><a href="https://docs.sqlalchemy.org/en/14/core/tutorial.html#sqlexpression-toplevel">SQL Expression Language Tutorial (1.x API)</a></strong>.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> when passing a plain string, the statement is coerced into a <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.text">sqlalchemy.sql.expression.text()</a></strong> construct. This construct considers symbols with colons, e.g. <code>:foo</code> to be bound parameters. To avoid this, ensure that colon symbols are escaped, e.g. <code>\:foo</code>.</p>
</blockquote>
</li>
<li><em><strong>execution_options</strong></em> – Optional dictionary of execution options, will be passed to <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection.execution_options">sqlalchemy.engine.Connection.execution_options()</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="f"><a class="header" href="#f">f</a></h1>
<p><strong>f</strong>(<em>name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>) → sqlalchemy.sql.elements.conv</p>
<p>Indicate a string name that has already had a naming convention applied to it.</p>
<p>This feature combines with the SQLAlchemy <code>naming_convention</code> feature to disambiguate constraint names that have already had naming conventions applied to them, versus those that have not. This is necessary in the case that the <code>&quot;%(constraint_name)s&quot;</code> token is used within a naming convention, so that it can be identified that this particular name should remain fixed.</p>
<p>If the <strong><a href="zh/../zh/06_01_19_f.html">Operations.f()</a></strong> is used on a constraint, the naming convention will not take effect:</p>
<pre><code class="language-python">op.add_column('t', 'x', Boolean(name=op.f('ck_bool_t_x')))
</code></pre>
<p>Above, the CHECK constraint generated will have the name <code>ck_bool_t_x</code> regardless of whether or not a naming convention is in use.</p>
<p>Alternatively, if a naming convention is in use, and ‘f’ is not used, names will be converted along conventions. If the <code>target_metadata</code> contains the naming convention <code>{&quot;ck&quot;: &quot;ck_bool_%(table_name)s_%(constraint_name)s&quot;}</code>, then the output of the following:</p>
<pre><code class="language-text">op.add_column(‘t’, ‘x’, Boolean(name=’x’))
</code></pre>
<p>will be:</p>
<pre><code class="language-python">CONSTRAINT ck_bool_t_x CHECK (x in (1, 0)))
</code></pre>
<p>The function is rendered in the output of autogenerate when a particular constraint name is already converted.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get_bind"><a class="header" href="#get_bind">get_bind</a></h1>
<p><strong>get_bind</strong>() → Connection</p>
<p>Return the current ‘bind’.</p>
<p>Under normal circumstances, this is the <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection">Connection</a></strong> currently being used to emit SQL to the database.</p>
<p>In a SQL script context, this value is <code>None</code>. [TODO: verify this]</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get_context"><a class="header" href="#get_context">get_context</a></h1>
<p><strong>get_context</strong>()</p>
<p>Return the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext</a></strong> object that’s currently in use.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="implementation_for"><a class="header" href="#implementation_for">implementation_for</a></h1>
<p><em>classmethod</em> <strong>implementation_for</strong>(<em>op_cls</em>:  Any) → Callable</p>
<p>Register an implementation for a given <strong><a href="zh/../en/api/operations.html#alembic.operations.ops.MigrateOperation">MigrateOperation</a></strong>.</p>
<p>This is part of the operation extensibility API.</p>
<p><strong>See also:</strong></p>
<p><a href="zh/../en/api/operations.html#operation-plugins">Operation Plugins</a> - example of use</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inline_literal"><a class="header" href="#inline_literal">inline_literal</a></h1>
<p><strong>inline_literal</strong>(<em>value</em>:  Union[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a href="https://docs.python.org/3/library/functions.html#int">int</a>], <em>type_</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>) → _literal_bindparam</p>
<p>Produce an ‘inline literal’ expression, suitable for using in an INSERT, UPDATE, or DELETE statement.</p>
<p>When using Alembic in “offline” mode, CRUD operations aren’t compatible with SQLAlchemy’s default behavior surrounding literal values, which is that they are converted into bound values and passed separately into the <code>execute()</code> method of the DBAPI cursor. An offline SQL script needs to have these rendered inline. While it should always be noted that inline literal values are an <strong>enormous</strong> security hole in an application that handles untrusted input, a schema migration is not run in this context, so literals are safe to render inline, with the caveat that advanced types like dates may not be supported directly by SQLAlchemy.</p>
<p>See <strong><a href="zh/../zh/06_01_18_execute.html">execute()</a></strong> for an example usage of <strong><a href="zh/../zh/06_01_23_inline_literal.html">inline_literal()</a></strong>.</p>
<p>The environment can also be configured to attempt to render “literal” values inline automatically, for those simple types that are supported by the dialect; see <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.literal_binds">EnvironmentContext.configure.literal_binds</a></strong> for this more recently added feature.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><em><strong>value</strong></em> – The <strong>value</strong> to render. Strings, integers, and simple numerics should be supported. Other types like boolean, dates, etc. may or may not be supported yet by various backends.</p>
</li>
<li>
<p><em><strong>type_</strong></em> – optional - a <strong><a href="https://docs.sqlalchemy.org/en/14/core/type_api.html#sqlalchemy.types.TypeEngine">sqlalchemy.types.TypeEngine</a></strong> subclass stating the type of this value. In SQLAlchemy expressions, this is usually derived automatically from the Python type of the value itself, as well as based on the context in which the value is used.</p>
</li>
</ul>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.literal_binds">EnvironmentContext.configure.literal_binds</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="invoke"><a class="header" href="#invoke">invoke</a></h1>
<p><strong>invoke</strong>(<em>operation</em>:  MigrateOperation) → Any</p>
<p>Given a <strong><a href="zh/../en/api/operations.html#alembic.operations.ops.MigrateOperation">MigrateOperation</a></strong>, invoke it in terms of this <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> instance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="register_operation"><a class="header" href="#register_operation">register_operation</a></h1>
<p><em>classmethod</em> <strong>register_operation</strong>(<em>name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>sourcename</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Callable</p>
<p>Register a new operation for this class.</p>
<p>This method is normally used to add new operations to the <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> class, and possibly the <strong><a href="zh/../zh/06_02_batch_operations.html">BatchOperations</a></strong> class as well. All Alembic migration operations are implemented via this system, however the system is also available as a public API to facilitate adding custom operations.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../en/api/operations.html#operation-plugins">Operation Plugins</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rename_table"><a class="header" href="#rename_table">rename_table</a></h1>
<p><strong>rename_table</strong>(<em>old_table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>new_table_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Emit an ALTER TABLE to rename a table.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>old_table_name</strong></em> – old name.</li>
<li><em><strong>new_table_name</strong></em> – new name.</li>
<li><em><strong>schema</strong></em> – Optional <strong>schema</strong> name to operate within. To control quoting of the <strong>schema</strong> outside of the default behavior, use the SQLAlchemy construct <strong><a href="https://docs.sqlalchemy.org/en/14/core/sqlelement.html#sqlalchemy.sql.expression.quoted_name">quoted_name</a></strong>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alembicoperationsbatchoperations"><a class="header" href="#alembicoperationsbatchoperations">alembic.operations.BatchOperations</a></h1>
<p><em>class</em> alembic.operations.<strong>BatchOperations</strong>(<em>migration_context</em>:  MigrationContext, <em>impl</em>:  Optional[BatchOperationsImpl] = None)</p>
<p>Modifies the interface <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> for batch mode.</p>
<p>This basically omits the <code>table_name</code> and <code>schema</code> parameters from associated methods, as these are a given when running under batch mode.</p>
<p><strong>See also: <a href="zh/../zh/06_01_03_batch_alter_table.html">Operations.batch_alter_table()</a></strong></p>
<blockquote>
<p><strong>Note:</strong> that as of 0.8, most of the methods on this class are produced dynamically using the <strong><a href="zh/../zh/06_01_25_register_operation.html">Operations.register_operation()</a></strong> method.</p>
</blockquote>
<p>Construct a new <a href="zh/../zh/06_01_operations.html">Operations</a></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>migration_context</strong></em> – a <strong><a href="zh/../en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext</a></strong> instance.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add_column-1"><a class="header" href="#add_column-1">add_column</a></h1>
<p><strong>add_column</strong>(<em>column</em>:  Column, <em>insert_before</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>insert_after</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → Optional[Table]</p>
<p>Issue an “add column” instruction using the current batch migration context.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_01_add_column.html">Operations.add_column()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alter_column-1"><a class="header" href="#alter_column-1">alter_column</a></h1>
<p><strong>alter_column</strong>(<em>column_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>nullable</em>:  Optional[<a href="https://docs.python.org/3/library/functions.html#bool">bool</a>] = None, <em>comment</em>:  <a href="https://docs.python.org/3/library/functions.html#bool">bool</a> = False, <em>server_default</em>:  Union[Function, <a href="https://docs.python.org/3/library/functions.html#bool">bool</a>] = False, <em>new_column_name</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>type_</em>:  Optional[Union[TypeEngine, Type[TypeEngine]]] = None, <em>existing_type</em>:  Optional[Union[TypeEngine, Type[TypeEngine]]] = None, <em>existing_server_default</em>:  <a href="https://docs.python.org/3/library/functions.html#bool">bool</a> = False, <em>existing_nullable</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>existing_comment</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>insert_before</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>insert_after</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, **kw) → Optional[Table]</p>
<p>Issue an “alter column” instruction using the current batch migration context.</p>
<p>Parameters are the same as that of <strong><a href="zh/../zh/06_01_02_alter_column.html">Operations.alter_column()</a></strong>, as well as the following option(s):</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>insert_before</strong></em> – String name of an existing column which this column should be placed before, when creating the new table.
<blockquote>
<p><em>New in version 1.4.0.</em></p>
</blockquote>
</li>
<li><em><strong>insert_after</strong></em> – String name of an existing column which this column should be placed after, when creating the new table. If both <strong><a href="zh/06_02_02_alter_column.html#alembic.operations.BatchOperations.alter_column.params.insert_before">BatchOperations.alter_column.insert_before</a></strong> and <strong><a href="zh/06_02_02_alter_column.html#alembic.operations.BatchOperations.alter_column.params.insert_after">BatchOperations.alter_column.insert_after</a></strong> are omitted, the column is inserted after the last existing column in the table.
<blockquote>
<p><em>New in version 1.4.0.</em></p>
</blockquote>
</li>
</ul>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_02_alter_column.html">Operations.alter_column()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_check_constraint-1"><a class="header" href="#create_check_constraint-1">create_check_constraint</a></h1>
<p><strong>create_check_constraint</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>condition</em>:  TextClause, **kw) → Optional[Table]</p>
<p>Issue a “create check constraint” instruction using the current batch migration context.</p>
<p>The batch form of this call omits the <code>source</code> and <code>schema</code> arguments from the call.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_05_create_check_constraint.html">Operations.create_check_constraint()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_exclude_constraint-1"><a class="header" href="#create_exclude_constraint-1">create_exclude_constraint</a></h1>
<p><strong>create_exclude_constraint</strong>(constraint_name, *elements, **kw)</p>
<p>Issue a “create exclude constraint” instruction using the current batch migration context.</p>
<blockquote>
<p><strong>Note:</strong> This method is Postgresql specific, and additionally requires at least SQLAlchemy 1.0.</p>
</blockquote>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_06_create_exclude_constraint.html">Operations.create_exclude_constraint()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_foreign_key-1"><a class="header" href="#create_foreign_key-1">create_foreign_key</a></h1>
<p><strong>create_foreign_key</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>referent_table</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>local_cols</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>remote_cols</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <em>referent_schema</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None, <em>onupdate</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>ondelete</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>deferrable</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>initially</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, <em>match</em>:  <a href="https://docs.python.org/3/library/constants.html#None">None</a> = <a href="https://docs.python.org/3/library/constants.html#None">None</a>, **dialect_kw) → None</p>
<p>Issue a “create foreign key” instruction using the current batch migration context.</p>
<p>The batch form of this call omits the <code>source</code> and <code>source_schema</code> arguments from the call.</p>
<p>e.g.:</p>
<pre><code class="language-python">with batch_alter_table(&quot;address&quot;) as batch_op:
    batch_op.create_foreign_key(
                &quot;fk_user_address&quot;,
                &quot;user&quot;, [&quot;user_id&quot;], [&quot;id&quot;])
</code></pre>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_07_create_foreign_key.html">Operations.create_foreign_key()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_index-1"><a class="header" href="#create_index-1">create_index</a></h1>
<p><strong>create_index</strong>(<em>index_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], **kw) → Optional[Table]</p>
<p>Issue a “create index” instruction using the current batch migration context.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_08_create_index.html">Operations.create_index()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_primary_key-1"><a class="header" href="#create_primary_key-1">create_primary_key</a></h1>
<p><strong>create_primary_key</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  List[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]) → None</p>
<p>Issue a “create primary key” instruction using the current batch migration context.</p>
<p>The batch form of this call omits the <code>table_name</code> and <code>schema</code> arguments from the call.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_09_create_primary_key.html">Operations.create_primary_key()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_table_comment-1"><a class="header" href="#create_table_comment-1">create_table_comment</a></h1>
<p><strong>create_table_comment</strong>(comment, existing_comment=None)</p>
<p>Emit a COMMENT ON operation to set the comment for a table using the current batch migration context.</p>
<blockquote>
<p><em>New in version 1.6.0.</em></p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>comment</strong></em> – string value of the <strong>comment</strong> being registered against the specified table.</li>
<li><em><strong>existing_comment</strong></em> – String value of a comment already registered on the specified table, used within autogenerate so that the operation is reversible, but not required for direct use.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create_unique_constraint-1"><a class="header" href="#create_unique_constraint-1">create_unique_constraint</a></h1>
<p><strong>create_unique_constraint</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>columns</em>:  Sequence[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], **kw) → Any</p>
<p>Issue a “create unique constraint” instruction using the current batch migration context.</p>
<p>The batch form of this call omits the <code>source</code> and <code>schema</code> arguments from the call.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_12_create_unique_constraint.html">Operations.create_unique_constraint()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_column-1"><a class="header" href="#drop_column-1">drop_column</a></h1>
<p><strong>drop_column</strong>(<em>column_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, **kw) → Optional[Table]</p>
<p>Issue a “drop column” instruction using the current batch migration context.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_13_drop_column.html">Operations.drop_column()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_constraint-1"><a class="header" href="#drop_constraint-1">drop_constraint</a></h1>
<p><strong>drop_constraint</strong>(<em>constraint_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <em>type_</em>:  Optional[<a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] = None) → None</p>
<p>Issue a “drop constraint” instruction using the current batch migration context.</p>
<p>The batch form of this call omits the <code>table_name</code> and <code>schema</code> arguments from the call.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_14_drop_constraint.html">Operations.drop_constraint()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_index-1"><a class="header" href="#drop_index-1">drop_index</a></h1>
<p><strong>drop_index</strong>(<em>index_name</em>:  <a href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, **kw) → Optional[Table]</p>
<p>Issue a “drop index” instruction using the current batch migration context.</p>
<p><strong>See also:</strong></p>
<ul>
<li><strong><a href="zh/../zh/06_01_15_drop_index.html">Operations.drop_index()</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop_table_comment-1"><a class="header" href="#drop_table_comment-1">drop_table_comment</a></h1>
<p><strong>drop_table_comment</strong>(existing_comment=None)</p>
<p>Issue a “drop table comment” operation to remove an existing comment set on a table using the current batch operations context.</p>
<blockquote>
<p><em>New in version 1.6.0.</em></p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><em><strong>existing_comment</strong></em> – An optional string value of a comment already registered on the specified table.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cookbook"><a class="header" href="#cookbook">cookbook</a></h1>
<p>A collection of “How-Tos” highlighting popular ways to extend Alembic.</p>
<blockquote>
<p><em><strong>Note:</strong></em> This is a new section where we catalogue various “how-tos” based on user requests. It is often the case that users will request a feature only to learn it can be provided with a simple customization.</p>
</blockquote>
<p>一系列“操作方法”，重点介绍了扩展 Alembic 的流行方法。</p>
<blockquote>
<p><em><strong>备注:</strong></em> 这是一个新的部分，我们根据用户请求对各种“操作方法”进行分类。 通常情况下，用户会请求一个功能只是为了学习它， 并且可以通过简单的定制来提供。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-an-up-to-date-database-from-scratch"><a class="header" href="#building-an-up-to-date-database-from-scratch">Building an Up to Date Database from Scratch</a></h1>
<p><strong>从头开始构建最新的数据库</strong></p>
<p>There’s a theory of database migrations that says that the revisions in existence for a database should be able to go from an entirely blank schema to the finished product, and back again. Alembic can roll this way. Though we think it’s kind of overkill, considering that SQLAlchemy itself can emit the full CREATE statements for any given model using <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData.create_all">create_all()</a></strong>. If you check out a copy of an application, running this will give you the entire database in one shot, without the need to run through all those migration files, which are instead tailored towards applying incremental changes to an existing database.</p>
<p>Alembic can integrate with a <strong><a href="https://docs.sqlalchemy.org/en/14/core/metadata.html#sqlalchemy.schema.MetaData.create_all">create_all()</a></strong> script quite easily. After running the create operation, tell Alembic to create a new version table, and to stamp it with the most recent revision (i.e. <code>head</code>):</p>
<pre><code class="language-python"># inside of a &quot;create the database&quot; script, first create
# tables:
my_metadata.create_all(engine)

# then, load the Alembic configuration and generate the
# version table, &quot;stamping&quot; it with the most recent rev:
from alembic.config import Config
from alembic import command
alembic_cfg = Config(&quot;/path/to/yourapp/alembic.ini&quot;)
command.stamp(alembic_cfg, &quot;head&quot;)
</code></pre>
<p>When this approach is used, the application can generate the database using normal SQLAlchemy techniques instead of iterating through hundreds of migration scripts. Now, the purpose of the migration scripts is relegated just to movement between versions on out-of-date databases, not new databases. You can now remove old migration files that are no longer represented on any existing environments.</p>
<p>To prune old migration files, simply delete the files. Then, in the earliest, still-remaining migration file, set <code>down_revision</code> to <code>None</code>:</p>
<pre><code class="language-python"># replace this:
#down_revision = '290696571ad2'

# with this:
down_revision = None
</code></pre>
<p>That file now becomes the “base” of the migration series.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conditional-migration-elements"><a class="header" href="#conditional-migration-elements">Conditional Migration Elements</a></h1>
<p><strong>条件迁移元素</strong></p>
<p>This example features the basic idea of a common need, that of affecting how a migration runs based on command line switches.</p>
<p>The technique to use here is simple; within a migration script, inspect the <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_x_argument">EnvironmentContext.get_x_argument()</a></strong> collection for any additional, user-defined parameters. Then take action based on the presence of those arguments.</p>
<p>To make it such that the logic to inspect these flags is easy to use and modify, we modify our <code>script.py.mako</code> template to make this feature available in all new revision files:</p>
<pre><code class="language-python">&quot;&quot;&quot;${message}

Revision ID: ${up_revision}
Revises: ${down_revision}
Create Date: ${create_date}

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = ${repr(up_revision)}
down_revision = ${repr(down_revision)}

from alembic import op
import sqlalchemy as sa
${imports if imports else &quot;&quot;}

from alembic import context


def upgrade():
    schema_upgrades()
    if context.get_x_argument(as_dictionary=True).get('data', None):
        data_upgrades()

def downgrade():
    if context.get_x_argument(as_dictionary=True).get('data', None):
        data_downgrades()
    schema_downgrades()

def schema_upgrades():
    &quot;&quot;&quot;schema upgrade migrations go here.&quot;&quot;&quot;
    ${upgrades if upgrades else &quot;pass&quot;}

def schema_downgrades():
    &quot;&quot;&quot;schema downgrade migrations go here.&quot;&quot;&quot;
    ${downgrades if downgrades else &quot;pass&quot;}

def data_upgrades():
    &quot;&quot;&quot;Add any optional data upgrade migrations here!&quot;&quot;&quot;
    pass

def data_downgrades():
    &quot;&quot;&quot;Add any optional data downgrade migrations here!&quot;&quot;&quot;
    pass
</code></pre>
<p>Now, when we create a new migration file, the <code>data_upgrades()</code> and <code>data_downgrades()</code> placeholders will be available, where we can add optional data migrations:</p>
<pre><code class="language-python">&quot;&quot;&quot;rev one

Revision ID: 3ba2b522d10d
Revises: None
Create Date: 2014-03-04 18:05:36.992867

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '3ba2b522d10d'
down_revision = None

from alembic import op
import sqlalchemy as sa
from sqlalchemy import String, Column
from sqlalchemy.sql import table, column

from alembic import context

def upgrade():
    schema_upgrades()
    if context.get_x_argument(as_dictionary=True).get('data', None):
        data_upgrades()

def downgrade():
    if context.get_x_argument(as_dictionary=True).get('data', None):
        data_downgrades()
    schema_downgrades()

def schema_upgrades():
    &quot;&quot;&quot;schema upgrade migrations go here.&quot;&quot;&quot;
    op.create_table(&quot;my_table&quot;, Column('data', String))

def schema_downgrades():
    &quot;&quot;&quot;schema downgrade migrations go here.&quot;&quot;&quot;
    op.drop_table(&quot;my_table&quot;)

def data_upgrades():
    &quot;&quot;&quot;Add any optional data upgrade migrations here!&quot;&quot;&quot;

    my_table = table('my_table',
        column('data', String),
    )

    op.bulk_insert(my_table,
        [
            {'data': 'data 1'},
            {'data': 'data 2'},
            {'data': 'data 3'},
        ]
    )

def data_downgrades():
    &quot;&quot;&quot;Add any optional data downgrade migrations here!&quot;&quot;&quot;

    op.execute(&quot;delete from my_table&quot;)
</code></pre>
<p>To invoke our migrations with data included, we use the <code>-x</code> flag:</p>
<pre><code class="language-bash">alembic -x data=true upgrade head
</code></pre>
<p>The <strong><a href="zh/../en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_x_argument">EnvironmentContext.get_x_argument()</a></strong> is an easy way to support new commandline options within environment and migration scripts.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sharing-a-connection-with-a-series-of-migration-commands-and-environments"><a class="header" href="#sharing-a-connection-with-a-series-of-migration-commands-and-environments">Sharing a Connection with a Series of Migration Commands and Environments</a></h1>
<p><strong>与一系列迁移命令和环境共享连接</strong></p>
<p>It is often the case that an application will need to call upon a series of commands within <strong><a href="zh/../en/api/commands.html#alembic-command-toplevel">Commands</a></strong>, where it would be advantageous for all operations to proceed along a single transaction. The connectivity for a migration is typically solely determined within the <code>env.py</code> script of a migration environment, which is called within the scope of a command.</p>
<p>The steps to take here are:</p>
<ol>
<li>Produce the <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection">Connection</a></strong> object to use.</li>
<li>Place it somewhere that <code>env.py</code> will be able to access it. This can be either a. a module-level global somewhere, or b. an attribute which we place into the <strong><a href="zh/../en/api/config.html#alembic.config.Config.attributes">Config.attributes</a></strong> dictionary (if we are on an older Alembic version, we may also attach an attribute directly to the <strong><a href="zh/../en/api/config.html#alembic.config.Config">Config</a></strong> object).</li>
<li>The <code>env.py</code> script is modified such that it looks for this <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection">Connection</a></strong> and makes use of it, in lieu of building up its own <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Engine">Engine</a></strong> instance.</li>
</ol>
<p>We illustrate using <strong><a href="zh/../en/api/config.html#alembic.config.Config.attributes">Config.attributes</a></strong>:</p>
<pre><code class="language-python">from alembic import command, config

cfg = config.Config(&quot;/path/to/yourapp/alembic.ini&quot;)
with engine.begin() as connection:
    cfg.attributes['connection'] = connection
    command.upgrade(cfg, &quot;head&quot;)
</code></pre>
<p>Then in <code>env.py</code>:</p>
<pre><code class="language-python">def run_migrations_online():
    connectable = config.attributes.get('connection', None)

    if connectable is None:
        # only create Engine if we don't have a Connection
        # from the outside
        connectable = engine_from_config(
            config.get_section(config.config_ini_section),
            prefix='sqlalchemy.',
            poolclass=pool.NullPool)

    context.configure(
        connection=connectable,
        target_metadata=target_metadata
    )

    with context.begin_transaction():
        context.run_migrations()
</code></pre>
<blockquote>
<p><em>Changed in version 1.4</em>: Prior to this version, we used a “branched connection”, by calling <strong><a href="https://docs.sqlalchemy.org/en/14/core/connections.html#sqlalchemy.engine.Connection.connect">connect()</a></strong>. This is now deprecated and unnecessary, since we no longer have to guess if the given “connection” is an <code>Engine</code> or <code>Connection</code>, it is always a <code>Connection</code>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="replaceable-objects"><a class="header" href="#replaceable-objects">Replaceable Objects</a></h1>
<p><strong>可替换对象</strong></p>
<p>This recipe proposes a hypothetical way of dealing with what we might call a replaceable schema object. A replaceable object is a schema object that needs to be created and dropped all at once. Examples of such objects include views, stored procedures, and triggers.</p>
<blockquote>
<p><strong>See also:</strong> The Replaceable Object concept has been integrated by the <strong><a href="https://github.com/olirice/alembic_utils">Alembic Utils</a></strong> project, which provides autogenerate and migration support for PostgreSQL functions and views. See <strong><a href="https://github.com/olirice/alembic_utils">Alembic Utils</a></strong> at <strong><a href="https://github.com/olirice/alembic_utils">https://github.com/olirice/alembic_utils</a></strong> .</p>
</blockquote>
<p>Replaceable objects present a problem in that in order to make incremental changes to them, we have to refer to the whole definition at once. If we need to add a new column to a view, for example, we have to drop it entirely and recreate it fresh with the extra column added, referring to the whole structure; but to make it even tougher, if we wish to support downgrade operarations in our migration scripts, we need to refer to the previous version of that construct fully, and we’d much rather not have to type out the whole definition in multiple places.</p>
<p>This recipe proposes that we may refer to the older version of a replaceable construct by directly naming the migration version in which it was created, and having a migration refer to that previous file as migrations run. We will also demonstrate how to integrate this logic within the <strong><a href="zh/../en/api/operations.html#operation-plugins">Operation Plugins</a></strong> feature introduced in Alembic 0.8. It may be very helpful to review this section first to get an overview of this API.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-replaceable-object-structure"><a class="header" href="#the-replaceable-object-structure">The Replaceable Object Structure</a></h1>
<p><strong>可替换对象结构</strong></p>
<p>We first need to devise a simple format that represents the “CREATE XYZ” / “DROP XYZ” aspect of what it is we’re building. We will work with an object that represents a textual definition; while a SQL view is an object that we can define using a <strong><a href="https://github.com/sqlalchemy/sqlalchemy/wiki/UsageRecipes/Views">table-metadata-like system</a></strong>, this is not so much the case for things like stored procedures, where we pretty much need to have a full string definition written down somewhere. We’ll use a simple value object called <code>ReplaceableObject</code> that can represent any named set of SQL text to send to a “CREATE” statement of some kind:</p>
<pre><code class="language-python">class ReplaceableObject:
    def __init__(self, name, sqltext):
        self.name = name
        self.sqltext = sqltext
</code></pre>
<p>Using this object in a migration script, assuming a Postgresql-style syntax, looks like:</p>
<pre><code class="language-python">customer_view = ReplaceableObject(
    &quot;customer_view&quot;,
    &quot;SELECT name, order_count FROM customer WHERE order_count &gt; 0&quot;
)

add_customer_sp = ReplaceableObject(
    &quot;add_customer_sp(name varchar, order_count integer)&quot;,
    &quot;&quot;&quot;
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count)
        VALUES (in_name, in_order_count);
    END;
    $$ LANGUAGE plpgsql;
    &quot;&quot;&quot;
)
</code></pre>
<p>The <code>ReplaceableObject</code> class is only one very simplistic way to do this. The structure of how we represent our schema objects is not too important for the purposes of this example; we can just as well put strings inside of tuples or dictionaries, as well as that we could define any kind of series of fields and class structures we want. The only important part is that below we will illustrate how organize the code that can consume the structure we create here.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-operations-for-the-target-objects"><a class="header" href="#create-operations-for-the-target-objects">Create Operations for the Target Objects</a></h1>
<p><strong>为目标对象创建操作</strong></p>
<p>We’ll use the <strong><a href="zh/../zh/06_01_operations.html">Operations</a></strong> extension API to make new operations for create, drop, and replace of views and stored procedures. Using this API is also optional; we can just as well make any kind of Python function that we would invoke from our migration scripts. However, using this API gives us operations built directly into the Alembic <code>op.*</code> namespace very nicely.</p>
<p>The most intricate class is below. This is the base of our “replaceable” operation, which includes not just a base operation for emitting CREATE and DROP instructions on a <code>ReplaceableObject</code>, it also assumes a certain model of “reversibility” which makes use of references to other migration files in order to refer to the “previous” version of an object:</p>
<pre><code class="language-python">from alembic.operations import Operations, MigrateOperation

class ReversibleOp(MigrateOperation):
    def __init__(self, target):
        self.target = target

    @classmethod
    def invoke_for_target(cls, operations, target):
        op = cls(target)
        return operations.invoke(op)

    def reverse(self):
        raise NotImplementedError()

    @classmethod
    def _get_object_from_version(cls, operations, ident):
        version, objname = ident.split(&quot;.&quot;)

        module = operations.get_context().script.get_revision(version).module
        obj = getattr(module, objname)
        return obj

    @classmethod
    def replace(cls, operations, target, replaces=None, replace_with=None):

        if replaces:
            old_obj = cls._get_object_from_version(operations, replaces)
            drop_old = cls(old_obj).reverse()
            create_new = cls(target)
        elif replace_with:
            old_obj = cls._get_object_from_version(operations, replace_with)
            drop_old = cls(target).reverse()
            create_new = cls(old_obj)
        else:
            raise TypeError(&quot;replaces or replace_with is required&quot;)

        operations.invoke(drop_old)
        operations.invoke(create_new)
</code></pre>
<p>The workings of this class should become clear as we walk through the example. To create usable operations from this base, we will build a series of stub classes and use <strong><a href="zh/../zh/06_01_25_register_operation.html">Operations.register_operation()</a></strong> to make them part of the <code>op.*</code> namespace:</p>
<pre><code class="language-python">@Operations.register_operation(&quot;create_view&quot;, &quot;invoke_for_target&quot;)
@Operations.register_operation(&quot;replace_view&quot;, &quot;replace&quot;)
class CreateViewOp(ReversibleOp):
    def reverse(self):
        return DropViewOp(self.target)


@Operations.register_operation(&quot;drop_view&quot;, &quot;invoke_for_target&quot;)
class DropViewOp(ReversibleOp):
    def reverse(self):
        return CreateViewOp(self.target)


@Operations.register_operation(&quot;create_sp&quot;, &quot;invoke_for_target&quot;)
@Operations.register_operation(&quot;replace_sp&quot;, &quot;replace&quot;)
class CreateSPOp(ReversibleOp):
    def reverse(self):
        return DropSPOp(self.target)


@Operations.register_operation(&quot;drop_sp&quot;, &quot;invoke_for_target&quot;)
class DropSPOp(ReversibleOp):
    def reverse(self):
        return CreateSPOp(self.target)
</code></pre>
<p>To actually run the SQL like “CREATE VIEW” and “DROP SEQUENCE”, we’ll provide implementations using <strong><a href="zh/../zh/06_01_22_implementation_for.html">Operations.implementation_for()</a></strong> that run straight into <strong><a href="zh/../zh/06_01_18_execute.html">Operations.execute()</a></strong>:</p>
<pre><code class="language-python">@Operations.implementation_for(CreateViewOp)
def create_view(operations, operation):
    operations.execute(&quot;CREATE VIEW %s AS %s&quot; % (
        operation.target.name,
        operation.target.sqltext
    ))


@Operations.implementation_for(DropViewOp)
def drop_view(operations, operation):
    operations.execute(&quot;DROP VIEW %s&quot; % operation.target.name)


@Operations.implementation_for(CreateSPOp)
def create_sp(operations, operation):
    operations.execute(
        &quot;CREATE FUNCTION %s %s&quot; % (
            operation.target.name, operation.target.sqltext
        )
    )


@Operations.implementation_for(DropSPOp)
def drop_sp(operations, operation):
    operations.execute(&quot;DROP FUNCTION %s&quot; % operation.target.name)
</code></pre>
<p>All of the above code can be present anywhere within an application’s source tree; the only requirement is that when the <code>env.py</code> script is invoked, it includes imports that ultimately call upon these classes as well as the <strong><a href="zh/../zh/06_01_25_register_operation.html">Operations.register_operation()</a></strong> and <strong><a href="zh/../zh/06_01_22_implementation_for.html">Operations.implementation_for()</a></strong> sequences.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-initial-migrations"><a class="header" href="#create-initial-migrations">Create Initial Migrations</a></h1>
<p><strong>创建初始迁移</strong></p>
<p>We can now illustrate how these objects look during use. For the first step, we’ll create a new migration to create a “customer” table:</p>
<pre><code class="language-bash">alembic revision -m &quot;create table&quot;
</code></pre>
<p>We build the first revision as follows:</p>
<pre><code class="language-python">&quot;&quot;&quot;create table

Revision ID: 3ab8b2dfb055
Revises:
Create Date: 2015-07-27 16:22:44.918507

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '3ab8b2dfb055'
down_revision = None
branch_labels = None
depends_on = None

from alembic import op
import sqlalchemy as sa


def upgrade():
    op.create_table(
        &quot;customer&quot;,
        sa.Column('id', sa.Integer, primary_key=True),
        sa.Column('name', sa.String),
        sa.Column('order_count', sa.Integer),
    )


def downgrade():
    op.drop_table('customer')
</code></pre>
<p>For the second migration, we will create a view and a stored procedure which act upon this table:</p>
<pre><code class="language-bash">alembic revision -m &quot;create views/sp&quot;
</code></pre>
<p>This migration will use the new directives:</p>
<pre><code class="language-python">&quot;&quot;&quot;create views/sp

Revision ID: 28af9800143f
Revises: 3ab8b2dfb055
Create Date: 2015-07-27 16:24:03.589867

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '28af9800143f'
down_revision = '3ab8b2dfb055'
branch_labels = None
depends_on = None

from alembic import op
import sqlalchemy as sa

from foo import ReplaceableObject

customer_view = ReplaceableObject(
    &quot;customer_view&quot;,
    &quot;SELECT name, order_count FROM customer WHERE order_count &gt; 0&quot;
)

add_customer_sp = ReplaceableObject(
    &quot;add_customer_sp(name varchar, order_count integer)&quot;,
    &quot;&quot;&quot;
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count)
        VALUES (in_name, in_order_count);
    END;
    $$ LANGUAGE plpgsql;
    &quot;&quot;&quot;
)


def upgrade():
    op.create_view(customer_view)
    op.create_sp(add_customer_sp)


def downgrade():
    op.drop_view(customer_view)
    op.drop_sp(add_customer_sp)
</code></pre>
<p>We see the use of our new <code>create_view()</code>, <code>create_sp()</code>, <code>drop_view()</code>, and <code>drop_sp()</code> directives. Running these to “head” we get the following (this includes an edited view of SQL emitted):</p>
<pre><code class="language-bash">$ alembic upgrade 28af9800143
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [sqlalchemy.engine.base.Engine] BEGIN (implicit)
INFO  [sqlalchemy.engine.base.Engine] select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
INFO  [sqlalchemy.engine.base.Engine] {'name': u'alembic_version'}
INFO  [sqlalchemy.engine.base.Engine] SELECT alembic_version.version_num
FROM alembic_version
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
INFO  [sqlalchemy.engine.base.Engine] {'name': u'alembic_version'}
INFO  [alembic.runtime.migration] Running upgrade  -&gt; 3ab8b2dfb055, create table
INFO  [sqlalchemy.engine.base.Engine]
CREATE TABLE customer (
    id SERIAL NOT NULL,
    name VARCHAR,
    order_count INTEGER,
    PRIMARY KEY (id)
)


INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] INSERT INTO alembic_version (version_num) VALUES ('3ab8b2dfb055')
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [alembic.runtime.migration] Running upgrade 3ab8b2dfb055 -&gt; 28af9800143f, create views/sp
INFO  [sqlalchemy.engine.base.Engine] CREATE VIEW customer_view AS SELECT name, order_count FROM customer WHERE order_count &gt; 0
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] CREATE FUNCTION add_customer_sp(name varchar, order_count integer)
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count)
        VALUES (in_name, in_order_count);
    END;
    $$ LANGUAGE plpgsql;

INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] UPDATE alembic_version SET version_num='28af9800143f' WHERE alembic_version.version_num = '3ab8b2dfb055'
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] COMMIT
</code></pre>
<p>We see that our CREATE TABLE proceeded as well as the CREATE VIEW and CREATE FUNCTION operations produced by our new directives.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-revision-migrations"><a class="header" href="#create-revision-migrations">Create Revision Migrations</a></h1>
<p><strong>创建修订迁移</strong></p>
<p>Finally, we can illustrate how we would “revise” these objects. Let’s consider we added a new column <code>email</code> to our <code>customer</code> table:</p>
<pre><code class="language-bash">alembic revision -m &quot;add email col&quot;
</code></pre>
<p>The migration is:</p>
<pre><code class="language-python">&quot;&quot;&quot;add email col

Revision ID: 191a2d20b025
Revises: 28af9800143f
Create Date: 2015-07-27 16:25:59.277326

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '191a2d20b025'
down_revision = '28af9800143f'
branch_labels = None
depends_on = None

from alembic import op
import sqlalchemy as sa


def upgrade():
    op.add_column(&quot;customer&quot;, sa.Column(&quot;email&quot;, sa.String()))


def downgrade():
    op.drop_column(&quot;customer&quot;, &quot;email&quot;)
</code></pre>
<p>We now need to recreate the <code>customer_view</code> view and the <code>add_customer_sp</code> function. To include downgrade capability, we will need to refer to the <strong>previous</strong> version of the construct; the <code>replace_view()</code> and <code>replace_sp()</code> operations we’ve created make this possible, by allowing us to refer to a specific, <strong>previous</strong> revision. the <code>replaces</code> and <code>replace_with</code> arguments accept a dot-separated string, which refers to a revision number and an object name, such as <code>&quot;28af9800143f.customer_view&quot;</code>. The <code>ReversibleOp</code> class makes use of the <strong><a href="zh/../en/ops.html#alembic.operations.Operations.get_context">Operations.get_context()</a></strong> method to locate the version file we refer to:</p>
<pre><code class="language-bash">alembic revision -m &quot;update views/sp&quot;
</code></pre>
<p>The migration:</p>
<pre><code class="language-python">&quot;&quot;&quot;update views/sp

Revision ID: 199028bf9856
Revises: 191a2d20b025
Create Date: 2015-07-27 16:26:31.344504

&quot;&quot;&quot;

# revision identifiers, used by Alembic.
revision = '199028bf9856'
down_revision = '191a2d20b025'
branch_labels = None
depends_on = None

from alembic import op
import sqlalchemy as sa

from foo import ReplaceableObject

customer_view = ReplaceableObject(
    &quot;customer_view&quot;,
    &quot;SELECT name, order_count, email &quot;
    &quot;FROM customer WHERE order_count &gt; 0&quot;
)

add_customer_sp = ReplaceableObject(
    &quot;add_customer_sp(name varchar, order_count integer, email varchar)&quot;,
    &quot;&quot;&quot;
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count, email)
        VALUES (in_name, in_order_count, email);
    END;
    $$ LANGUAGE plpgsql;
    &quot;&quot;&quot;
)


def upgrade():
    op.replace_view(customer_view, replaces=&quot;28af9800143f.customer_view&quot;)
    op.replace_sp(add_customer_sp, replaces=&quot;28af9800143f.add_customer_sp&quot;)


def downgrade():
    op.replace_view(customer_view, replace_with=&quot;28af9800143f.customer_view&quot;)
    op.replace_sp(add_customer_sp, replace_with=&quot;28af9800143f.add_customer_sp&quot;)
</code></pre>
<p>Above, instead of using <code>create_view()</code>, <code>create_sp()</code>, <code>drop_view()</code>, and <code>drop_sp()</code> methods, we now use <code>replace_view()</code> and <code>replace_sp()</code>. The replace operation we’ve built always runs a DROP and a CREATE. Running an upgrade to head we see:</p>
<pre><code class="language-bash">$ alembic upgrade head
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [sqlalchemy.engine.base.Engine] BEGIN (implicit)
INFO  [sqlalchemy.engine.base.Engine] select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
INFO  [sqlalchemy.engine.base.Engine] {'name': u'alembic_version'}
INFO  [sqlalchemy.engine.base.Engine] SELECT alembic_version.version_num
FROM alembic_version
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [alembic.runtime.migration] Running upgrade 28af9800143f -&gt; 191a2d20b025, add email col
INFO  [sqlalchemy.engine.base.Engine] ALTER TABLE customer ADD COLUMN email VARCHAR
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] UPDATE alembic_version SET version_num='191a2d20b025' WHERE alembic_version.version_num = '28af9800143f'
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [alembic.runtime.migration] Running upgrade 191a2d20b025 -&gt; 199028bf9856, update views/sp
INFO  [sqlalchemy.engine.base.Engine] DROP VIEW customer_view
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] CREATE VIEW customer_view AS SELECT name, order_count, email FROM customer WHERE order_count &gt; 0
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] DROP FUNCTION add_customer_sp(name varchar, order_count integer)
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] CREATE FUNCTION add_customer_sp(name varchar, order_count integer, email varchar)
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count, email)
        VALUES (in_name, in_order_count, email);
    END;
    $$ LANGUAGE plpgsql;

INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] UPDATE alembic_version SET version_num='199028bf9856' WHERE alembic_version.version_num = '191a2d20b025'
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] COMMIT
</code></pre>
<p>After adding our new <code>email</code> column, we see that both <code>customer_view</code> and <code>add_customer_sp()</code> are dropped before the new version is created. If we downgrade back to the old version, we see the old version of these recreated again within the downgrade for this migration:</p>
<pre><code class="language-bash">$ alembic downgrade 28af9800143
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [sqlalchemy.engine.base.Engine] BEGIN (implicit)
INFO  [sqlalchemy.engine.base.Engine] select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
INFO  [sqlalchemy.engine.base.Engine] {'name': u'alembic_version'}
INFO  [sqlalchemy.engine.base.Engine] SELECT alembic_version.version_num
FROM alembic_version
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [alembic.runtime.migration] Running downgrade 199028bf9856 -&gt; 191a2d20b025, update views/sp
INFO  [sqlalchemy.engine.base.Engine] DROP VIEW customer_view
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] CREATE VIEW customer_view AS SELECT name, order_count FROM customer WHERE order_count &gt; 0
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] DROP FUNCTION add_customer_sp(name varchar, order_count integer, email varchar)
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] CREATE FUNCTION add_customer_sp(name varchar, order_count integer)
    RETURNS integer AS $$
    BEGIN
        insert into customer (name, order_count)
        VALUES (in_name, in_order_count);
    END;
    $$ LANGUAGE plpgsql;

INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] UPDATE alembic_version SET version_num='191a2d20b025' WHERE alembic_version.version_num = '199028bf9856'
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [alembic.runtime.migration] Running downgrade 191a2d20b025 -&gt; 28af9800143f, add email col
INFO  [sqlalchemy.engine.base.Engine] ALTER TABLE customer DROP COLUMN email
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] UPDATE alembic_version SET version_num='28af9800143f' WHERE alembic_version.version_num = '191a2d20b025'
INFO  [sqlalchemy.engine.base.Engine] {}
INFO  [sqlalchemy.engine.base.Engine] COMMIT
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rudimental-schema-level-multi-tenancy-for-postgresql-databases"><a class="header" href="#rudimental-schema-level-multi-tenancy-for-postgresql-databases">Rudimental Schema-Level Multi Tenancy for PostgreSQL Databases</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dont-generate-empty-migrations-with-autogenerate"><a class="header" href="#dont-generate-empty-migrations-with-autogenerate">Don’t Generate Empty Migrations with Autogenerate</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dont-emit-drop-index-when-the-table-is-to-be-dropped-as-well"><a class="header" href="#dont-emit-drop-index-when-the-table-is-to-be-dropped-as-well">Don’t emit DROP INDEX when the table is to be dropped as well</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dont-generate-any-drop-table-directives-with-autogenerate"><a class="header" href="#dont-generate-any-drop-table-directives-with-autogenerate">Don’t generate any DROP TABLE directives with autogenerate</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apply-custom-sorting-to-table-columns-within-create-table"><a class="header" href="#apply-custom-sorting-to-table-columns-within-create-table">Apply Custom Sorting to Table Columns within CREATE TABLE</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dont-emit-create-table-statements-for-views"><a class="header" href="#dont-emit-create-table-statements-for-views">Don’t emit CREATE TABLE statements for Views</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="run-multiple-alembic-environments-from-one-ini-file"><a class="header" href="#run-multiple-alembic-environments-from-one-ini-file">Run Multiple Alembic Environments from one .ini file</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="print-python-code-to-generate-particular-database-tables"><a class="header" href="#print-python-code-to-generate-particular-database-tables">Print Python Code to Generate Particular Database Tables</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="run-alembic-operation-objects-directly-as-in-from-autogenerate"><a class="header" href="#run-alembic-operation-objects-directly-as-in-from-autogenerate">Run Alembic Operation Objects Directly (as in from autogenerate)</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="test-current-database-revision-is-at-heads"><a class="header" href="#test-current-database-revision-is-at-heads">Test current database revision is at head(s)</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-asyncio-with-alembic"><a class="header" href="#using-asyncio-with-alembic">Using Asyncio with Alembic</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api详细"><a class="header" href="#api详细">API详细</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="runtime-objects"><a class="header" href="#runtime-objects">Runtime Objects</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-environment-context"><a class="header" href="#the-environment-context">The Environment Context</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-migration-context"><a class="header" href="#the-migration-context">The Migration Context</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commands"><a class="header" href="#commands">Commands</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operation-directives"><a class="header" href="#operation-directives">Operation Directives</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operation-plugins"><a class="header" href="#operation-plugins">Operation Plugins</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="built-in-operation-objects"><a class="header" href="#built-in-operation-objects">Built-in Operation Objects</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="autogeneration"><a class="header" href="#autogeneration">Autogeneration</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-diffs"><a class="header" href="#getting-diffs">Getting Diffs</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="customizing-revision-generation"><a class="header" href="#customizing-revision-generation">Customizing Revision Generation</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="autogenerating-custom-operation-directives"><a class="header" href="#autogenerating-custom-operation-directives">Autogenerating Custom Operation Directives</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="script-directory"><a class="header" href="#script-directory">Script Directory</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="revision"><a class="header" href="#revision">Revision</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="write-hooks"><a class="header" href="#write-hooks">Write Hooks</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ddl-internals"><a class="header" href="#ddl-internals">DDL Internals</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mysql"><a class="header" href="#mysql">MySQL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ms-sql"><a class="header" href="#ms-sql">MS-SQL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="postgresql"><a class="header" href="#postgresql">Postgresql</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sqlite"><a class="header" href="#sqlite">SQLite</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<p><strong>更新历史</strong></p>
<p>参考原文: <a href="zh/../en/changelog.html">Changelog</a></p>
<div style="break-before: page; page-break-before: always;"></div><!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Index &#8212; Alembic 1.7.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature_override.css" />
    <link rel="stylesheet" type="text/css" href="_static/changelog.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_paramlinks.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="#" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation"><a class="header" href="#navigation">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html#" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Index</a></li> 
      </ul>
    </div>  
<pre><code>&lt;div class=&quot;document&quot;&gt;
  &lt;div class=&quot;documentwrapper&quot;&gt;
    &lt;div class=&quot;bodywrapper&quot;&gt;
      &lt;div class=&quot;body&quot; role=&quot;main&quot;&gt;
</code></pre>
<h1 id="index">Index</h1>
<div class="genindex-jumpbox">
 <a href="en/genindex.html#Symbols"><strong>Symbols</strong></a>
 | <a href="en/genindex.html#A"><strong>A</strong></a>
 | <a href="en/genindex.html#B"><strong>B</strong></a>
 | <a href="en/genindex.html#C"><strong>C</strong></a>
 | <a href="en/genindex.html#D"><strong>D</strong></a>
 | <a href="en/genindex.html#E"><strong>E</strong></a>
 | <a href="en/genindex.html#F"><strong>F</strong></a>
 | <a href="en/genindex.html#G"><strong>G</strong></a>
 | <a href="en/genindex.html#H"><strong>H</strong></a>
 | <a href="en/genindex.html#I"><strong>I</strong></a>
 | <a href="en/genindex.html#K"><strong>K</strong></a>
 | <a href="en/genindex.html#L"><strong>L</strong></a>
 | <a href="en/genindex.html#M"><strong>M</strong></a>
 | <a href="en/genindex.html#N"><strong>N</strong></a>
 | <a href="en/genindex.html#O"><strong>O</strong></a>
 | <a href="en/genindex.html#P"><strong>P</strong></a>
 | <a href="en/genindex.html#Q"><strong>Q</strong></a>
 | <a href="en/genindex.html#R"><strong>R</strong></a>
 | <a href="en/genindex.html#S"><strong>S</strong></a>
 | <a href="en/genindex.html#T"><strong>T</strong></a>
 | <a href="en/genindex.html#U"><strong>U</strong></a>
 | <a href="en/genindex.html#V"><strong>V</strong></a>
 | <a href="en/genindex.html#W"><strong>W</strong></a>
</div>
<h2 id="Symbols">Symbols</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.**kw">**kw (alembic.operations.Operations.create_index parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_table.params.**kw&quot;&gt;(alembic.operations.Operations.create_table parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_index.params.**kw">(alembic.operations.Operations.drop_index parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table.params.**kw">(alembic.operations.Operations.drop_table parameter)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.params.**kw">(alembic.runtime.environment.EnvironmentContext parameter)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.run_migrations.params.**kw">(alembic.runtime.migration.MigrationContext.run_migrations parameter)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_table.params.*columns">*columns (alembic.operations.Operations.create_table parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="A">A</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.add_column">add_column() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.add_column&quot;&gt;(alembic.operations.BatchOperations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.add_column">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.AddColumnOp.add_column">(alembic.operations.ops.AddColumnOp class method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.base.add_column">(in module alembic.ddl.base)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.add_constraint">add_constraint() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.add_constraint&quot;&gt;(alembic.ddl.sqlite.SQLiteImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.add_revision">add_revision() (alembic.script.revision.RevisionMap method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.AddColumn">AddColumn (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AddColumnOp">AddColumnOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AddConstraintOp">AddConstraintOp (class in alembic.operations.ops)</a>
</li>
      <li>
    alembic.command
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#module-alembic.command&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.config
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/config.html#module-alembic.config&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.base
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.base&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.impl
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.impl&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.mssql
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.mssql&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.mysql
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.mysql&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.postgresql
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.postgresql&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.ddl.sqlite
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#module-alembic.ddl.sqlite&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.operations
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#module-alembic.operations&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.operations.ops
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/operations.html#module-alembic.operations.ops&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.runtime.environment
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#module-alembic.runtime.environment&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li>
    alembic.runtime.migration
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#module-alembic.runtime.migration&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.script
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#module-alembic.script&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.script.revision
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#module-alembic.script.revision&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li>
    alembic.script.write_hooks
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#module-alembic.script.write_hooks&quot;&gt;module&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.alembic_module_prefix">alembic_module_prefix (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.alter_column">alter_column() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.alter_column&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl.alter_column">(alembic.ddl.mysql.MySQLImpl method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.alter_column">(alembic.ddl.postgresql.PostgresqlImpl method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.BatchOperations.alter_column">(alembic.operations.BatchOperations method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.alter_column">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.AlterColumnOp.alter_column">(alembic.operations.ops.AlterColumnOp class method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.base.alter_column">(in module alembic.ddl.base)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.alter_table">alter_table() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.AlterColumn">AlterColumn (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AlterColumnOp">AlterColumnOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.AlterTable">AlterTable (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AlterTableOp">AlterTableOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.Params.args">args (alembic.ddl.impl.Params property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.as_revision_number">as_revision_number() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.attributes">attributes (alembic.config.Config attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/config.html#alembic.config.Config.params.attributes&quot;&gt;(alembic.config.Config parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.autocommit_block">autocommit_block() (alembic.runtime.migration.MigrationContext method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.autogen_column_reflect">autogen_column_reflect() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.autogen_column_reflect&quot;&gt;(alembic.ddl.postgresql.PostgresqlImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.autogen_column_reflect">(alembic.ddl.sqlite.SQLiteImpl method)</a>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext">AutogenContext (class in alembic.autogenerate.api)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.revision.params.autogenerate">autogenerate (alembic.command.revision parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.autoincrement">autoincrement (alembic.operations.Operations.alter_column parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="B">B</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.walk_revisions.params.base">base (alembic.script.ScriptDirectory.walk_revisions parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.bases">bases (alembic.script.revision.RevisionMap attribute)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AddColumnOp.batch_add_column">batch_add_column() (alembic.operations.ops.AddColumnOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.AlterColumnOp.batch_alter_column">batch_alter_column() (alembic.operations.ops.AlterColumnOp class method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table">batch_alter_table() (alembic.operations.Operations method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateCheckConstraintOp.batch_create_check_constraint">batch_create_check_constraint() (alembic.operations.ops.CreateCheckConstraintOp class method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp.batch_create_exclude_constraint">batch_create_exclude_constraint() (alembic.ddl.postgresql.CreateExcludeConstraintOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateForeignKeyOp.batch_create_foreign_key">batch_create_foreign_key() (alembic.operations.ops.CreateForeignKeyOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateIndexOp.batch_create_index">batch_create_index() (alembic.operations.ops.CreateIndexOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreatePrimaryKeyOp.batch_create_primary_key">batch_create_primary_key() (alembic.operations.ops.CreatePrimaryKeyOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableCommentOp.batch_create_table_comment">batch_create_table_comment() (alembic.operations.ops.CreateTableCommentOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateUniqueConstraintOp.batch_create_unique_constraint">batch_create_unique_constraint() (alembic.operations.ops.CreateUniqueConstraintOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropColumnOp.batch_drop_column">batch_drop_column() (alembic.operations.ops.DropColumnOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropConstraintOp.batch_drop_constraint">batch_drop_constraint() (alembic.operations.ops.DropConstraintOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropIndexOp.batch_drop_index">batch_drop_index() (alembic.operations.ops.DropIndexOp class method)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropTableCommentOp.batch_drop_table_comment">batch_drop_table_comment() (alembic.operations.ops.DropTableCommentOp class method)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.mssql.MSSQLImpl.batch_separator">batch_separator (alembic.ddl.mssql.MSSQLImpl attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations">BatchOperations (class in alembic.operations)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.begin_transaction">begin_transaction() (alembic.runtime.environment.EnvironmentContext method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.begin_transaction&quot;&gt;(alembic.runtime.migration.MigrationContext method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.bind">bind (alembic.ddl.impl.DefaultImpl property)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.bind&quot;&gt;(alembic.runtime.migration.MigrationContext property)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.merge.params.branch_label">branch_label (alembic.command.merge parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.revision.params.branch_label&quot;&gt;(alembic.command.revision parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.get_current_head.params.branch_label">(alembic.script.revision.RevisionMap.get_current_head parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.branch_labels">branch_labels (alembic.script.revision.Revision attribute)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.branches">branches() (in module alembic.command)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.bulk_insert">bulk_insert() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.bulk_insert&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.bulk_insert">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.BulkInsertOp.bulk_insert">(alembic.operations.ops.BulkInsertOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/operations.html#alembic.operations.ops.BulkInsertOp">BulkInsertOp (class in alembic.operations.ops)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="C">C</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.cast_for_batch_migrate">cast_for_batch_migrate() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.cast_for_batch_migrate&quot;&gt;(alembic.ddl.sqlite.SQLiteImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.rewriter.Rewriter.chain">chain() (alembic.autogenerate.rewriter.Rewriter method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.cmd_opts">cmd_opts (alembic.config.Config attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.add_column.params.column">column (alembic.operations.Operations.add_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.column_name">column_name (alembic.operations.Operations.alter_column parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.drop_column.params.column_name&quot;&gt;(alembic.operations.Operations.drop_column parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ColumnComment">ColumnComment (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ColumnDefault">ColumnDefault (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ColumnName">ColumnName (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ColumnNullable">ColumnNullable (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.columns">columns (alembic.operations.Operations.create_index parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_primary_key.params.columns&quot;&gt;(alembic.operations.Operations.create_primary_key parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.columns">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ColumnType">ColumnType (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.command_terminator">command_terminator (alembic.ddl.impl.DefaultImpl attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_table_comment.params.comment">comment (alembic.operations.BatchOperations.create_table_comment parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.alter_column.params.comment&quot;&gt;(alembic.operations.Operations.alter_column parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table_comment.params.comment">(alembic.operations.Operations.create_table_comment parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.compare_metadata">compare_metadata() (in module alembic.autogenerate)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_server_default">compare_server_default (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.compare_server_default">compare_server_default() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.compare_server_default&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl.compare_server_default">(alembic.ddl.mysql.MySQLImpl method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.compare_server_default">(alembic.ddl.postgresql.PostgresqlImpl method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.compare_server_default">(alembic.ddl.sqlite.SQLiteImpl method)</a>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.compare_type">compare_type (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.compare_type">compare_type() (alembic.ddl.impl.DefaultImpl method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.ComputedColumnDefault">ComputedColumnDefault (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.condition">condition (alembic.operations.Operations.create_check_constraint parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.branches.params.config">config (alembic.command.branches parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.current.params.config&quot;&gt;(alembic.command.current parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/commands.html#alembic.command.downgrade.params.config">(alembic.command.downgrade parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.edit.params.config">(alembic.command.edit parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.ensure_version.params.config">(alembic.command.ensure_version parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.heads.params.config">(alembic.command.heads parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.history.params.config">(alembic.command.history parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.init.params.config">(alembic.command.init parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.list_templates.params.config">(alembic.command.list_templates parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.merge.params.config">(alembic.command.merge parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.revision.params.config">(alembic.command.revision parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.show.params.config">(alembic.command.show parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.stamp.params.config">(alembic.command.stamp parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.upgrade.params.config">(alembic.command.upgrade parameter)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.config">(alembic.runtime.environment.EnvironmentContext attribute)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.params.config">(alembic.runtime.environment.EnvironmentContext parameter)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.config">(alembic.runtime.migration.MigrationContext property)</a>
</li>
      </ul></li>
      <li><a href="en/api/config.html#alembic.config.Config">Config (class in alembic.config)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.params.config_args">config_args (alembic.config.Config parameter)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.config_file_name">config_file_name (alembic.config.Config attribute)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.config_ini_section">config_ini_section (alembic.config.Config attribute)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure">configure() (alembic.runtime.environment.EnvironmentContext method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.configure&quot;&gt;(alembic.runtime.migration.MigrationContext class method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.connection">connection (alembic.autogenerate.api.AutogenContext attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.connection&quot;&gt;(alembic.runtime.environment.EnvironmentContext.configure parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.configure.params.connection">(alembic.runtime.migration.MigrationContext.configure parameter)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.constraint_name">constraint_name (alembic.operations.Operations.create_foreign_key parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_primary_key.params.constraint_name&quot;&gt;(alembic.operations.Operations.create_primary_key parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_constraint.params.constraint_name">(alembic.operations.Operations.drop_constraint parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp.constraint_type">constraint_type (alembic.ddl.postgresql.CreateExcludeConstraintOp attribute)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.compare_metadata.params.context">context (alembic.autogenerate.compare_metadata parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.copy_from">copy_from (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.correct_for_autogen_constraints">correct_for_autogen_constraints() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mysql.MySQLImpl.correct_for_autogen_constraints&quot;&gt;(alembic.ddl.mysql.MySQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.correct_for_autogen_constraints">(alembic.ddl.postgresql.PostgresqlImpl method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.correct_for_autogen_foreignkeys">correct_for_autogen_foreignkeys() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mysql.MySQLImpl.correct_for_autogen_foreignkeys&quot;&gt;(alembic.ddl.mysql.MySQLImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_check_constraint">create_check_constraint() (alembic.operations.BatchOperations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_check_constraint&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateCheckConstraintOp.create_check_constraint">(alembic.operations.ops.CreateCheckConstraintOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.create_column_comment">create_column_comment() (alembic.ddl.impl.DefaultImpl method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp.create_exclude_constraint">create_exclude_constraint() (alembic.ddl.postgresql.CreateExcludeConstraintOp class method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.create_exclude_constraint&quot;&gt;(alembic.operations.BatchOperations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint">(alembic.operations.Operations method)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_foreign_key">create_foreign_key() (alembic.operations.BatchOperations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_foreign_key&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateForeignKeyOp.create_foreign_key">(alembic.operations.ops.CreateForeignKeyOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.create_index">create_index() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.create_index&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.create_index">(alembic.ddl.postgresql.PostgresqlImpl method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.BatchOperations.create_index">(alembic.operations.BatchOperations method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_index">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateIndexOp.create_index">(alembic.operations.ops.CreateIndexOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_primary_key">create_primary_key() (alembic.operations.BatchOperations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_primary_key&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreatePrimaryKeyOp.create_primary_key">(alembic.operations.ops.CreatePrimaryKeyOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.create_table">create_table() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_table&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableOp.create_table">(alembic.operations.ops.CreateTableOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.create_table_comment">create_table_comment() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.create_table_comment&quot;&gt;(alembic.operations.BatchOperations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table_comment">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableCommentOp.create_table_comment">(alembic.operations.ops.CreateTableCommentOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_unique_constraint">create_unique_constraint() (alembic.operations.BatchOperations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_unique_constraint&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.CreateUniqueConstraintOp.create_unique_constraint">(alembic.operations.ops.CreateUniqueConstraintOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateCheckConstraintOp">CreateCheckConstraintOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp">CreateExcludeConstraintOp (class in alembic.ddl.postgresql)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateForeignKeyOp">CreateForeignKeyOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateIndexOp">CreateIndexOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreatePrimaryKeyOp">CreatePrimaryKeyOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableCommentOp">CreateTableCommentOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableOp">CreateTableOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateUniqueConstraintOp">CreateUniqueConstraintOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.current">current() (in module alembic.command)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.CycleDetected">CycleDetected</a>
</li>
  </ul></td>
</tr></table>
<h2 id="D">D</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl">DefaultImpl (class in alembic.ddl.impl)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.deferrable">deferrable (alembic.operations.Operations.create_check_constraint parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_exclude_constraint.params.deferrable&quot;&gt;(alembic.operations.Operations.create_exclude_constraint parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.deferrable">(alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.deferrable">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.dependencies">dependencies (alembic.script.revision.Revision attribute)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.DependencyCycleDetected">DependencyCycleDetected</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.DependencyLoopDetected">DependencyLoopDetected</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.revision.params.depends_on">depends_on (alembic.command.revision parameter)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.dialect">dialect (alembic.autogenerate.api.AutogenContext attribute)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.dialect_name">dialect_name (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.configure.params.dialect_name&quot;&gt;(alembic.runtime.migration.MigrationContext.configure parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.dialect_opts">dialect_opts (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.init.params.directory">directory (alembic.command.init parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.Script.doc">doc (alembic.script.Script property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.down_revision">down_revision (alembic.script.revision.Revision attribute)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.downgrade">downgrade() (in module alembic.command)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrationScript.downgrade_ops">downgrade_ops (alembic.operations.ops.MigrationScript property)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrationScript.downgrade_ops_list">downgrade_ops_list (alembic.operations.ops.MigrationScript property)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.downgrade_token">downgrade_token (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DowngradeOps">DowngradeOps (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.drop_column">drop_column() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.drop_column&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.BatchOperations.drop_column">(alembic.operations.BatchOperations method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_column">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.DropColumnOp.drop_column">(alembic.operations.ops.DropColumnOp class method)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.base.drop_column">(in module alembic.ddl.base)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.drop_constraint">drop_constraint() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mysql.MySQLImpl.drop_constraint&quot;&gt;(alembic.ddl.mysql.MySQLImpl method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.drop_constraint">(alembic.ddl.sqlite.SQLiteImpl method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.BatchOperations.drop_constraint">(alembic.operations.BatchOperations method)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_constraint">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.DropConstraintOp.drop_constraint">(alembic.operations.ops.DropConstraintOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.drop_index">drop_index() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.drop_index&quot;&gt;(alembic.operations.BatchOperations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_index">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.DropIndexOp.drop_index">(alembic.operations.ops.DropIndexOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.drop_table">drop_table() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.drop_table&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.DropTableOp.drop_table">(alembic.operations.ops.DropTableOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.drop_table_comment">drop_table_comment() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.drop_table_comment&quot;&gt;(alembic.operations.BatchOperations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table_comment">(alembic.operations.Operations method)</a>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.DropTableCommentOp.drop_table_comment">(alembic.operations.ops.DropTableCommentOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.DropColumn">DropColumn (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropColumnOp">DropColumnOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropConstraintOp">DropConstraintOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropIndexOp">DropIndexOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropTableCommentOp">DropTableCommentOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.DropTableOp">DropTableOp (class in alembic.operations.ops)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="E">E</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.edit">edit() (in module alembic.command)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint.params.elements">elements (alembic.operations.Operations.create_exclude_constraint parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.emit_begin">emit_begin() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.emit_begin&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.emit_commit">emit_commit() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.emit_commit&quot;&gt;(alembic.ddl.mssql.MSSQLImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.ensure_version">ensure_version() (in module alembic.command)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext">EnvironmentContext (class in alembic.runtime.environment)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.execute">execute() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.execute&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.ExecuteSQLOp.execute">(alembic.operations.ops.ExecuteSQLOp class method)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.execute">(alembic.runtime.environment.EnvironmentContext method)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.execute">(alembic.runtime.migration.MigrationContext method)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/operations.html#alembic.operations.ops.ExecuteSQLOp">ExecuteSQLOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.execute.params.execution_options">execution_options (alembic.operations.Operations.execute parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.existing_autoincrement">existing_autoincrement (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.create_table_comment.params.existing_comment">existing_comment (alembic.operations.BatchOperations.create_table_comment parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.drop_table_comment.params.existing_comment&quot;&gt;(alembic.operations.BatchOperations.drop_table_comment parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.existing_comment">(alembic.operations.Operations.alter_column parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table_comment.params.existing_comment">(alembic.operations.Operations.create_table_comment parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table_comment.params.existing_comment">(alembic.operations.Operations.drop_table_comment parameter)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.existing_nullable">existing_nullable (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.existing_server_default">existing_server_default (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.existing_type">existing_type (alembic.operations.Operations.alter_column parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="F">F</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.f">f() (alembic.operations.Operations method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.params.file_">file_ (alembic.config.Config parameter)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.file_config">file_config (alembic.config.Config attribute)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.format_column_name">format_column_name() (in module alembic.ddl.base)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.base.format_server_default">format_server_default() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.format_table_name">format_table_name() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.format_type">format_type() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.from_config">from_config() (alembic.script.ScriptDirectory class method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp.from_constraint">from_constraint() (alembic.ddl.postgresql.CreateExcludeConstraintOp class method)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="G">G</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.generate_revision">generate_revision() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.params.generator">generator (alembic.script.revision.RevisionMap parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.get_base">get_base() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.get_bases">get_bases() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.get_bind">get_bind() (alembic.operations.Operations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_bind&quot;&gt;(alembic.runtime.environment.EnvironmentContext method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.get_by_dialect">get_by_dialect() (alembic.ddl.impl.DefaultImpl class method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.get_context">get_context() (alembic.operations.Operations method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_context&quot;&gt;(alembic.runtime.environment.EnvironmentContext method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.get_current_head">get_current_head() (alembic.script.revision.RevisionMap method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.get_current_head&quot;&gt;(alembic.script.ScriptDirectory method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.get_current_heads">get_current_heads() (alembic.runtime.migration.MigrationContext method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.get_current_revision">get_current_revision() (alembic.runtime.migration.MigrationContext method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_head_revision">get_head_revision() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_head_revisions">get_head_revisions() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.get_heads">get_heads() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.get_main_option">get_main_option() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.get_revision">get_revision() (alembic.script.revision.RevisionMap method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.get_revision&quot;&gt;(alembic.script.ScriptDirectory method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_revision_argument">get_revision_argument() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.get_revisions">get_revisions() (alembic.script.revision.RevisionMap method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.get_revisions&quot;&gt;(alembic.script.ScriptDirectory method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/config.html#alembic.config.Config.get_section">get_section() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.get_section_option">get_section_option() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_starting_revision_argument">get_starting_revision_argument() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_tag_argument">get_tag_argument() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.get_template_directory">get_template_directory() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.get_x_argument">get_x_argument() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="H">H</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.revision.params.head">head (alembic.command.revision parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.generate_revision.params.head&quot;&gt;(alembic.script.ScriptDirectory.generate_revision parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/script.html#alembic.script.ScriptDirectory.walk_revisions.params.head">(alembic.script.ScriptDirectory.walk_revisions parameter)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.heads">heads (alembic.script.revision.RevisionMap attribute)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.heads">heads() (in module alembic.command)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.history">history() (in module alembic.command)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="I">I</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.identity_attrs_ignore">identity_attrs_ignore (alembic.ddl.impl.DefaultImpl attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.identity_attrs_ignore&quot;&gt;(alembic.ddl.mssql.MSSQLImpl attribute)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.identity_attrs_ignore">(alembic.ddl.postgresql.PostgresqlImpl attribute)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.IdentityColumnDefault">IdentityColumnDefault (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.implementation_for">implementation_for() (alembic.operations.Operations class method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.ImplMeta">ImplMeta (class in alembic.ddl.impl)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.imports">imports (alembic.autogenerate.api.AutogenContext attribute)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_name">include_name (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_object">include_object (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.include_schemas">include_schemas (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.index_name">index_name (alembic.operations.Operations.create_index parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.drop_index.params.index_name&quot;&gt;(alembic.operations.Operations.drop_index parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.history.params.indicate_current">indicate_current (alembic.command.history parameter)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrateOperation.info">info (alembic.operations.ops.MigrateOperation attribute)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.params.ini_section">ini_section (alembic.config.Config parameter)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.init">init() (in module alembic.command)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.initially">initially (alembic.operations.Operations.create_check_constraint parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.create_exclude_constraint.params.initially&quot;&gt;(alembic.operations.Operations.create_exclude_constraint parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.initially">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.Operations.inline_literal">inline_literal() (alembic.operations.Operations method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.BatchOperations.alter_column.params.insert_before">insert_before (alembic.operations.BatchOperations.alter_column parameter)</a>, <a href="en/ops.html#alembic.operations.BatchOperations.alter_column.params.insert_before">[1]</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.invoke">invoke() (alembic.operations.Operations method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.is_base">is_base (alembic.script.revision.Revision property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.is_branch_point">is_branch_point (alembic.script.revision.Revision property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.is_head">is_head (alembic.script.revision.Revision property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.is_merge_point">is_merge_point (alembic.script.revision.Revision property)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.is_offline_mode">is_offline_mode() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.is_transactional_ddl">is_transactional_ddl() (alembic.runtime.environment.EnvironmentContext method)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap.iterate_revisions">iterate_revisions() (alembic.script.revision.RevisionMap method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.iterate_revisions&quot;&gt;(alembic.script.ScriptDirectory method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
  </ul></td>
</tr></table>
<h2 id="K">K</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.Params.kwargs">kwargs (alembic.ddl.impl.Params property)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="L">L</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.list_templates">list_templates() (in module alembic.command)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.literal_binds">literal_binds (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.local_cols">local_cols (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.Script.longdoc">longdoc (alembic.script.Script property)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.LoopDetected">LoopDetected</a>
</li>
  </ul></td>
</tr></table>
<h2 id="M">M</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/config.html#alembic.config.main">main() (in module alembic.config)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mysql.MariaDBImpl">MariaDBImpl (class in alembic.ddl.mysql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mssql.MSSQLImpl.memo">memo (alembic.ddl.mssql.MSSQLImpl attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mysql.MariaDBImpl.memo&quot;&gt;(alembic.ddl.mysql.MariaDBImpl attribute)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl.memo">(alembic.ddl.mysql.MySQLImpl attribute)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.memo">(alembic.ddl.postgresql.PostgresqlImpl attribute)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.memo">(alembic.ddl.sqlite.SQLiteImpl attribute)</a>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.merge">merge() (in module alembic.command)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.merge.params.message">message (alembic.command.merge parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.revision.params.message&quot;&gt;(alembic.command.revision parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/script.html#alembic.script.ScriptDirectory.generate_revision.params.message">(alembic.script.ScriptDirectory.generate_revision parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.metadata">metadata (alembic.autogenerate.api.AutogenContext attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/autogenerate.html#alembic.autogenerate.compare_metadata.params.metadata&quot;&gt;(alembic.autogenerate.compare_metadata parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrateOperation">MigrateOperation (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.migration_context">migration_context (alembic.autogenerate.api.AutogenContext attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.BatchOperations.params.migration_context&quot;&gt;(alembic.operations.BatchOperations parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.params.migration_context">(alembic.operations.Operations parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext">MigrationContext (class in alembic.runtime.migration)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrationScript">MigrationScript (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.ModifyTableOps">ModifyTableOps (class in alembic.operations.ops)</a>
</li>
      <li>
    module
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#module-alembic.command&quot;&gt;alembic.command&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/config.html#module-alembic.config">alembic.config</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl">alembic.ddl</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.base">alembic.ddl.base</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.impl">alembic.ddl.impl</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.mssql">alembic.ddl.mssql</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.mysql">alembic.ddl.mysql</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.postgresql">alembic.ddl.postgresql</a>
</li>
        <li><a href="en/api/ddl.html#module-alembic.ddl.sqlite">alembic.ddl.sqlite</a>
</li>
        <li><a href="en/ops.html#module-alembic.operations">alembic.operations</a>
</li>
        <li><a href="en/api/operations.html#module-alembic.operations.ops">alembic.operations.ops</a>
</li>
        <li><a href="en/api/runtime.html#module-alembic.runtime.environment">alembic.runtime.environment</a>
</li>
        <li><a href="en/api/runtime.html#module-alembic.runtime.migration">alembic.runtime.migration</a>
</li>
        <li><a href="en/api/script.html#module-alembic.script">alembic.script</a>
</li>
        <li><a href="en/api/script.html#module-alembic.script.revision">alembic.script.revision</a>
</li>
        <li><a href="en/api/script.html#module-alembic.script.write_hooks">alembic.script.write_hooks</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.Script.module">module (alembic.script.Script attribute)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mssql.mssql_add_column">mssql_add_column() (in module alembic.ddl.mssql)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.mssql_batch_separator">mssql_batch_separator (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.drop_column.params.mssql_drop_check">mssql_drop_check (alembic.operations.Operations.drop_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.drop_column.params.mssql_drop_default">mssql_drop_default (alembic.operations.Operations.drop_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.drop_column.params.mssql_drop_foreign_key">mssql_drop_foreign_key (alembic.operations.Operations.drop_column parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mssql.MSSQLImpl">MSSQLImpl (class in alembic.ddl.mssql)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.bulk_insert.params.multiinsert">multiinsert (alembic.operations.Operations.bulk_insert parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.MultipleHeads">MultipleHeads</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLAlterDefault">MySQLAlterDefault (class in alembic.ddl.mysql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLChangeColumn">MySQLChangeColumn (class in alembic.ddl.mysql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl">MySQLImpl (class in alembic.ddl.mysql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLModifyColumn">MySQLModifyColumn (class in alembic.ddl.mysql)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="N">N</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/config.html#alembic.config.Config.set_main_option.params.name">name (alembic.config.Config.set_main_option parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/config.html#alembic.config.Config.set_section_option.params.name&quot;&gt;(alembic.config.Config.set_section_option parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.name">(alembic.operations.Operations.create_check_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint.params.name">(alembic.operations.Operations.create_exclude_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.name">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.naming_convention">naming_convention (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.new_column_name">new_column_name (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.rename_table.params.new_table_name">new_table_name (alembic.operations.Operations.rename_table parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision.nextrev">nextrev (alembic.script.revision.Revision attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.nullable">nullable (alembic.operations.Operations.alter_column parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="O">O</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.rename_table.params.old_table_name">old_table_name (alembic.operations.Operations.rename_table parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.on_version_apply">on_version_apply (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.ondelete">ondelete (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.onupdate">onupdate (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.OpContainer">OpContainer (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations">Operations (class in alembic.operations)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.configure.params.opts">opts (alembic.runtime.migration.MigrationContext.configure parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.oracle_batch_separator">oracle_batch_separator (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.rewriter.Rewriter.chain.params.other">other (alembic.autogenerate.rewriter.Rewriter.chain parameter)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.params.output_buffer">output_buffer (alembic.config.Config parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.output_buffer&quot;&gt;(alembic.runtime.environment.EnvironmentContext.configure parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.output_encoding">output_encoding (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="P">P</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.init.params.package">package (alembic.command.init parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.Params">Params (class in alembic.ddl.impl)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.partial_reordering">partial_reordering (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.Script.path">path (alembic.script.Script attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.postgresql_using">postgresql_using (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlColumnType">PostgresqlColumnType (class in alembic.ddl.postgresql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl">PostgresqlImpl (class in alembic.ddl.postgresql)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.prep_table_for_batch">prep_table_for_batch() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.prep_table_for_batch&quot;&gt;(alembic.ddl.postgresql.PostgresqlImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/config.html#alembic.config.Config.print_stdout">print_stdout() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.revision.params.process_revision_directives">process_revision_directives (alembic.command.revision parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.process_revision_directives&quot;&gt;(alembic.runtime.environment.EnvironmentContext.configure parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.produce_migrations">produce_migrations() (in module alembic.autogenerate)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.stamp.params.purge">purge (alembic.command.stamp parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="Q">Q</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.quote">quote (alembic.operations.Operations.create_index parameter)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.base.quote_dotted">quote_dotted() (in module alembic.ddl.base)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="R">R</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.revision.RangeNotAncestorError">RangeNotAncestorError</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.recreate">recreate (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.referent_schema">referent_schema (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.referent_table">referent_table (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.reflect_args">reflect_args (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.reflect_kwargs">reflect_kwargs (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.generate_revision.params.refresh">refresh (alembic.script.ScriptDirectory.generate_revision parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.write_hooks.register">register() (in module alembic.script.write_hooks)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.register_operation">register_operation() (alembic.operations.Operations class method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.remote_cols">remote_cols (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.rename_table">rename_table() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.rename_table&quot;&gt;(alembic.operations.Operations method)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/operations.html#alembic.operations.ops.RenameTableOp.rename_table">(alembic.operations.ops.RenameTableOp class method)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.RenameTable">RenameTable (class in alembic.ddl.base)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.RenameTableOp">RenameTableOp (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.render_as_batch">render_as_batch (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.render_ddl_sql_expr">render_ddl_sql_expr() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.render_ddl_sql_expr&quot;&gt;(alembic.ddl.sqlite.SQLiteImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.render_item">render_item (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.render_python_code">render_python_code() (in module alembic.autogenerate)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.render_type">render_type() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.render_type&quot;&gt;(alembic.ddl.postgresql.PostgresqlImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.requires_recreate_in_batch">requires_recreate_in_batch() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.requires_recreate_in_batch&quot;&gt;(alembic.ddl.sqlite.SQLiteImpl method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.ResolutionError">ResolutionError</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/commands.html#alembic.command.heads.params.resolve_dependencies">resolve_dependencies (alembic.command.heads parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.edit.params.rev">rev (alembic.command.edit parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.merge.params.rev_id">rev_id (alembic.command.merge parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.revision.params.rev_id&quot;&gt;(alembic.command.revision parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.history.params.rev_range">rev_range (alembic.command.history parameter)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.CreateTableCommentOp.reverse">reverse() (alembic.operations.ops.CreateTableCommentOp method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/operations.html#alembic.operations.ops.DropTableCommentOp.reverse&quot;&gt;(alembic.operations.ops.DropTableCommentOp method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.generate_revision.params.revid">revid (alembic.script.ScriptDirectory.generate_revision parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.downgrade.params.revision">revision (alembic.command.downgrade parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.show.params.revision&quot;&gt;(alembic.command.show parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/commands.html#alembic.command.stamp.params.revision">(alembic.command.stamp parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.upgrade.params.revision">(alembic.command.upgrade parameter)</a>
</li>
        <li><a href="en/api/script.html#alembic.script.revision.Revision.revision">(alembic.script.revision.Revision attribute)</a>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.revision.Revision">Revision (class in alembic.script.revision)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.revision">revision() (in module alembic.command)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionError">RevisionError</a>
</li>
      <li><a href="en/api/script.html#alembic.script.revision.RevisionMap">RevisionMap (class in alembic.script.revision)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.rewriter.Rewriter">Rewriter (class in alembic.autogenerate.rewriter)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.rewriter.Rewriter.rewrites">rewrites() (alembic.autogenerate.rewriter.Rewriter method)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.bulk_insert.params.rows">rows (alembic.operations.Operations.bulk_insert parameter)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.run_env">run_env() (alembic.script.ScriptDirectory method)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.run_filters">run_filters() (alembic.autogenerate.api.AutogenContext method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.run_migrations">run_migrations() (alembic.runtime.environment.EnvironmentContext method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.run_migrations&quot;&gt;(alembic.runtime.migration.MigrationContext method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.run_name_filters">run_name_filters() (alembic.autogenerate.api.AutogenContext method)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.run_object_filters">run_object_filters() (alembic.autogenerate.api.AutogenContext method)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="S">S</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.add_column.params.schema">schema (alembic.operations.Operations.add_column parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.alter_column.params.schema&quot;&gt;(alembic.operations.Operations.alter_column parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.schema">(alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.schema">(alembic.operations.Operations.create_check_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint.params.schema">(alembic.operations.Operations.create_exclude_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.schema">(alembic.operations.Operations.create_index parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_primary_key.params.schema">(alembic.operations.Operations.create_primary_key parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table.params.schema">(alembic.operations.Operations.create_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.schema">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_column.params.schema">(alembic.operations.Operations.drop_column parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_constraint.params.schema">(alembic.operations.Operations.drop_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_index.params.schema">(alembic.operations.Operations.drop_index parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table.params.schema">(alembic.operations.Operations.drop_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.rename_table.params.schema">(alembic.operations.Operations.rename_table parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.script">script (alembic.runtime.environment.EnvironmentContext attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.params.script&quot;&gt;(alembic.runtime.environment.EnvironmentContext parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/script.html#alembic.script.Script">Script (class in alembic.script)</a>
</li>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory">ScriptDirectory (class in alembic.script)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.set_section_option.params.section">section (alembic.config.Config.set_section_option parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.server_default">server_default (alembic.operations.Operations.alter_column parameter)</a>
</li>
      <li><a href="en/api/config.html#alembic.config.Config.set_main_option">set_main_option() (alembic.config.Config method)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/config.html#alembic.config.Config.set_section_option">set_section_option() (alembic.config.Config method)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.show">show() (in module alembic.command)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.sorted_tables">sorted_tables (alembic.autogenerate.api.AutogenContext attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.source_schema">source_schema (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.create_foreign_key.params.source_table">source_table (alembic.operations.Operations.create_foreign_key parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.revision.params.splice">splice (alembic.command.revision parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/script.html#alembic.script.ScriptDirectory.generate_revision.params.splice&quot;&gt;(alembic.script.ScriptDirectory.generate_revision parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.downgrade.params.sql">sql (alembic.command.downgrade parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.ensure_version.params.sql&quot;&gt;(alembic.command.ensure_version parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/commands.html#alembic.command.revision.params.sql">(alembic.command.revision parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.stamp.params.sql">(alembic.command.stamp parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.upgrade.params.sql">(alembic.command.upgrade parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.sqlalchemy_module_prefix">sqlalchemy_module_prefix (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl">SQLiteImpl (class in alembic.ddl.sqlite)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.execute.params.sqltext">sqltext (alembic.operations.Operations.execute parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.migration.MigrationContext.stamp">stamp() (alembic.runtime.migration.MigrationContext method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.stamp&quot;&gt;(in module alembic.command)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.start_migrations">start_migrations() (alembic.ddl.impl.DefaultImpl method)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.starting_rev">starting_rev (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.static_output">static_output() (alembic.ddl.impl.DefaultImpl method)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.environment.EnvironmentContext.static_output&quot;&gt;(alembic.runtime.environment.EnvironmentContext method)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/config.html#alembic.config.Config.params.stdout">stdout (alembic.config.Config parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="T">T</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.bulk_insert.params.table">table (alembic.operations.Operations.bulk_insert parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.table_args">table_args (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/api/autogenerate.html#alembic.autogenerate.api.AutogenContext.table_key_to_table">table_key_to_table (alembic.autogenerate.api.AutogenContext attribute)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.table_kwargs">table_kwargs (alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
      <li><a href="en/ops.html#alembic.operations.Operations.add_column.params.table_name">table_name (alembic.operations.Operations.add_column parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.alter_column.params.table_name&quot;&gt;(alembic.operations.Operations.alter_column parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.batch_alter_table.params.table_name">(alembic.operations.Operations.batch_alter_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_check_constraint.params.table_name">(alembic.operations.Operations.create_check_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint.params.table_name">(alembic.operations.Operations.create_exclude_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.table_name">(alembic.operations.Operations.create_index parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_primary_key.params.table_name">(alembic.operations.Operations.create_primary_key parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table.params.table_name">(alembic.operations.Operations.create_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_table_comment.params.table_name">(alembic.operations.Operations.create_table_comment parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.create_unique_constraint.params.table_name">(alembic.operations.Operations.create_unique_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_column.params.table_name">(alembic.operations.Operations.drop_column parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_constraint.params.table_name">(alembic.operations.Operations.drop_constraint parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_index.params.table_name">(alembic.operations.Operations.drop_index parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table.params.table_name">(alembic.operations.Operations.drop_table parameter)</a>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.drop_table_comment.params.table_name">(alembic.operations.Operations.drop_table_comment parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.downgrade.params.tag">tag (alembic.command.downgrade parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.stamp.params.tag&quot;&gt;(alembic.command.stamp parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/commands.html#alembic.command.upgrade.params.tag">(alembic.command.upgrade parameter)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.tag">(alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.target_metadata">target_metadata (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.init.params.template">template (alembic.command.init parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.template_args">template_args (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.CreateExcludeConstraintOp.to_constraint">to_constraint() (alembic.ddl.postgresql.CreateExcludeConstraintOp method)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.Params.token0">token0 (alembic.ddl.impl.Params property)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.Params.tokens">tokens (alembic.ddl.impl.Params property)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.transaction_per_migration">transaction_per_migration (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.transactional_ddl">transactional_ddl (alembic.ddl.impl.DefaultImpl attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.transactional_ddl&quot;&gt;(alembic.ddl.mssql.MSSQLImpl attribute)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl.transactional_ddl">(alembic.ddl.mysql.MySQLImpl attribute)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.transactional_ddl">(alembic.ddl.postgresql.PostgresqlImpl attribute)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.sqlite.SQLiteImpl.transactional_ddl">(alembic.ddl.sqlite.SQLiteImpl attribute)</a>
</li>
        <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.transactional_ddl">(alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      </ul></li>
      <li><a href="en/ops.html#alembic.operations.Operations.alter_column.params.type_">type_ (alembic.operations.Operations.alter_column parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;ops.html#alembic.operations.Operations.drop_constraint.params.type_&quot;&gt;(alembic.operations.Operations.drop_constraint parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.inline_literal.params.type_">(alembic.operations.Operations.inline_literal parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.type_arg_extract">type_arg_extract (alembic.ddl.impl.DefaultImpl attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mysql.MySQLImpl.type_arg_extract&quot;&gt;(alembic.ddl.mysql.MySQLImpl attribute)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.impl.DefaultImpl.type_synonyms">type_synonyms (alembic.ddl.impl.DefaultImpl attribute)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.MSSQLImpl.type_synonyms&quot;&gt;(alembic.ddl.mssql.MSSQLImpl attribute)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.mysql.MySQLImpl.type_synonyms">(alembic.ddl.mysql.MySQLImpl attribute)</a>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.PostgresqlImpl.type_synonyms">(alembic.ddl.postgresql.PostgresqlImpl attribute)</a>
</li>
      </ul></li>
  </ul></td>
</tr></table>
<h2 id="U">U</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_index.params.unique">unique (alembic.operations.Operations.create_index parameter)</a>
</li>
      <li><a href="en/api/commands.html#alembic.command.upgrade">upgrade() (in module alembic.command)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrationScript.upgrade_ops">upgrade_ops (alembic.operations.ops.MigrationScript property)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.MigrationScript.upgrade_ops_list">upgrade_ops_list (alembic.operations.ops.MigrationScript property)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.upgrade_token">upgrade_token (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/operations.html#alembic.operations.ops.UpgradeOps">UpgradeOps (class in alembic.operations.ops)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.url">url (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/runtime.html#alembic.runtime.migration.MigrationContext.configure.params.url&quot;&gt;(alembic.runtime.migration.MigrationContext.configure parameter)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.user_module_prefix">user_module_prefix (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
  </ul></td>
</tr></table>
<h2 id="V">V</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/config.html#alembic.config.Config.set_main_option.params.value">value (alembic.config.Config.set_main_option parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/config.html#alembic.config.Config.set_section_option.params.value&quot;&gt;(alembic.config.Config.set_section_option parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/ops.html#alembic.operations.Operations.inline_literal.params.value">(alembic.operations.Operations.inline_literal parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.branches.params.verbose">verbose (alembic.command.branches parameter)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/commands.html#alembic.command.current.params.verbose&quot;&gt;(alembic.command.current parameter)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/commands.html#alembic.command.heads.params.verbose">(alembic.command.heads parameter)</a>
</li>
        <li><a href="en/api/commands.html#alembic.command.history.params.verbose">(alembic.command.history parameter)</a>
</li>
      </ul></li>
      <li><a href="en/api/commands.html#alembic.command.revision.params.version_path">version_path (alembic.command.revision parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.version_table">version_table (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.version_table_pk">version_table_pk (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/runtime.html#alembic.runtime.environment.EnvironmentContext.configure.params.version_table_schema">version_table_schema (alembic.runtime.environment.EnvironmentContext.configure parameter)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_add_column">visit_add_column() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.visit_add_column&quot;&gt;(in module alembic.ddl.mssql)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.postgresql.visit_column_comment">visit_column_comment() (in module alembic.ddl.postgresql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_column_default">visit_column_default() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.visit_column_default&quot;&gt;(in module alembic.ddl.mssql)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_column_name">visit_column_name() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_column_nullable">visit_column_nullable() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.visit_column_nullable&quot;&gt;(in module alembic.ddl.mssql)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_column_type">visit_column_type() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.visit_column_type&quot;&gt;(in module alembic.ddl.mssql)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.visit_column_type">(in module alembic.ddl.postgresql)</a>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_computed_column">visit_computed_column() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_drop_column">visit_drop_column() (in module alembic.ddl.base)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_identity_column">visit_identity_column() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.postgresql.visit_identity_column&quot;&gt;(in module alembic.ddl.postgresql)&lt;/a&gt;
</code></pre>
</li>
      </ul></li>
      <li><a href="en/api/ddl.html#alembic.ddl.mssql.visit_rename_column">visit_rename_column() (in module alembic.ddl.mssql)</a>
</li>
      <li><a href="en/api/ddl.html#alembic.ddl.base.visit_rename_table">visit_rename_table() (in module alembic.ddl.base)</a>
<pre><code>  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;api/ddl.html#alembic.ddl.mssql.visit_rename_table&quot;&gt;(in module alembic.ddl.mssql)&lt;/a&gt;
</code></pre>
</li>
        <li><a href="en/api/ddl.html#alembic.ddl.postgresql.visit_rename_table">(in module alembic.ddl.postgresql)</a>
</li>
      </ul></li>
  </ul></td>
</tr></table>
<h2 id="W">W</h2>
<table style="width: 100%" class="indextable genindextable"><tr>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/api/script.html#alembic.script.ScriptDirectory.walk_revisions">walk_revisions() (alembic.script.ScriptDirectory method)</a>
</li>
  </ul></td>
  <td style="width: 33%; vertical-align: top;"><ul>
      <li><a href="en/ops.html#alembic.operations.Operations.create_exclude_constraint.params.where">where (alembic.operations.Operations.create_exclude_constraint parameter)</a>
</li>
  </ul></td>
</tr></table>
<pre><code>        &lt;div class=&quot;clearer&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;sphinxsidebar&quot; role=&quot;navigation&quot; aria-label=&quot;main navigation&quot;&gt;
    &lt;div class=&quot;sphinxsidebarwrapper&quot;&gt;&lt;script async type=&quot;text/javascript&quot; src=&quot;//cdn.carbonads.com/carbon.js?serve=CKYIL23W&amp;placement=alembiczzzcomputingcom&quot; id=&quot;_carbonads_js&quot;&gt;&lt;/script&gt;
</code></pre>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28532944-2', 'auto');
  ga('send', 'pageview');

</script>
<p>
<a href="en/alembic_latest.zip">Download documentation as ZIP file</a>
</p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation-1"><a class="header" href="#navigation-1">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html#" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Index</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2021, Mike Bayer.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html><div style="break-before: page; page-break-before: always;"></div><!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Python Module Index &#8212; Alembic 1.7.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature_override.css" />
    <link rel="stylesheet" type="text/css" href="_static/changelog.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_paramlinks.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
</head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation-2"><a class="header" href="#navigation-2">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html#" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python Module Index</a></li> 
      </ul>
    </div>  
<pre><code>&lt;div class=&quot;document&quot;&gt;
  &lt;div class=&quot;documentwrapper&quot;&gt;
    &lt;div class=&quot;bodywrapper&quot;&gt;
      &lt;div class=&quot;body&quot; role=&quot;main&quot;&gt;
</code></pre>
<h1 id="python-module-index"><a class="header" href="#python-module-index">Python Module Index</a></h1>
<div class="modindex-jumpbox">
   <a href="en/py-modindex.html#cap-a"><strong>a</strong></a>
   </div>
<table class="indextable modindextable">
     <tr class="pcap"><td></td><td>&#160;</td><td></td></tr>
     <tr class="cap" id="cap-a"><td></td><td>
       <strong>a</strong></td><td></td></tr>
     <tr>
       <td><img src="en/_static/minus.png" class="toggler"
              id="toggle-1" style="display: none" alt="-" /></td>
       <td>
       <code class="xref">alembic</code></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/commands.html#module-alembic.command"><code class="xref">alembic.command</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/config.html#module-alembic.config"><code class="xref">alembic.config</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl"><code class="xref">alembic.ddl</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.base"><code class="xref">alembic.ddl.base</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.impl"><code class="xref">alembic.ddl.impl</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.mssql"><code class="xref">alembic.ddl.mssql</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.mysql"><code class="xref">alembic.ddl.mysql</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.postgresql"><code class="xref">alembic.ddl.postgresql</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/ddl.html#module-alembic.ddl.sqlite"><code class="xref">alembic.ddl.sqlite</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/ops.html#module-alembic.operations"><code class="xref">alembic.operations</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/operations.html#module-alembic.operations.ops"><code class="xref">alembic.operations.ops</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/runtime.html#module-alembic.runtime.environment"><code class="xref">alembic.runtime.environment</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/runtime.html#module-alembic.runtime.migration"><code class="xref">alembic.runtime.migration</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/script.html#module-alembic.script"><code class="xref">alembic.script</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/script.html#module-alembic.script.revision"><code class="xref">alembic.script.revision</code></a></td><td>
       <em></em></td></tr>
     <tr class="cg-1">
       <td></td>
       <td>&#160;&#160;&#160;
       <a href="en/api/script.html#module-alembic.script.write_hooks"><code class="xref">alembic.script.write_hooks</code></a></td><td>
       <em></em></td></tr>
   </table>
<pre><code>        &lt;div class=&quot;clearer&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;sphinxsidebar&quot; role=&quot;navigation&quot; aria-label=&quot;main navigation&quot;&gt;
    &lt;div class=&quot;sphinxsidebarwrapper&quot;&gt;&lt;script async type=&quot;text/javascript&quot; src=&quot;//cdn.carbonads.com/carbon.js?serve=CKYIL23W&amp;placement=alembiczzzcomputingcom&quot; id=&quot;_carbonads_js&quot;&gt;&lt;/script&gt;
</code></pre>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28532944-2', 'auto');
  ga('send', 'pageview');

</script>
<p>
<a href="en/alembic_latest.zip">Download documentation as ZIP file</a>
</p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation-3"><a class="header" href="#navigation-3">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html#" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python Module Index</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2021, Mike Bayer.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html><div style="break-before: page; page-break-before: always;"></div><!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<pre><code>&lt;title&gt;Welcome to Alembic’s documentation! &amp;#8212; Alembic 1.7.5 documentation&lt;/title&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;_static/pygments.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;_static/nature_override.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;_static/changelog.css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;_static/sphinx_paramlinks.css&quot; /&gt;
&lt;script data-url_root=&quot;./&quot; id=&quot;documentation_options&quot; src=&quot;_static/documentation_options.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;_static/jquery.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;_static/underscore.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;_static/doctools.js&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;index&quot; title=&quot;Index&quot; href=&quot;genindex.html&quot; /&gt;
&lt;link rel=&quot;search&quot; title=&quot;Search&quot; href=&quot;search.html&quot; /&gt;
&lt;link rel=&quot;next&quot; title=&quot;Front Matter&quot; href=&quot;front.html&quot; /&gt; 
</code></pre>
</head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation-4"><a class="header" href="#navigation-4">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="en/front.html" title="Front Matter"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html#">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Welcome to Alembic’s documentation!</a></li> 
      </ul>
    </div>  
<pre><code>&lt;div class=&quot;document&quot;&gt;
  &lt;div class=&quot;documentwrapper&quot;&gt;
    &lt;div class=&quot;bodywrapper&quot;&gt;
      &lt;div class=&quot;body&quot; role=&quot;main&quot;&gt;
</code></pre>
<section id="welcome-to-alembic-s-documentation">
<h1 id="welcome-to-alembics-documentationa-classheaderlink-hrefenindexhtmlwelcome-to-alembic-s-documentation-titlepermalink-to-this-headlinea"><a class="header" href="#welcome-to-alembics-documentationa-classheaderlink-hrefenindexhtmlwelcome-to-alembic-s-documentation-titlepermalink-to-this-headlinea">Welcome to Alembic’s documentation!<a class="headerlink" href="en/index.html#welcome-to-alembic-s-documentation" title="Permalink to this headline">¶</a></a></h1>
<p><a class="reference external" href="https://alembic.sqlalchemy.org">Alembic</a> is a lightweight database migration tool for usage
with the <a class="reference external" href="https://www.sqlalchemy.org">SQLAlchemy</a> Database Toolkit for Python.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="en/front.html">Front Matter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/front.html#project-homepage">Project Homepage</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/front.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/front.html#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/front.html#community">Community</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/front.html#bugs">Bugs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#the-migration-environment">The Migration Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#creating-an-environment">Creating an Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#editing-the-ini-file">Editing the .ini File</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#create-a-migration-script">Create a Migration Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#running-our-first-migration">Running our First Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#running-our-second-migration">Running our Second Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#partial-revision-identifiers">Partial Revision Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#relative-migration-identifiers">Relative Migration Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#getting-information">Getting Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/tutorial.html#viewing-history-ranges">Viewing History Ranges</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#downgrading">Downgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/tutorial.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/autogenerate.html">Auto Generating Migrations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/autogenerate.html#what-does-autogenerate-detect-and-what-does-it-not-detect">What does Autogenerate Detect (and what does it <em>not</em> detect?)</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/autogenerate.html#autogenerating-multiple-metadata-collections">Autogenerating Multiple MetaData collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/autogenerate.html#controlling-what-to-be-autogenerated">Controlling What to be Autogenerated</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#omitting-schema-names-from-the-autogenerate-process">Omitting Schema Names from the Autogenerate Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#omitting-table-names-from-the-autogenerate-process">Omitting Table Names from the Autogenerate Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#omitting-based-on-object">Omitting Based on Object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/autogenerate.html#comparing-and-rendering-types">Comparing and Rendering Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#controlling-the-module-prefix">Controlling the Module Prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#affecting-the-rendering-of-types-themselves">Affecting the Rendering of Types Themselves</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#comparing-types">Comparing Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/autogenerate.html#applying-post-processing-and-python-code-formatters-to-generated-revisions">Applying Post Processing and Python Code Formatters to Generated Revisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#basic-formatter-configuration">Basic Formatter Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/autogenerate.html#writing-custom-hooks-as-python-functions">Writing Custom Hooks as Python Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/offline.html">Generating SQL Scripts (a.k.a. “Offline Mode”)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/offline.html#getting-the-start-version">Getting the Start Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/offline.html#writing-migration-scripts-to-support-script-generation">Writing Migration Scripts to Support Script Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/offline.html#customizing-the-environment">Customizing the Environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/naming.html">The Importance of Naming Constraints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/naming.html#integration-of-naming-conventions-into-operations-autogenerate">Integration of Naming Conventions into Operations, Autogenerate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/batch.html">Running “Batch” Migrations for SQLite and Other Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/batch.html#controlling-table-reflection">Controlling Table Reflection</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/batch.html#dealing-with-constraints">Dealing with Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/batch.html#dropping-unnamed-or-named-foreign-key-constraints">Dropping Unnamed or Named Foreign Key Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/batch.html#including-unnamed-unique-constraints">Including unnamed UNIQUE constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/batch.html#changing-the-type-of-boolean-enum-and-other-implicit-check-datatypes">Changing the Type of Boolean, Enum and other implicit CHECK datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/batch.html#including-check-constraints">Including CHECK constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/batch.html#dealing-with-referencing-foreign-keys">Dealing with Referencing Foreign Keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/batch.html#working-in-offline-mode">Working in Offline Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/batch.html#batch-mode-with-autogenerate">Batch mode with Autogenerate</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/batch.html#batch-mode-with-databases-other-than-sqlite">Batch mode with databases other than SQLite</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/branches.html">Working with Branches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/branches.html#merging-branches">Merging Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/branches.html#working-with-explicit-branches">Working with Explicit Branches</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#referring-to-all-heads-at-once">Referring to all heads at once</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#referring-to-a-specific-version">Referring to a Specific Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#working-with-branch-labels">Working with Branch Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#more-label-syntaxes">More Label Syntaxes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/branches.html#working-with-multiple-bases">Working with Multiple Bases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#setting-up-multiple-version-directories">Setting up Multiple Version Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#creating-a-labeled-base-revision">Creating a Labeled Base Revision</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/branches.html#running-with-multiple-bases">Running with Multiple Bases</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/branches.html#branch-dependencies">Branch Dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/ops.html">Operation Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="en/cookbook.html">Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#building-an-up-to-date-database-from-scratch">Building an Up to Date Database from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#conditional-migration-elements">Conditional Migration Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#sharing-a-connection-with-a-series-of-migration-commands-and-environments">Sharing a Connection with a Series of Migration Commands and Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#replaceable-objects">Replaceable Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/cookbook.html#the-replaceable-object-structure">The Replaceable Object Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/cookbook.html#create-operations-for-the-target-objects">Create Operations for the Target Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/cookbook.html#create-initial-migrations">Create Initial Migrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/cookbook.html#create-revision-migrations">Create Revision Migrations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#rudimental-schema-level-multi-tenancy-for-postgresql-databases">Rudimental Schema-Level Multi Tenancy for PostgreSQL Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#don-t-generate-empty-migrations-with-autogenerate">Don’t Generate Empty Migrations with Autogenerate</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#don-t-emit-drop-index-when-the-table-is-to-be-dropped-as-well">Don’t emit DROP INDEX when the table is to be dropped as well</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#don-t-generate-any-drop-table-directives-with-autogenerate">Don’t generate any DROP TABLE directives with autogenerate</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#apply-custom-sorting-to-table-columns-within-create-table">Apply Custom Sorting to Table Columns within CREATE TABLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#don-t-emit-create-table-statements-for-views">Don’t emit CREATE TABLE statements for Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#run-multiple-alembic-environments-from-one-ini-file">Run Multiple Alembic Environments from one .ini file</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#print-python-code-to-generate-particular-database-tables">Print Python Code to Generate Particular Database Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#run-alembic-operation-objects-directly-as-in-from-autogenerate">Run Alembic Operation Objects Directly (as in from autogenerate)</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#test-current-database-revision-is-at-head-s">Test current database revision is at head(s)</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/cookbook.html#using-asyncio-with-alembic">Using Asyncio with Alembic</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/api/index.html">API Details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/api/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/api/runtime.html">Runtime Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/api/runtime.html#the-environment-context">The Environment Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/runtime.html#the-migration-context">The Migration Context</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/api/config.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/api/commands.html">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/api/operations.html">Operation Directives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/api/operations.html#operation-plugins">Operation Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/operations.html#built-in-operation-objects">Built-in Operation Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/api/autogenerate.html">Autogeneration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/api/autogenerate.html#getting-diffs">Getting Diffs</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/autogenerate.html#customizing-revision-generation">Customizing Revision Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/autogenerate.html#autogenerating-custom-operation-directives">Autogenerating Custom Operation Directives</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/api/script.html">Script Directory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/api/script.html#revision">Revision</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/script.html#module-alembic.script.write_hooks">Write Hooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/api/ddl.html">DDL Internals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/api/ddl.html#module-alembic.ddl.mysql">MySQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/ddl.html#module-alembic.ddl.mssql">MS-SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/ddl.html#module-alembic.ddl.postgresql">Postgresql</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/api/ddl.html#module-alembic.ddl.sqlite">SQLite</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="en/changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.6">1.7.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.6-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.6-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.5">1.7.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.4">1.7.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.3">1.7.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.2">1.7.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.1">1.7.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.7.0">1.7.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.0-changed">changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.0-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.7.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.5">1.6.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.4">1.6.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.3">1.6.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.2">1.6.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.1">1.6.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.6.0">1.6.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.6.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.8">1.5.8</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.8-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.7">1.5.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.6">1.5.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.6-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.6-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.5">1.5.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.4">1.5.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.3">1.5.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.2">1.5.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.1">1.5.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.5.0">1.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.0-changed">changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.0-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.5.0-removed">removed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.4.3">1.4.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.4.2">1.4.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.2-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.4.1">1.4.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.4.0">1.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.0-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.4.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.3.3">1.3.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.3-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.3.2">1.3.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.3.1">1.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.3.0">1.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.3.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.2.1">1.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.2.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.2.0">1.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.2.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.2.0-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.2.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.2.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.1.0">1.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.1.0-usecase">usecase</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.1.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.1.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.11">1.0.11</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.11-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.10">1.0.10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.10-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.9">1.0.9</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.9-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.8">1.0.8</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.8-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.7">1.0.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.6">1.0.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.6-feature">feature</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.5">1.0.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.4">1.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.3">1.0.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.2">1.0.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.1">1.0.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-1.0.0">1.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-1.0.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.10">0.9.10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.10-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.9">0.9.9</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.9-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.9-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.8">0.9.8</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.8-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.7">0.9.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.6">0.9.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.6-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.6-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.5">0.9.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.4">0.9.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.3">0.9.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.3-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.2">0.9.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.2-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.2-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.2-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.1">0.9.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.9.0">0.9.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.9.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.10">0.8.10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.10-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.9">0.8.9</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.9-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.8">0.8.8</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.8-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.8-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.7">0.8.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.6">0.8.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.6-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.5">0.8.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.4">0.8.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.4-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.3">0.8.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.2">0.8.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.1">0.8.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.1-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.8.0">0.8.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.8.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.7">0.7.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.7-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.6">0.7.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.6-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.6-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.5">0.7.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.5-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.4">0.7.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.3">0.7.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.2">0.7.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.1">0.7.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.1-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.7.0">0.7.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.0-changed">changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.7.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.7">0.6.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.7-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.7-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.6">0.6.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.6-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.6-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.6-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.5">0.6.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.5-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.4">0.6.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.4-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.3">0.6.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.3-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.2">0.6.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.2-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.1">0.6.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.1-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.6.0">0.6.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.6.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.5.0">0.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.5.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.5.0-bug">bug</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.5.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.4.2">0.4.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.2-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.4.1">0.4.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.1-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.4.0">0.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.4.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.6">0.3.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.6-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.6-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.5">0.3.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.5-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.5-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.4">0.3.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.4-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.3">0.3.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.3-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.3-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.2">0.3.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.2-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.1">0.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.3.0">0.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.3.0-misc">misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.2.2">0.2.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.2.2-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.2.2-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.2.1">0.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.2.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.2.0">0.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.2.0-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.2.0-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.1.1">0.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.1.1-feature">feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="en/changelog.html#change-0.1.1-bug">bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="en/changelog.html#change-0.1.0">0.1.0</a></li>
</ul>
</li>
</ul>
</div>
<section id="indices-and-tables">
<h2 id="indices-and-tablesa-classheaderlink-hrefenindexhtmlindices-and-tables-titlepermalink-to-this-headlinea"><a class="header" href="#indices-and-tablesa-classheaderlink-hrefenindexhtmlindices-and-tables-titlepermalink-to-this-headlinea">Indices and tables<a class="headerlink" href="en/index.html#indices-and-tables" title="Permalink to this headline">¶</a></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="en/genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="en/py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="en/search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>
<pre><code>        &lt;div class=&quot;clearer&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;sphinxsidebar&quot; role=&quot;navigation&quot; aria-label=&quot;main navigation&quot;&gt;
    &lt;div class=&quot;sphinxsidebarwrapper&quot;&gt;&lt;script async type=&quot;text/javascript&quot; src=&quot;//cdn.carbonads.com/carbon.js?serve=CKYIL23W&amp;placement=alembiczzzcomputingcom&quot; id=&quot;_carbonads_js&quot;&gt;&lt;/script&gt;
</code></pre>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28532944-2', 'auto');
  ga('send', 'pageview');

</script>
<p>
<a href="en/alembic_latest.zip">Download documentation as ZIP file</a>
</p>
<h3 id="a-hrefenindexhtmltable-of-contentsa"><a class="header" href="#a-hrefenindexhtmltable-of-contentsa"><a href="en/index.html#">Table of Contents</a></a></h3>
  <ul>
<li><a class="reference internal" href="en/index.html#">Welcome to Alembic’s documentation!</a><ul>
<li><a class="reference internal" href="en/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h4 id="next-topic"><a class="header" href="#next-topic">Next topic</a></h4>
  <p class="topless"><a href="en/front.html"
                        title="next chapter">Front Matter</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3 id="navigation-5"><a class="header" href="#navigation-5">Navigation</a></h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="en/genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="en/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="en/front.html" title="Front Matter"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="en/index.html#">Alembic 1.7.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Welcome to Alembic’s documentation!</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2021, Mike Bayer.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
